{"version":3,"file":"useForm-C_j8H-C3.js","sources":["../../src/hooks/useForm.js"],"sourcesContent":["import { useState, useCallback } from 'react';\r\nimport { validation, errorHandler } from '../utils';\r\n\r\n/**\r\n * Hook para gerenciamento de formulários\r\n */\r\nexport const useForm = (initialValues = {}, validationRules = {}) => {\r\n  const [values, setValues] = useState(initialValues);\r\n  const [errors, setErrors] = useState({});\r\n  const [touched, setTouched] = useState({});\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n\r\n  // Atualizar valor de um campo\r\n  const setValue = useCallback((name, value) => {\r\n    setValues(prev => ({\r\n      ...prev,\r\n      [name]: value\r\n    }));\r\n\r\n    // Limpar erro do campo quando valor muda\r\n    if (errors[name]) {\r\n      setErrors(prev => ({\r\n        ...prev,\r\n        [name]: null\r\n      }));\r\n    }\r\n  }, [errors]);\r\n\r\n  // Handler para inputs\r\n  const handleChange = useCallback((e) => {\r\n    const { name, value, type, checked } = e.target;\r\n    setValue(name, type === 'checkbox' ? checked : value);\r\n  }, [setValue]);\r\n\r\n  // Handler para blur (marcar campo como tocado)\r\n  const handleBlur = useCallback((e) => {\r\n    const { name } = e.target;\r\n    setTouched(prev => ({\r\n      ...prev,\r\n      [name]: true\r\n    }));\r\n\r\n    // Validar campo ao sair\r\n    if (validationRules[name]) {\r\n      const error = validationRules[name](values[name]);\r\n      setErrors(prev => ({\r\n        ...prev,\r\n        [name]: error\r\n      }));\r\n    }\r\n  }, [validationRules, values]);\r\n\r\n  // Validar todos os campos\r\n  const validate = useCallback(() => {\r\n    const newErrors = {};\r\n    let isValid = true;\r\n\r\n    Object.keys(validationRules).forEach(fieldName => {\r\n      const error = validationRules[fieldName](values[fieldName]);\r\n      if (error) {\r\n        newErrors[fieldName] = error;\r\n        isValid = false;\r\n      }\r\n    });\r\n\r\n    setErrors(newErrors);\r\n    return isValid;\r\n  }, [validationRules, values]);\r\n\r\n  // Submeter formulário\r\n  const handleSubmit = useCallback(async (onSubmit) => {\r\n    // Marcar todos os campos como tocados\r\n    const allFields = Object.keys({ ...initialValues, ...validationRules });\r\n    const touchedFields = {};\r\n    allFields.forEach(field => {\r\n      touchedFields[field] = true;\r\n    });\r\n    setTouched(touchedFields);\r\n\r\n    // Validar\r\n    const isValid = validate();\r\n    if (!isValid) {\r\n      return { success: false, errors };\r\n    }\r\n\r\n    // Submeter\r\n    setIsSubmitting(true);\r\n    try {\r\n      const result = await onSubmit(values);\r\n      return { success: true, data: result };\r\n    } catch (error) {\r\n      const errorMessage = errorHandler.getErrorMessage(error);\r\n      \r\n      // Se o erro contém informações específicas de campos, aplicá-las\r\n      if (error.fieldErrors) {\r\n        setErrors(prev => ({\r\n          ...prev,\r\n          ...error.fieldErrors\r\n        }));\r\n      }\r\n      \r\n      return { success: false, error: errorMessage };\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  }, [values, validate, errors, initialValues, validationRules]);\r\n\r\n  // Reset do formulário\r\n  const reset = useCallback(() => {\r\n    setValues(initialValues);\r\n    setErrors({});\r\n    setTouched({});\r\n    setIsSubmitting(false);\r\n  }, [initialValues]);\r\n\r\n  // Definir valores do formulário\r\n  const setFormValues = useCallback((newValues) => {\r\n    setValues(prev => ({\r\n      ...prev,\r\n      ...newValues\r\n    }));\r\n  }, []);\r\n\r\n  // Obter props para um campo específico\r\n  const getFieldProps = useCallback((name) => ({\r\n    name,\r\n    value: values[name] || '',\r\n    onChange: handleChange,\r\n    onBlur: handleBlur,\r\n    error: touched[name] && errors[name],\r\n    required: !!validationRules[name]\r\n  }), [values, handleChange, handleBlur, touched, errors, validationRules]);\r\n\r\n  return {\r\n    values,\r\n    errors,\r\n    touched,\r\n    isSubmitting,\r\n    setValue,\r\n    handleChange,\r\n    handleBlur,\r\n    handleSubmit,\r\n    validate,\r\n    reset,\r\n    setFormValues,\r\n    getFieldProps,\r\n    isValid: Object.keys(errors).length === 0,\r\n    isDirty: JSON.stringify(values) !== JSON.stringify(initialValues)\r\n  };\r\n};\r\n\r\n/**\r\n * Regras de validação pré-definidas\r\n */\r\nexport const validationRules = {\r\n  // Campos obrigatórios\r\n  required: (value) => {\r\n    if (!value || (typeof value === 'string' && !value.trim())) {\r\n      return 'Este campo é obrigatório';\r\n    }\r\n    return null;\r\n  },\r\n\r\n  // Email\r\n  email: (value) => validation.email(value),\r\n\r\n  // Senha\r\n  password: (value) => validation.password(value),\r\n\r\n  // Nome\r\n  name: (value) => validation.name(value),\r\n\r\n  // Telefone\r\n  phone: (value) => validation.phone(value),\r\n\r\n  // Username\r\n  username: (value) => validation.username(value),\r\n\r\n  // Conteúdo do post\r\n  postContent: (value) => validation.postContent(value),\r\n\r\n  // Confirmar senha\r\n  confirmPassword: (originalPassword) => (value) => {\r\n    if (!value) return 'Confirmação de senha é obrigatória';\r\n    if (value !== originalPassword) return 'Senhas não coincidem';\r\n    return null;\r\n  },\r\n\r\n  // Tamanho mínimo\r\n  minLength: (min) => (value) => {\r\n    if (value && value.length < min) {\r\n      return `Deve ter pelo menos ${min} caracteres`;\r\n    }\r\n    return null;\r\n  },\r\n\r\n  // Tamanho máximo\r\n  maxLength: (max) => (value) => {\r\n    if (value && value.length > max) {\r\n      return `Deve ter no máximo ${max} caracteres`;\r\n    }\r\n    return null;\r\n  },\r\n\r\n  // Aceitar termos\r\n  acceptTerms: (value) => {\r\n    if (!value) return 'Você deve aceitar os termos de uso';\r\n    return null;\r\n  }\r\n};\r\n"],"names":["useForm","initialValues","validationRules","values","setValues","useState","errors","setErrors","touched","setTouched","isSubmitting","setIsSubmitting","setValue","useCallback","name","value","prev","handleChange","type","checked","handleBlur","error","validate","newErrors","isValid","fieldName","handleSubmit","onSubmit","allFields","touchedFields","field","errorMessage","errorHandler","reset","setFormValues","newValues","getFieldProps","validation"],"mappings":"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"}