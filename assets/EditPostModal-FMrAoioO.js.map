{"version":3,"file":"EditPostModal-FMrAoioO.js","sources":["../../node_modules/lucide-react/dist/esm/icons/reply.js","../../node_modules/lucide-react/dist/esm/icons/share-2.js","../../src/components/SocialPost.jsx","../../src/components/EditPostModal.jsx"],"sourcesContent":["/**\n * @license lucide-react v0.522.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M20 18v-2a4 4 0 0 0-4-4H4\", key: \"5vmcpk\" }],\n  [\"path\", { d: \"m9 17-5-5 5-5\", key: \"nvlc11\" }]\n];\nconst Reply = createLucideIcon(\"reply\", __iconNode);\n\nexport { __iconNode, Reply as default };\n//# sourceMappingURL=reply.js.map\n","/**\n * @license lucide-react v0.522.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"18\", cy: \"5\", r: \"3\", key: \"gq8acd\" }],\n  [\"circle\", { cx: \"6\", cy: \"12\", r: \"3\", key: \"w7nqdw\" }],\n  [\"circle\", { cx: \"18\", cy: \"19\", r: \"3\", key: \"1xt0gg\" }],\n  [\"line\", { x1: \"8.59\", x2: \"15.42\", y1: \"13.51\", y2: \"17.49\", key: \"47mynk\" }],\n  [\"line\", { x1: \"15.41\", x2: \"8.59\", y1: \"6.51\", y2: \"10.49\", key: \"1n3mei\" }]\n];\nconst Share2 = createLucideIcon(\"share-2\", __iconNode);\n\nexport { __iconNode, Share2 as default };\n//# sourceMappingURL=share-2.js.map\n","import React, { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { Card, CardContent } from './ui/card';\r\nimport { Button } from './ui/button';\r\nimport { Avatar, AvatarFallback, AvatarImage } from './ui/avatar';\r\nimport { Badge } from './ui/badge';\r\nimport { Textarea } from './ui/textarea';\r\nimport config from '../config/config';\r\nimport { \r\n  Heart, \r\n  MessageCircle, \r\n  Share2, \r\n  MoreHorizontal, \r\n  Send, \r\n  Edit,\r\n  Trash2,\r\n  Reply,\r\n  X,\r\n  Bookmark,\r\n  Megaphone\r\n} from 'lucide-react';\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuTrigger,\r\n} from './ui/dropdown-menu';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogDescription,\r\n} from './ui/dialog';\r\nimport apiService from '../services/api';\r\n\r\nconst CAMPAIGN_OBJECTIVE_LABELS = {\r\n  alcance: 'Alcance',\r\n  cliques: 'Cliques',\r\n  conversao: 'Conversões',\r\n  engajamento: 'Engajamento',\r\n};\r\n\r\nconst SocialPost = ({ \r\n  post, \r\n  currentUser, \r\n  onLike, \r\n  onComment, \r\n  onShare, \r\n  onDelete, \r\n  onUpdate, \r\n  onSave,\r\n  onFollow,\r\n  showSaveButton = true,\r\n  isSaved = false,\r\n  showGroupBadge = false,\r\n  groupName = null\r\n}) => {\r\n  const [showComments, setShowComments] = useState(false);\r\n  const [comments, setComments] = useState([]);\r\n  const [newComment, setNewComment] = useState('');\r\n  const [replyTo, setReplyTo] = useState(null);\r\n  const [showLikesList, setShowLikesList] = useState(false);\r\n  const [likes, setLikes] = useState([]);\r\n  const [isLiked, setIsLiked] = useState(post.user_liked || post.isLiked || false);\r\n  const [likeCount, setLikeCount] = useState(post.likes || 0);\r\n  const [commentCount, setCommentCount] = useState(post.comentarios || 0);\r\n  const [loadingComments, setLoadingComments] = useState(false);\r\n  const [loadingLikes, setLoadingLikes] = useState(false);\r\n  const [saved, setSaved] = useState(isSaved || post.user_saved || post.isSaved || false);\r\n  const [isFollowing, setIsFollowing] = useState(post.isFollowed || false);\r\n  const [editingComment, setEditingComment] = useState(null);\r\n  const [editingText, setEditingText] = useState('');\r\n  const [updatingComment, setUpdatingComment] = useState(false);\r\n  const [commentFollowStates, setCommentFollowStates] = useState({});\r\n  \r\n  // Ref para controlar carregamento de comentários\r\n  const commentsLoadedRef = useRef(false);\r\n  const commentsSnapshotRef = useRef(null);\r\n\r\n  const isSponsored = Boolean(post?.sponsored || post?.is_promovido || post?.isPromovido || post?.ad_campaign_id);\r\n  const campaignInfo = post?.sponsored_campaign;\r\n  const sponsoredBadgeLabel = post?.sponsored_badge || 'Patrocinado';\r\n  const campaignObjectiveLabel = campaignInfo?.objetivo\r\n    ? (CAMPAIGN_OBJECTIVE_LABELS[campaignInfo.objetivo] || campaignInfo.objetivo)\r\n    : null;\r\n\r\n  // Sincronizar estado quando as props mudarem\r\n  useEffect(() => {\r\n    setIsLiked(post.user_liked || post.isLiked || false);\r\n    setLikeCount(post.likes || 0);\r\n    setSaved(isSaved || post.user_saved || post.isSaved || false);\r\n    setIsFollowing(post.isFollowed || false);\r\n  }, [post.user_liked, post.isLiked, post.likes, isSaved, post.user_saved, post.isSaved, post.isFollowed]);\r\n\r\n  const fetchComments = useCallback(async () => {\r\n    // Evitar carregamento duplicado\r\n    if (loadingComments || commentsLoadedRef.current) return;\r\n    \r\n    commentsLoadedRef.current = true;\r\n    setLoadingComments(true);\r\n    \r\n    try {\r\n      const response = await apiService.getComments(post.id, { limit: 10 }); // Reduzir limite para 10\r\n      \r\n      if (response.success) {\r\n        setComments(response.comments || []);\r\n        setCommentCount(response.total || response.comments?.length || 0);\r\n      }\r\n    } catch (error) {\r\n      console.error('Erro ao carregar comentários:', error);\r\n      // Reset ref em caso de erro para permitir nova tentativa\r\n      commentsLoadedRef.current = false;\r\n    }\r\n    setLoadingComments(false);\r\n  }, [post.id, loadingComments]);\r\n\r\n  const fetchLikes = useCallback(async () => {\r\n    setLoadingLikes(true);\r\n    try {\r\n      const response = await apiService.getLikes(post.id);\r\n      \r\n      if (response.success) {\r\n        setLikes(response.likes || []);\r\n        setLikeCount(response.total || 0);\r\n      }\r\n    } catch (error) {\r\n      console.error('Erro ao carregar likes:', error);\r\n    }\r\n    setLoadingLikes(false);\r\n  }, [post.id]);\r\n\r\n  const updateCommentInState = useCallback((commentId, updater) => {\r\n    setComments((prevComments) => prevComments.map((comment) => {\r\n      if (comment.id === commentId) {\r\n        const updated = updater(comment);\r\n        if (Array.isArray(comment.replies) && !Array.isArray(updated.replies)) {\r\n          updated.replies = comment.replies;\r\n        }\r\n        return updated;\r\n      }\r\n\r\n      if (Array.isArray(comment.replies) && comment.replies.length > 0) {\r\n        let replyUpdated = false;\r\n        const updatedReplies = comment.replies.map((reply) => {\r\n          if (reply.id === commentId) {\r\n            replyUpdated = true;\r\n            return updater(reply);\r\n          }\r\n          return reply;\r\n        });\r\n\r\n        if (replyUpdated) {\r\n          return {\r\n            ...comment,\r\n            replies: updatedReplies,\r\n          };\r\n        }\r\n      }\r\n\r\n      return comment;\r\n    }));\r\n  }, []);\r\n\r\n  const handleStartEditComment = useCallback((comment, parentId = null) => {\r\n    setEditingComment({ id: comment.id, parentId });\r\n    setEditingText(comment.conteudo || '');\r\n    setReplyTo(null);\r\n  }, []);\r\n\r\n  const handleCancelEditComment = useCallback(() => {\r\n    setEditingComment(null);\r\n    setEditingText('');\r\n  }, []);\r\n\r\n  const handleUpdateComment = useCallback(async () => {\r\n    if (!editingComment || !editingText.trim()) return;\r\n\r\n    const commentId = editingComment.id;\r\n    const newContent = editingText.trim();\r\n    const isReply = Boolean(editingComment.parentId);\r\n\r\n    try {\r\n      commentsSnapshotRef.current = JSON.parse(JSON.stringify(comments));\r\n    } catch (error) {\r\n      commentsSnapshotRef.current = comments;\r\n    }\r\n\r\n    updateCommentInState(commentId, (prev) => ({\r\n      ...prev,\r\n      conteudo: newContent,\r\n      updated_at: new Date().toISOString(),\r\n    }));\r\n\r\n    setUpdatingComment(true);\r\n\r\n    try {\r\n      const response = await apiService.updateComment(commentId, { conteudo: newContent });\r\n      if (response.success && response.comment) {\r\n        const updatedComment = response.comment;\r\n        updateCommentInState(commentId, (prev) => {\r\n          const merged = {\r\n            ...prev,\r\n            ...updatedComment,\r\n          };\r\n\r\n          if (!isReply) {\r\n            merged.replies = prev.replies ?? (Array.isArray(updatedComment.replies) ? updatedComment.replies : []);\r\n          }\r\n\r\n          return merged;\r\n        });\r\n      } else if (commentsSnapshotRef.current) {\r\n        setComments(commentsSnapshotRef.current);\r\n      }\r\n    } catch (error) {\r\n      console.error('Erro ao atualizar comentário:', error);\r\n      if (commentsSnapshotRef.current) {\r\n        setComments(commentsSnapshotRef.current);\r\n      }\r\n    } finally {\r\n      setUpdatingComment(false);\r\n      setEditingComment(null);\r\n      setEditingText('');\r\n      commentsSnapshotRef.current = null;\r\n    }\r\n  }, [comments, editingComment, editingText, updateCommentInState]);\r\n\r\n  const removeCommentFromState = useCallback((commentId) => {\r\n    setComments((prevComments) => prevComments\r\n      .map((comment) => {\r\n        if (comment.id === commentId) {\r\n          return null;\r\n        }\r\n\r\n        if (Array.isArray(comment.replies) && comment.replies.length > 0) {\r\n          const filteredReplies = comment.replies.filter((reply) => reply.id !== commentId);\r\n          if (filteredReplies.length !== comment.replies.length) {\r\n            return {\r\n              ...comment,\r\n              replies: filteredReplies,\r\n            };\r\n          }\r\n        }\r\n\r\n        return comment;\r\n      })\r\n      .filter(Boolean)\r\n    );\r\n  }, []);\r\n\r\n  // Carregar comentários quando abrir (apenas uma vez)\r\n  useEffect(() => {\r\n    if (showComments && !commentsLoadedRef.current && !loadingComments) {\r\n      fetchComments();\r\n    }\r\n  }, [showComments, fetchComments, loadingComments]);\r\n\r\n  // Carregar likes quando abrir modal\r\n  useEffect(() => {\r\n    if (showLikesList && !loadingLikes) {\r\n      fetchLikes();\r\n    }\r\n  }, [showLikesList, post.id, fetchLikes, loadingLikes]);\r\n\r\n  const handleLike = async () => {\r\n    if (!currentUser) return;\r\n\r\n    // Atualização otimista do estado para feedback imediato\r\n    const previousLiked = isLiked;\r\n    const previousCount = likeCount;\r\n    const newLiked = !isLiked;\r\n    const newCount = newLiked ? likeCount + 1 : likeCount - 1;\r\n    \r\n    setIsLiked(newLiked);\r\n    setLikeCount(newCount);\r\n\r\n    try {\r\n      const response = await apiService.toggleLike(post.id);\r\n      \r\n      if (response.success) {\r\n        // Confirmar com dados do servidor\r\n        setIsLiked(response.liked);\r\n        setLikeCount(response.likesCount || response.likes_count || newCount);\r\n        \r\n        if (onLike) {\r\n          onLike(post.id, response.liked, response.likesCount || response.likes_count || newCount);\r\n        }\r\n      } else {\r\n        // Reverter em caso de erro\r\n        setIsLiked(previousLiked);\r\n        setLikeCount(previousCount);\r\n      }\r\n    } catch (error) {\r\n      console.error('Erro ao curtir post:', error);\r\n      // Reverter estado em caso de erro\r\n      setIsLiked(previousLiked);\r\n      setLikeCount(previousCount);\r\n    }\r\n  };\r\n\r\n  const handleComment = async () => {\r\n    if (!currentUser || !newComment.trim()) return;\r\n\r\n    const tempComment = {\r\n      id: `temp-${Date.now()}`,\r\n      conteudo: newComment.trim(),\r\n      autor: currentUser.nome,\r\n      nome: currentUser.nome,\r\n      username: currentUser.username,\r\n  avatar_url: currentUser.avatar_url,\r\n  avatar: currentUser.avatar_url,\r\n  foto_perfil: currentUser.foto_perfil,\r\n      created_at: new Date().toISOString(),\r\n      parent_id: replyTo?.id || null,\r\n      replies: [],\r\n      user_id: Number(currentUser.id)\r\n    };\r\n\r\n    // Atualização otimística - adicionar comentário imediatamente\r\n    if (replyTo) {\r\n      // Adicionar como resposta\r\n      setComments(prev => prev.map(comment => \r\n        comment.id === replyTo.id \r\n          ? { ...comment, replies: [...(comment.replies || []), tempComment] }\r\n          : comment\r\n      ));\r\n    } else {\r\n      // Adicionar como comentário principal\r\n      setComments(prev => [...prev, tempComment]);\r\n    }\r\n    \r\n    setCommentCount(prev => prev + 1);\r\n    const originalComment = newComment;\r\n    setNewComment('');\r\n    setReplyTo(null);\r\n\r\n    try {\r\n      const response = await apiService.createComment(post.id, {\r\n        conteudo: originalComment.trim(),\r\n        parent_id: replyTo?.id || null\r\n      });\r\n      \r\n      if (response.success) {\r\n        // Substituir comentário temporário pelo real\r\n        if (replyTo) {\r\n          setComments(prev => prev.map(comment => \r\n            comment.id === replyTo.id \r\n              ? { \r\n                  ...comment, \r\n                  replies: (comment.replies || []).map(reply => \r\n                    reply.id === tempComment.id ? response.comment : reply\r\n                  )\r\n                }\r\n              : comment\r\n          ));\r\n        } else {\r\n          setComments(prev => prev.map(comment => \r\n            comment.id === tempComment.id ? response.comment : comment\r\n          ));\r\n        }\r\n        \r\n  if (onComment) onComment(post.id, response.comment, replyTo?.id);\r\n      } else {\r\n        // Remover comentário temporário em caso de erro\r\n        if (replyTo) {\r\n          setComments(prev => prev.map(comment => \r\n            comment.id === replyTo.id \r\n              ? { ...comment, replies: (comment.replies || []).filter(reply => reply.id !== tempComment.id) }\r\n              : comment\r\n          ));\r\n        } else {\r\n          setComments(prev => prev.filter(comment => comment.id !== tempComment.id));\r\n        }\r\n        setCommentCount(prev => prev - 1);\r\n      }\r\n    } catch (error) {\r\n      console.error('Erro ao comentar:', error);\r\n      \r\n      // Remover comentário temporário em caso de erro\r\n      if (replyTo) {\r\n        setComments(prev => prev.map(comment => \r\n          comment.id === replyTo.id \r\n            ? { ...comment, replies: (comment.replies || []).filter(reply => reply.id !== tempComment.id) }\r\n            : comment\r\n        ));\r\n      } else {\r\n        setComments(prev => prev.filter(comment => comment.id !== tempComment.id));\r\n      }\r\n      setCommentCount(prev => prev - 1);\r\n    }\r\n  };\r\n\r\n  const handleDeleteComment = async (commentId) => {\r\n    if (!currentUser) return;\r\n\r\n    if (editingComment?.id === commentId) {\r\n      handleCancelEditComment();\r\n    }\r\n\r\n    let snapshot = null;\r\n    try {\r\n      snapshot = JSON.parse(JSON.stringify(comments));\r\n    } catch (error) {\r\n      snapshot = comments;\r\n    }\r\n\r\n    removeCommentFromState(commentId);\r\n    setCommentCount(prev => Math.max(prev - 1, 0));\r\n\r\n    try {\r\n      const response = await apiService.deleteComment(commentId);\r\n      \r\n      if (!response.success && snapshot) {\r\n        setComments(snapshot);\r\n        setCommentCount(prev => prev + 1);\r\n      }\r\n    } catch (error) {\r\n      console.error('Erro ao deletar comentário:', error);\r\n      if (snapshot) {\r\n        setComments(snapshot);\r\n        setCommentCount(prev => prev + 1);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    if (!currentUser) return;\r\n\r\n    // Atualização otimista do estado para feedback imediato\r\n    const previousSaved = saved;\r\n    const newSaved = !saved;\r\n    \r\n    setSaved(newSaved);\r\n\r\n    try {\r\n      const response = await apiService.toggleSavePost(post.id);\r\n      \r\n      if (response.success) {\r\n        // Confirmar com dados do servidor\r\n        setSaved(response.saved);\r\n        \r\n        if (onSave) {\r\n          onSave(post.id, response.saved);\r\n        }\r\n      } else {\r\n        // Reverter em caso de erro\r\n        setSaved(previousSaved);\r\n      }\r\n    } catch (error) {\r\n      console.error('Erro ao salvar post:', error);\r\n      // Reverter estado em caso de erro\r\n      setSaved(previousSaved);\r\n    }\r\n  };\r\n\r\n  const handleFollow = async () => {\r\n    if (!currentUser) return;\r\n    if (post.user_id === currentUser.id) return; // Não pode seguir a si mesmo\r\n\r\n    try {\r\n      const response = await apiService.toggleFollow(post.user_id);\r\n      \r\n      if (response.success) {\r\n        const newFollowing = response.following;\r\n        const followersCount = response.followers_count || response.followersCount || 0;\r\n        \r\n        // Atualizar estado local\r\n        setIsFollowing(newFollowing);\r\n        \r\n        // Chamar callback se fornecido (para atualizar lista de posts)\r\n        if (onFollow) {\r\n          onFollow(post.user_id, newFollowing, followersCount);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Erro ao seguir usuário:', error);\r\n    }\r\n  };\r\n\r\n  const formatTimeAgo = (dateString) => {\r\n    const now = new Date();\r\n    const postDate = new Date(dateString);\r\n    const diffInSeconds = Math.floor((now - postDate) / 1000);\r\n\r\n    if (diffInSeconds < 60) return 'agora';\r\n    if (diffInSeconds < 3600) return `${Math.floor(diffInSeconds / 60)}min`;\r\n    if (diffInSeconds < 86400) return `${Math.floor(diffInSeconds / 3600)}h`;\r\n    if (diffInSeconds < 2592000) return `${Math.floor(diffInSeconds / 86400)}d`;\r\n    \r\n    return postDate.toLocaleDateString('pt-BR');\r\n  };\r\n\r\n  const renderMedia = () => {\r\n    // Sistema de arquivos locais - prioridade para imagem_url e video_url\r\n    if (post.tipo_midia === 'imagem' && post.imagem_url) {\r\n      return (\r\n        <div className=\"rounded-xl overflow-hidden mt-3\">\r\n          <img\r\n            src={config.getPublicUrl(post.imagem_url)}\r\n            alt=\"Imagem do post\"\r\n            className=\"w-full max-h-96 object-cover cursor-pointer hover:opacity-95 transition-opacity\"\r\n            onClick={() => window.open(config.getPublicUrl(post.imagem_url), '_blank')}\r\n          />\r\n        </div>\r\n      );\r\n    }\r\n\r\n    if (post.tipo_midia === 'video' && post.video_url) {\r\n      return (\r\n        <div className=\"rounded-xl overflow-hidden mt-3\">\r\n          <video\r\n            src={config.getPublicUrl(post.video_url)}\r\n            controls\r\n            className=\"w-full max-h-96 object-cover\"\r\n            poster=\"/placeholder.svg?height=300&width=500\"\r\n          />\r\n        </div>\r\n      );\r\n    }\r\n\r\n    // Sistema antigo de BLOB - manter compatibilidade\r\n    if (post.media_files && post.media_files.length > 0) {\r\n      const mediaFiles = post.media_files;\r\n      \r\n      if (mediaFiles.length === 1) {\r\n        // Um arquivo - layout único\r\n        const media = mediaFiles[0];\r\n        const mediaUrl = config.getApiUrl(`posts/media.php?id=${media.id}`);\r\n        \r\n        if (media.media_type.startsWith('image/')) {\r\n          return (\r\n            <div className=\"rounded-xl overflow-hidden mt-3\">\r\n              <img\r\n                src={mediaUrl}\r\n                alt={media.media_filename}\r\n                className=\"w-full max-h-96 object-cover cursor-pointer hover:opacity-95 transition-opacity\"\r\n                onClick={() => window.open(mediaUrl, '_blank')}\r\n              />\r\n            </div>\r\n          );\r\n        } else if (media.media_type.startsWith('video/')) {\r\n          return (\r\n            <div className=\"rounded-xl overflow-hidden mt-3\">\r\n              <video\r\n                src={mediaUrl}\r\n                controls\r\n                className=\"w-full max-h-96 object-cover\"\r\n                poster=\"/placeholder.svg?height=300&width=500\"\r\n              />\r\n            </div>\r\n          );\r\n        }\r\n      } else {\r\n        // Múltiplos arquivos - grid\r\n        return (\r\n          <div className={`grid gap-2 rounded-xl overflow-hidden mt-3 ${\r\n            mediaFiles.length === 2 ? 'grid-cols-2' :\r\n            mediaFiles.length === 3 ? 'grid-cols-2' :\r\n            'grid-cols-2'\r\n          }`}>\r\n            {mediaFiles.map((media, index) => {\r\n              const mediaUrl = config.getApiUrl(`posts/media.php?id=${media.id}`);\r\n              \r\n              return (\r\n                <div \r\n                  key={media.id} \r\n                  className={`relative ${\r\n                    mediaFiles.length === 3 && index === 0 ? 'row-span-2' : ''\r\n                  }`}\r\n                >\r\n                  {media.media_type.startsWith('image/') ? (\r\n                    <img\r\n                      src={mediaUrl}\r\n                      alt={media.media_filename}\r\n                      className=\"w-full h-full object-cover min-h-[150px] max-h-[300px] cursor-pointer hover:opacity-95 transition-opacity\"\r\n                      onClick={() => window.open(mediaUrl, '_blank')}\r\n                    />\r\n                  ) : (\r\n                    <video\r\n                      src={mediaUrl}\r\n                      controls\r\n                      className=\"w-full h-full object-cover min-h-[150px] max-h-[300px]\"\r\n                    />\r\n                  )}\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        );\r\n      }\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  const resolveAvatarSrc = (avatar) => {\r\n    if (!avatar) return '';\r\n    if (typeof avatar === 'string' && avatar.startsWith('http')) return avatar;\r\n    return config.getPublicUrl(avatar);\r\n  };\r\n\r\n  const getAvatarFromComment = (item) => {\r\n    if (!item) return '';\r\n    return resolveAvatarSrc(\r\n      item.avatar ||\r\n      item.avatar_url ||\r\n      item.foto_perfil ||\r\n      item.user?.avatar_url ||\r\n      item.user?.foto_perfil\r\n    );\r\n  };\r\n\r\n  const renderReply = (reply, parentId) => {\r\n    const displayName = reply.autor || reply.author || reply.nome || 'Usuário';\r\n    const username = reply.username || reply.user?.username || 'unknown';\r\n  const avatarSrc = getAvatarFromComment(reply);\r\n    const isOwner = Boolean(currentUser) && (Number(currentUser.id) === Number(reply.user_id) || reply.isOwner);\r\n    const isEditingReply = editingComment?.id === reply.id;\r\n\r\n    return (\r\n      <div key={reply.id} className=\"flex space-x-2 sm:space-x-3\">\r\n        <Link to={`/perfil/${username}`} className=\"flex-shrink-0\">\r\n          <Avatar className=\"w-5 h-5 sm:w-6 sm:h-6 hover:opacity-80 transition-opacity\">\r\n            <AvatarImage src={avatarSrc} />\r\n            <AvatarFallback className=\"text-xs bg-sage text-white\">\r\n              {displayName.charAt(0).toUpperCase()}\r\n            </AvatarFallback>\r\n          </Avatar>\r\n        </Link>\r\n        <div className=\"flex-1 min-w-0\">\r\n          <div className=\"bg-gray-100 rounded-lg p-1.5 sm:p-2\">\r\n            <div className=\"flex items-center space-x-1 sm:space-x-2 mb-1\">\r\n              <Link to={`/perfil/${username}`} className=\"font-medium text-xs hover:underline\">{displayName}</Link>\r\n              <Link to={`/perfil/${username}`} className=\"text-coral text-xs hover:underline\">@{username}</Link>\r\n              <span className=\"text-gray-500 text-xs\">{formatTimeAgo(reply.created_at)}</span>\r\n            </div>\r\n            {isEditingReply ? (\r\n              <>\r\n                <Textarea\r\n                  value={editingText}\r\n                  onChange={(e) => setEditingText(e.target.value)}\r\n                  className=\"text-xs\"\r\n                  rows={3}\r\n                />\r\n                <div className=\"flex items-center gap-2 mt-2\">\r\n                  <Button\r\n                    size=\"sm\"\r\n                    className=\"bg-coral hover:bg-coral/90 text-white h-8\"\r\n                    onClick={handleUpdateComment}\r\n                    disabled={updatingComment || !editingText.trim()}\r\n                  >\r\n                    {updatingComment ? 'Salvando...' : 'Salvar'}\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    className=\"h-8\"\r\n                    onClick={handleCancelEditComment}\r\n                    disabled={updatingComment}\r\n                  >\r\n                    Cancelar\r\n                  </Button>\r\n                </div>\r\n              </>\r\n            ) : (\r\n              <p className=\"text-xs text-gray-800 break-words whitespace-pre-wrap overflow-wrap-anywhere\">{reply.conteudo}</p>\r\n            )}\r\n          </div>\r\n          {isOwner && !isEditingReply && (\r\n            <div className=\"flex items-center gap-2 mt-1\">\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"sm\"\r\n                className=\"text-xs text-gray-500 hover:text-coral px-1 py-0.5 h-auto\"\r\n                onClick={() => handleStartEditComment(reply, parentId)}\r\n              >\r\n                <Edit className=\"w-3 h-3 mr-1\" />\r\n                Editar\r\n              </Button>\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"sm\"\r\n                className=\"text-xs text-gray-500 hover:text-red-500 px-1 py-0.5 h-auto\"\r\n                onClick={() => handleDeleteComment(reply.id)}\r\n              >\r\n                <Trash2 className=\"w-3 h-3 mr-1\" />\r\n                Deletar\r\n              </Button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderComment = (comment) => {\r\n    const displayName = comment.autor || comment.author || comment.nome || 'Usuário';\r\n    const username = comment.username || comment.user?.username || 'unknown';\r\n  const avatarSrc = getAvatarFromComment(comment);\r\n    const isOwner = Boolean(currentUser) && (Number(currentUser.id) === Number(comment.user_id) || comment.isOwner);\r\n    const isEditingComment = editingComment?.id === comment.id;\r\n    const replies = Array.isArray(comment.replies) ? comment.replies : [];\r\n    const isCurrentUser = currentUser && Number(currentUser.id) === Number(comment.user_id);\r\n    const commentIsFollowing = commentFollowStates[comment.user_id] ?? comment.isFollowing ?? false;\r\n\r\n    const handleCommentFollow = async (e) => {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      try {\r\n        const response = await apiService.toggleFollow(comment.user_id);\r\n        if (response.success) {\r\n          setCommentFollowStates(prev => ({\r\n            ...prev,\r\n            [comment.user_id]: response.following\r\n          }));\r\n        }\r\n      } catch (error) {\r\n        console.error('Erro ao seguir usuário:', error);\r\n      }\r\n    };\r\n\r\n    return (\r\n      <div key={comment.id} className=\"flex space-x-2 sm:space-x-3 py-2 sm:py-3\">\r\n        <Link to={`/perfil/${username}`} className=\"flex-shrink-0\">\r\n          <Avatar className=\"w-7 h-7 sm:w-8 sm:h-8 hover:opacity-80 transition-opacity\">\r\n            <AvatarImage src={avatarSrc} />\r\n            <AvatarFallback className=\"text-xs bg-coral text-white\">\r\n              {displayName.charAt(0).toUpperCase()}\r\n            </AvatarFallback>\r\n          </Avatar>\r\n        </Link>\r\n        <div className=\"flex-1 min-w-0\">\r\n          <div className=\"bg-gray-50 rounded-lg p-2 sm:p-3\">\r\n            <div className=\"flex items-center justify-between mb-1\">\r\n              <div className=\"flex items-center space-x-1 sm:space-x-2\">\r\n                <Link to={`/perfil/${username}`} className=\"font-medium text-xs sm:text-sm hover:underline\">{displayName}</Link>\r\n                <Link to={`/perfil/${username}`} className=\"text-coral text-xs sm:text-sm hover:underline\">@{username}</Link>\r\n                <span className=\"text-gray-500 text-xs\">{formatTimeAgo(comment.created_at)}</span>\r\n              </div>\r\n              {currentUser && !isCurrentUser && (\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  className={`text-xs h-6 px-2 ${commentIsFollowing ? 'text-gray-600' : 'text-coral hover:text-coral/90'}`}\r\n                  onClick={handleCommentFollow}\r\n                >\r\n                  {commentIsFollowing ? 'Seguindo' : 'Seguir'}\r\n                </Button>\r\n              )}\r\n            </div>\r\n            {isEditingComment ? (\r\n              <>\r\n                <Textarea\r\n                  value={editingText}\r\n                  onChange={(e) => setEditingText(e.target.value)}\r\n                  rows={3}\r\n                  className=\"text-sm\"\r\n                />\r\n                <div className=\"flex items-center gap-2 mt-2\">\r\n                  <Button\r\n                    size=\"sm\"\r\n                    className=\"bg-coral hover:bg-coral/90 text-white h-8\"\r\n                    onClick={handleUpdateComment}\r\n                    disabled={updatingComment || !editingText.trim()}\r\n                  >\r\n                    {updatingComment ? 'Salvando...' : 'Salvar'}\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    className=\"h-8\"\r\n                    onClick={handleCancelEditComment}\r\n                    disabled={updatingComment}\r\n                  >\r\n                    Cancelar\r\n                  </Button>\r\n                </div>\r\n              </>\r\n            ) : (\r\n              <p className=\"text-xs sm:text-sm text-gray-800 break-words whitespace-pre-wrap overflow-wrap-anywhere\">{comment.conteudo}</p>\r\n            )}\r\n          </div>\r\n          <div className=\"flex items-center space-x-3 sm:space-x-4 mt-2\">\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              className=\"text-xs text-gray-500 hover:text-coral px-1 py-0.5 h-auto\"\r\n              onClick={() => setReplyTo(comment)}\r\n              disabled={isEditingComment}\r\n            >\r\n              <Reply className=\"w-3 h-3 mr-1\" />\r\n              Responder\r\n            </Button>\r\n            {isOwner && !isEditingComment && (\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"sm\"\r\n                className=\"text-xs text-gray-500 hover:text-coral px-1 py-0.5 h-auto\"\r\n                onClick={() => handleStartEditComment(comment)}\r\n              >\r\n                <Edit className=\"w-3 h-3 mr-1\" />\r\n                Editar\r\n              </Button>\r\n            )}\r\n            {isOwner && (\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"sm\"\r\n                className=\"text-xs text-gray-500 hover:text-red-500 px-1 py-0.5 h-auto\"\r\n                onClick={() => handleDeleteComment(comment.id)}\r\n                disabled={updatingComment && editingComment?.id === comment.id}\r\n              >\r\n                <Trash2 className=\"w-3 h-3 mr-1\" />\r\n                Deletar\r\n              </Button>\r\n            )}\r\n          </div>\r\n\r\n          {replies.length > 0 && (\r\n            <div className=\"ml-2 sm:ml-4 mt-2 sm:mt-3 space-y-2 sm:space-y-3\">\r\n              {replies.map((reply) => renderReply(reply, comment.id))}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <Card className=\"shadow-sm hover:shadow-md transition-shadow overflow-hidden\">\r\n      <CardContent className=\"p-4 sm:p-6\">\r\n        {/* Header do post */}\r\n        <div className=\"flex items-start justify-between mb-3 sm:mb-4\">\r\n            <Link to={`/perfil/${post.username}`} className=\"flex items-start space-x-2 sm:space-x-3 hover:underline min-w-0 flex-1\">\r\n              <Avatar className=\"w-10 h-10 sm:w-12 sm:h-12 flex-shrink-0\">\r\n                <AvatarImage src={post.avatar ? config.getPublicUrl(post.avatar) : ''} />\r\n                <AvatarFallback className=\"bg-coral text-white text-sm\">\r\n                  {post.autor.charAt(0)}\r\n                </AvatarFallback>\r\n              </Avatar>\r\n              <div className=\"min-w-0 flex-1\">\r\n                <div className=\"flex items-center gap-2 flex-wrap\">\r\n                  <h3 className=\"font-semibold text-gray-900 text-sm sm:text-base truncate\">{post.autor}</h3>\r\n                  {showGroupBadge && groupName && (\r\n                    <Badge variant=\"outline\" className=\"bg-olive/10 text-olive border-olive/20 text-xs\">\r\n                      {groupName}\r\n                    </Badge>\r\n                  )}\r\n                  {isSponsored && (\r\n                    <Badge\r\n                      variant=\"outline\"\r\n                      className=\"bg-amber-100 text-amber-700 border-amber-200 uppercase tracking-wide text-[10px] sm:text-xs\"\r\n                    >\r\n                      {sponsoredBadgeLabel}\r\n                    </Badge>\r\n                  )}\r\n                </div>\r\n                <div className=\"flex items-center space-x-1 sm:space-x-2 text-xs sm:text-sm text-gray-500\">\r\n                  <span className=\"text-coral font-medium break-all\">@{post.username}</span>\r\n                  <span>•</span>\r\n                  <span className=\"whitespace-nowrap\">{post.tempo || formatTimeAgo(post.created_at)}</span>\r\n                </div>\r\n              </div>\r\n            </Link>\r\n          \r\n          <div className=\"flex items-center space-x-1 sm:space-x-2 flex-shrink-0\">\r\n            {/* Botão de seguir */}\r\n            {currentUser && post.user_id !== currentUser.id && (\r\n              <Button\r\n                variant={isFollowing ? \"outline\" : \"default\"}\r\n                size=\"sm\"\r\n                onClick={handleFollow}\r\n                className={`text-xs px-2 py-1 h-auto ${\r\n                  isFollowing \r\n                    ? \"border-coral text-coral hover:bg-coral hover:text-white\" \r\n                    : \"bg-coral hover:bg-coral/90 text-white\"\r\n                }`}\r\n              >\r\n                {isFollowing ? \"Seguindo\" : \"Seguir\"}\r\n              </Button>\r\n            )}\r\n            \r\n            {/* Menu de opções */}\r\n            <DropdownMenu>\r\n              <DropdownMenuTrigger asChild>\r\n                <Button variant=\"ghost\" size=\"sm\" className=\"rounded-full h-8 w-8 p-0\">\r\n                  <MoreHorizontal className=\"h-4 w-4\" />\r\n                </Button>\r\n              </DropdownMenuTrigger>\r\n              <DropdownMenuContent align=\"end\" className=\"w-40\">\r\n                {currentUser && currentUser.id === post.user_id ? (\r\n                  <>\r\n                    <DropdownMenuItem onClick={() => onUpdate && onUpdate(post)}>\r\n                      <Edit className=\"mr-2 h-4 w-4\" />\r\n                      Editar\r\n                    </DropdownMenuItem>\r\n                    <DropdownMenuItem \r\n                      className=\"text-red-600\"\r\n                      onClick={() => onDelete && onDelete(post.id)}\r\n                    >\r\n                      <Trash2 className=\"mr-2 h-4 w-4\" />\r\n                      Deletar\r\n                    </DropdownMenuItem>\r\n                  </>\r\n                ) : (\r\n                  <DropdownMenuItem className=\"text-yellow-600\">\r\n                    Reportar\r\n                  </DropdownMenuItem>\r\n                )}\r\n              </DropdownMenuContent>\r\n            </DropdownMenu>\r\n          </div>\r\n        </div>\r\n\r\n        {isSponsored && (\r\n          <div className=\"mb-3 sm:mb-4 rounded-lg border border-amber-200 bg-amber-50 px-3 py-2 text-xs sm:text-sm text-amber-700 flex items-start gap-2\">\r\n            <Megaphone className=\"h-4 w-4 flex-shrink-0 text-amber-500 mt-0.5\" />\r\n            <div className=\"space-y-1\">\r\n              <p className=\"font-semibold text-amber-800 leading-snug\">\r\n                {campaignInfo?.titulo ? `Campanha “${campaignInfo.titulo}”` : 'Conteúdo patrocinado'}\r\n                {campaignObjectiveLabel ? ` • ${campaignObjectiveLabel}` : ''}\r\n              </p>\r\n              <p className=\"leading-snug\">\r\n                Este post foi impulsionado para alcançar mais empreendedoras na comunidade EmpowerUp.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Categoria */}\r\n        {post.categoria && (\r\n          <Badge className=\"mb-3 bg-coral/10 text-coral hover:bg-coral/20 text-xs\">\r\n            {post.categoria}\r\n          </Badge>\r\n        )}\r\n\r\n        {/* Conteúdo */}\r\n        <div className=\"mb-3 sm:mb-4\">\r\n          <p className=\"text-gray-800 leading-relaxed text-sm sm:text-base break-words whitespace-pre-wrap overflow-wrap-anywhere\">{post.conteudo}</p>\r\n          \r\n          {/* Tags */}\r\n          {(() => {\r\n            let tags = [];\r\n            try {\r\n              // Se post.tags é uma string JSON, fazer parse\r\n              if (typeof post.tags === 'string') {\r\n                tags = JSON.parse(post.tags);\r\n              } else if (Array.isArray(post.tags)) {\r\n                tags = post.tags;\r\n              }\r\n            } catch (e) {\r\n              // Se não conseguir fazer parse, tentar split por vírgula\r\n              if (typeof post.tags === 'string') {\r\n                tags = post.tags.split(',').map(tag => tag.trim()).filter(tag => tag.length > 0);\r\n              }\r\n            }\r\n            \r\n            return tags && tags.length > 0 && (\r\n              <div className=\"flex flex-wrap gap-1.5 sm:gap-2 mt-3\">\r\n                {tags.map((tag, index) => (\r\n                  <span\r\n                    key={index}\r\n                    className=\"text-coral hover:text-coral/80 cursor-pointer text-xs sm:text-sm font-medium break-words\"\r\n                  >\r\n                    {tag.startsWith('#') ? tag : `#${tag}`}\r\n                  </span>\r\n                ))}\r\n              </div>\r\n            );\r\n          })()}\r\n\r\n          {/* Mídia */}\r\n          {renderMedia()}\r\n        </div>\r\n\r\n        {/* Ações do post */}\r\n        <div className=\"flex items-center justify-between pt-3 sm:pt-4 border-t\">\r\n          <div className=\"flex items-center space-x-3 sm:space-x-6\">\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              onClick={handleLike}\r\n              className={`transition-all duration-200 px-2 py-1 h-auto text-xs sm:text-sm ${\r\n                isLiked \r\n                  ? \"text-red-500 hover:text-red-600 bg-red-50 hover:bg-red-100\" \r\n                  : \"text-coral hover:text-coral/80 hover:bg-coral/10\"\r\n              }`}\r\n            >\r\n              <Heart className={`mr-1 sm:mr-2 h-3 w-3 sm:h-4 sm:w-4 transition-all duration-200 ${isLiked ? \"fill-current scale-110\" : \"\"}`} />\r\n              <span \r\n                className=\"cursor-pointer hover:underline\"\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  setShowLikesList(true);\r\n                }}\r\n              >\r\n                {likeCount}\r\n              </span>\r\n            </Button>\r\n            \r\n            <Button \r\n              variant=\"ghost\" \r\n              size=\"sm\" \r\n              className=\"text-olive hover:text-olive/80 px-2 py-1 h-auto text-xs sm:text-sm\"\r\n              onClick={() => setShowComments(!showComments)}\r\n              onMouseEnter={() => {\r\n                // Pré-carregar comentários no hover para melhor UX\r\n                if (!commentsLoadedRef.current && !loadingComments) {\r\n                  fetchComments();\r\n                }\r\n              }}\r\n            >\r\n              <MessageCircle className=\"mr-1 sm:mr-2 h-3 w-3 sm:h-4 sm:w-4\" />\r\n              {commentCount}\r\n            </Button>\r\n            \r\n            <Button \r\n              variant=\"ghost\" \r\n              size=\"sm\" \r\n              className=\"text-sage hover:text-sage/80 px-2 py-1 h-auto text-xs sm:text-sm\"\r\n              onClick={() => onShare && onShare(post)}\r\n            >\r\n              <Share2 className=\"mr-1 sm:mr-2 h-3 w-3 sm:h-4 sm:w-4\" />\r\n              {post.compartilhamentos || 0}\r\n            </Button>\r\n\r\n            {showSaveButton && (\r\n              <Button \r\n                variant=\"ghost\" \r\n                size=\"sm\" \r\n                className={`transition-all duration-200 p-1 sm:p-2 h-auto ${\r\n                  saved \r\n                    ? \"text-blue-500 hover:text-blue-600 bg-blue-50 hover:bg-blue-100\" \r\n                    : \"text-gray-500 hover:text-gray-600 hover:bg-gray-100\"\r\n                }`}\r\n                onClick={handleSave}\r\n                title={saved ? \"Remover dos salvos\" : \"Salvar post\"}\r\n              >\r\n                <Bookmark className={`h-3 w-3 sm:h-4 sm:w-4 transition-all duration-200 ${saved ? \"fill-current scale-110\" : \"\"}`} />\r\n              </Button>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Seção de comentários */}\r\n        {showComments && (\r\n          <div className=\"mt-4 sm:mt-6 pt-3 sm:pt-4 border-t\">\r\n            {/* Formulário de novo comentário */}\r\n            {currentUser && (\r\n              <div className=\"mb-3 sm:mb-4\">\r\n                {replyTo && (\r\n                  <div className=\"mb-2 p-2 bg-gray-100 rounded flex items-center justify-between\">\r\n                    <span className=\"text-xs sm:text-sm text-gray-600\">\r\n                      Respondendo a <strong>@{replyTo.username}</strong>\r\n                    </span>\r\n                    <Button\r\n                      variant=\"ghost\"\r\n                      size=\"sm\"\r\n                      onClick={() => setReplyTo(null)}\r\n                      className=\"h-6 w-6 p-0\"\r\n                    >\r\n                      <X className=\"h-3 w-3\" />\r\n                    </Button>\r\n                  </div>\r\n                )}\r\n                <div className=\"flex space-x-2 sm:space-x-3\">\r\n                  <Avatar className=\"w-7 h-7 sm:w-8 sm:h-8 flex-shrink-0\">\r\n                    <AvatarImage src={currentUser.avatar_url ? config.getPublicUrl(currentUser.avatar_url) : ''} />\r\n                    <AvatarFallback className=\"bg-coral text-white text-xs\">\r\n                      {currentUser.nome.charAt(0)}\r\n                    </AvatarFallback>\r\n                  </Avatar>\r\n                  <div className=\"flex-1 flex items-end space-x-2\">\r\n                    <Textarea\r\n                      placeholder={replyTo ? `Responder para @${replyTo.username}...` : \"Escreva um comentário...\"}\r\n                      value={newComment}\r\n                      onChange={(e) => setNewComment(e.target.value)}\r\n                      className=\"flex-1 min-h-[40px] resize-none text-sm\"\r\n                      rows={1}\r\n                      onKeyDown={(e) => {\r\n                        if (e.key === 'Enter' && !e.shiftKey) {\r\n                          e.preventDefault();\r\n                          handleComment();\r\n                        }\r\n                      }}\r\n                    />\r\n                    <Button\r\n                      onClick={handleComment}\r\n                      disabled={!newComment.trim()}\r\n                      className=\"bg-coral hover:bg-coral/90 px-3 py-2 h-auto\"\r\n                      size=\"sm\"\r\n                    >\r\n                      <Send className=\"h-3 w-3\" />\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Lista de comentários */}\r\n            <div className=\"space-y-4\">\r\n              {loadingComments ? (\r\n                // Loading skeleton mais elaborado\r\n                <div className=\"space-y-3\">\r\n                  {[1, 2, 3].map((i) => (\r\n                    <div key={i} className=\"flex space-x-3 animate-pulse\">\r\n                      <div className=\"w-8 h-8 bg-gray-200 rounded-full\"></div>\r\n                      <div className=\"flex-1 space-y-2\">\r\n                        <div className=\"h-3 bg-gray-200 rounded w-1/4\"></div>\r\n                        <div className=\"h-4 bg-gray-200 rounded w-3/4\"></div>\r\n                        <div className=\"h-4 bg-gray-200 rounded w-1/2\"></div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              ) : comments.length > 0 ? (\r\n                comments.map(renderComment)\r\n              ) : (\r\n                <p className=\"text-center text-gray-500 py-4\">\r\n                  Nenhum comentário ainda. Seja a primeira a comentar!\r\n                </p>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Modal de likes */}\r\n        <Dialog open={showLikesList} onOpenChange={setShowLikesList}>\r\n          <DialogContent className=\"sm:max-w-md\">\r\n            <DialogHeader>\r\n              <DialogTitle>Curtidas ({likeCount})</DialogTitle>\r\n              <DialogDescription>\r\n                Pessoas que curtiram este post\r\n              </DialogDescription>\r\n            </DialogHeader>\r\n            <div className=\"space-y-4 max-h-96 overflow-y-auto\">\r\n              {loadingLikes ? (\r\n                <div className=\"text-center py-4\">\r\n                  <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-coral mx-auto\"></div>\r\n                </div>\r\n              ) : likes.length > 0 ? (\r\n                likes.map((like) => (\r\n                  <div key={like.id || like.user?.id} className=\"flex items-center space-x-3\">\r\n                    <Avatar className=\"w-10 h-10\">\r\n                      <AvatarImage src={(like.avatar_url || like.user?.avatar_url) ? config.getPublicUrl(like.avatar_url || like.user?.avatar_url) : ''} />\r\n                      <AvatarFallback className=\"bg-coral text-white\">\r\n                        {(like.nome || like.user?.nome) ? (like.nome || like.user?.nome).charAt(0) : '?'}\r\n                      </AvatarFallback>\r\n                    </Avatar>\r\n                    <div>\r\n                      <p className=\"font-medium\">{like.nome || like.user?.nome || 'Usuário'}</p>\r\n                      <p className=\"text-sm text-coral\">@{like.username || like.user?.username || 'unknown'}</p>\r\n                    </div>\r\n                  </div>\r\n                ))\r\n              ) : (\r\n                <p className=\"text-center text-gray-500\">Nenhuma curtida ainda.</p>\r\n              )}\r\n            </div>\r\n          </DialogContent>\r\n        </Dialog>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default SocialPost;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from './ui/dialog';\r\nimport { Button } from './ui/button';\r\nimport { Textarea } from './ui/textarea';\r\nimport { Label } from './ui/label';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from './ui/select';\r\nimport { Badge } from './ui/badge';\r\nimport { X } from 'lucide-react';\r\nimport { useToast } from './ui/toast';\r\n\r\nconst EditPostModal = ({ isOpen, onClose, post, onSave }) => {\r\n  const [conteudo, setConteudo] = useState('');\r\n  const [categoria, setCategoria] = useState('');\r\n  const [tags, setTags] = useState([]);\r\n  const [newTag, setNewTag] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const { addToast } = useToast();\r\n\r\n  // Lista de categorias disponíveis\r\n  const categorias = [\r\n    'Geral',\r\n    'Artesanato',\r\n    'Culinária',\r\n    'Moda',\r\n    'Beleza',\r\n    'Tecnologia',\r\n    'Negócios',\r\n    'Saúde',\r\n    'Educação',\r\n  ];\r\n\r\n  // Inicializar campos quando o modal abrir\r\n  useEffect(() => {\r\n    if (isOpen && post) {\r\n      setConteudo(post.conteudo || '');\r\n      setCategoria(post.categoria || 'Geral');\r\n      \r\n      // Parse das tags se existirem\r\n      let parsedTags = [];\r\n      if (post.tags) {\r\n        try {\r\n          if (typeof post.tags === 'string') {\r\n            parsedTags = JSON.parse(post.tags);\r\n          } else if (Array.isArray(post.tags)) {\r\n            parsedTags = post.tags;\r\n          }\r\n        } catch (e) {\r\n          console.warn('Erro ao parsear tags:', e);\r\n          parsedTags = [];\r\n        }\r\n      }\r\n      setTags(parsedTags);\r\n    }\r\n  }, [isOpen, post]);\r\n\r\n  // Limpar campos quando fechar\r\n  useEffect(() => {\r\n    if (!isOpen) {\r\n      setConteudo('');\r\n      setCategoria('Geral');\r\n      setTags([]);\r\n      setNewTag('');\r\n      setLoading(false);\r\n    }\r\n  }, [isOpen]);\r\n\r\n  const handleAddTag = () => {\r\n    if (newTag.trim() && !tags.includes(newTag.trim()) && tags.length < 5) {\r\n      setTags([...tags, newTag.trim()]);\r\n      setNewTag('');\r\n    }\r\n  };\r\n\r\n  const handleRemoveTag = (tagToRemove) => {\r\n    setTags(tags.filter(tag => tag !== tagToRemove));\r\n  };\r\n\r\n  const handleKeyPress = (e) => {\r\n    if (e.key === 'Enter') {\r\n      e.preventDefault();\r\n      handleAddTag();\r\n    }\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    if (!conteudo.trim()) {\r\n      addToast('O conteúdo do post é obrigatório', 'error');\r\n      return;\r\n    }\r\n\r\n    if (conteudo.length > 2000) {\r\n      addToast('O conteúdo deve ter no máximo 2000 caracteres', 'error');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n\r\n    try {\r\n      const updatedData = {\r\n        conteudo: conteudo.trim(),\r\n        categoria,\r\n        tags\r\n      };\r\n\r\n      await onSave(post.id, updatedData);\r\n      addToast('Post atualizado com sucesso!', 'success');\r\n      onClose();\r\n    } catch (error) {\r\n      console.error('Erro ao atualizar post:', error);\r\n      addToast('Erro ao atualizar post. Tente novamente.', 'error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (!post) return null;\r\n\r\n  return (\r\n    <Dialog open={isOpen} onOpenChange={onClose}>\r\n      <DialogContent className=\"max-w-md mx-auto\">\r\n        <DialogHeader>\r\n          <DialogTitle>Editar Post</DialogTitle>\r\n          <DialogDescription>\r\n            Faça alterações no seu post e salve as modificações.\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        <div className=\"space-y-4\">\r\n          {/* Conteúdo */}\r\n          <div>\r\n            <Label htmlFor=\"conteudo\">Conteúdo</Label>\r\n            <Textarea\r\n              id=\"conteudo\"\r\n              value={conteudo}\r\n              onChange={(e) => setConteudo(e.target.value)}\r\n              placeholder=\"O que você gostaria de compartilhar?\"\r\n              className=\"min-h-[120px]\"\r\n              maxLength={2000}\r\n            />\r\n            <div className=\"text-sm text-gray-500 mt-1\">\r\n              {conteudo.length}/2000 caracteres\r\n            </div>\r\n          </div>\r\n\r\n          {/* Categoria */}\r\n          <div>\r\n            <Label htmlFor=\"categoria\">Categoria</Label>\r\n            <Select value={categoria} onValueChange={setCategoria}>\r\n              <SelectTrigger>\r\n                <SelectValue placeholder=\"Selecione uma categoria\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                {categorias.map((cat) => (\r\n                  <SelectItem key={cat} value={cat}>\r\n                    {cat}\r\n                  </SelectItem>\r\n                ))}\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n\r\n          {/* Tags */}\r\n          <div>\r\n            <Label htmlFor=\"tags\">Tags (opcional)</Label>\r\n            <div className=\"flex gap-2 mb-2\">\r\n              <input\r\n                type=\"text\"\r\n                value={newTag}\r\n                onChange={(e) => setNewTag(e.target.value)}\r\n                onKeyPress={handleKeyPress}\r\n                placeholder=\"Digite uma tag e pressione Enter\"\r\n                className=\"flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-coral\"\r\n                maxLength={20}\r\n              />\r\n              <Button\r\n                type=\"button\"\r\n                onClick={handleAddTag}\r\n                disabled={!newTag.trim() || tags.length >= 5}\r\n                size=\"sm\"\r\n              >\r\n                Adicionar\r\n              </Button>\r\n            </div>\r\n            \r\n            {/* Lista de tags */}\r\n            {tags.length > 0 && (\r\n              <div className=\"flex flex-wrap gap-2\">\r\n                {tags.map((tag, index) => (\r\n                  <Badge\r\n                    key={index}\r\n                    variant=\"secondary\"\r\n                    className=\"flex items-center gap-1\"\r\n                  >\r\n                    #{tag}\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={() => handleRemoveTag(tag)}\r\n                      className=\"ml-1 hover:text-red-500\"\r\n                    >\r\n                      <X className=\"h-3 w-3\" />\r\n                    </button>\r\n                  </Badge>\r\n                ))}\r\n              </div>\r\n            )}\r\n            <div className=\"text-sm text-gray-500 mt-1\">\r\n              {tags.length}/5 tags\r\n            </div>\r\n          </div>\r\n\r\n          {/* Botões */}\r\n          <div className=\"flex gap-2 pt-4\">\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"outline\"\r\n              onClick={onClose}\r\n              disabled={loading}\r\n              className=\"flex-1\"\r\n            >\r\n              Cancelar\r\n            </Button>\r\n            <Button\r\n              type=\"button\"\r\n              onClick={handleSave}\r\n              disabled={loading || !conteudo.trim()}\r\n              className=\"flex-1\"\r\n            >\r\n              {loading ? 'Salvando...' : 'Salvar'}\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default EditPostModal;\r\n"],"names":["__iconNode","Reply","createLucideIcon","Share2","CAMPAIGN_OBJECTIVE_LABELS","SocialPost","post","currentUser","onLike","onComment","onShare","onDelete","onUpdate","onSave","onFollow","showSaveButton","isSaved","showGroupBadge","groupName","showComments","setShowComments","useState","comments","setComments","newComment","setNewComment","replyTo","setReplyTo","showLikesList","setShowLikesList","likes","setLikes","isLiked","setIsLiked","likeCount","setLikeCount","commentCount","setCommentCount","loadingComments","setLoadingComments","loadingLikes","setLoadingLikes","saved","setSaved","isFollowing","setIsFollowing","editingComment","setEditingComment","editingText","setEditingText","updatingComment","setUpdatingComment","commentFollowStates","setCommentFollowStates","commentsLoadedRef","useRef","commentsSnapshotRef","isSponsored","campaignInfo","sponsoredBadgeLabel","campaignObjectiveLabel","useEffect","fetchComments","useCallback","response","apiService","error","fetchLikes","updateCommentInState","commentId","updater","prevComments","comment","updated","replyUpdated","updatedReplies","reply","handleStartEditComment","parentId","handleCancelEditComment","handleUpdateComment","newContent","isReply","prev","updatedComment","merged","removeCommentFromState","filteredReplies","handleLike","previousLiked","previousCount","newLiked","newCount","handleComment","tempComment","originalComment","handleDeleteComment","snapshot","handleSave","previousSaved","handleFollow","newFollowing","followersCount","formatTimeAgo","dateString","now","postDate","diffInSeconds","renderMedia","jsx","config","mediaFiles","media","mediaUrl","index","resolveAvatarSrc","avatar","getAvatarFromComment","item","renderReply","displayName","username","avatarSrc","isOwner","isEditingReply","jsxs","Link","Avatar","AvatarImage","AvatarFallback","Fragment","Textarea","e","Button","Edit","Trash2","renderComment","isEditingComment","replies","isCurrentUser","commentIsFollowing","handleCommentFollow","Card","CardContent","Badge","DropdownMenu","DropdownMenuTrigger","MoreHorizontal","DropdownMenuContent","DropdownMenuItem","Megaphone","tags","tag","Heart","MessageCircle","Bookmark","X","Send","i","Dialog","DialogContent","DialogHeader","DialogTitle","DialogDescription","like","EditPostModal","isOpen","onClose","conteudo","setConteudo","categoria","setCategoria","setTags","newTag","setNewTag","loading","setLoading","addToast","useToast","categorias","parsedTags","handleAddTag","handleRemoveTag","tagToRemove","handleKeyPress","updatedData","Label","Select","SelectTrigger","SelectValue","SelectContent","cat","SelectItem"],"mappings":"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","x_google_ignoreList":[0,1]}