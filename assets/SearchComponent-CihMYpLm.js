import{c as ae,r as t,n as v,j as e,A as N,X as I}from"./index-DLqimMV8.js";import{C as $,a as F}from"./card-CY9-ve7w.js";import{I as te}from"./input-FZRWGTRd.js";import{U as S,A as H,a as P,b as z}from"./index-EfjSmcDM.js";import{B as O}from"./badge-CME7s750.js";import{F as re}from"./funnel-BHegw_va.js";import{H as B}from"./hash-CzDnjanY.js";import{T as J}from"./trending-up-D6ou80w9.js";/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],ne=ae("message-square",le),ge=({onResultSelect:k,onResultsUpdate:n,className:M=""})=>{const[c,m]=t.useState(""),[x,A]=t.useState({posts:[],users:[],groups:[],hashtags:[]}),[o,C]=t.useState("all"),[D,T]=t.useState(!1),[L,h]=t.useState(!1),[u,f]=t.useState([]),[_,U]=t.useState([]),[r,y]=t.useState({dateRange:"all",mediaType:"all",category:"all"}),[b,K]=t.useState(!1),Y=t.useRef(null),g=t.useRef(null);t.useEffect(()=>{G(),X()},[]),t.useEffect(()=>(g.current&&clearTimeout(g.current),c.trim().length>=2?g.current=setTimeout(()=>{W(c)},300):(A({posts:[],users:[],groups:[],hashtags:[]}),h(!1),n&&n(null,{query:"",totals:{posts:0,users:0,groups:0,hashtags:0},filters:r})),()=>{g.current&&clearTimeout(g.current)}),[c,r]);const G=()=>{try{const s=localStorage.getItem("empowerup_recent_searches");s&&f(JSON.parse(s))}catch(s){console.error("Erro ao carregar pesquisas recentes:",s)}},V=s=>{try{const a=[s,...u.filter(l=>l!==s)].slice(0,10);f(a),localStorage.setItem("empowerup_recent_searches",JSON.stringify(a))}catch(a){console.error("Erro ao salvar pesquisa recente:",a)}},X=async()=>{try{const s=v.getApiUrl("explore/trending"),a=JSON.parse(localStorage.getItem(v.AUTH.USER_KEY)||"{}"),l={};a?.token&&(l.Authorization=`Bearer ${a.token}`);const p=await fetch(s,{headers:l});if(p.ok){const i=await p.json(),j=Array.isArray(i.trending)?i.trending:Array.isArray(i.trending?.hashtags)?i.trending.hashtags:[];U(j)}}catch(s){console.error("Erro ao carregar trending:",s)}},W=async s=>{if(s.trim()){T(!0),h(!0);try{const a=new URLSearchParams({q:s,tab:o,...r}),l=v.getApiUrl("explore/search"),p=JSON.parse(localStorage.getItem(v.AUTH.USER_KEY)||"{}"),i={};p?.token&&(i.Authorization=`Bearer ${p.token}`);const j=await fetch(`${l}?${a}`,{headers:i});if(j.ok){const w=await j.json(),d=w.results||{posts:[],users:[],groups:[],hashtags:[]};if(A(d),V(s),n){const se=w.meta?.totals||{posts:d.posts?.length||0,users:d.users?.length||0,groups:d.groups?.length||0,hashtags:d.hashtags?.length||0};n(d,{query:s,totals:se,filters:r,meta:w.meta||null})}}else console.error("Erro na pesquisa:",j.status),n&&n(null,{query:s,totals:{posts:0,users:0,groups:0,hashtags:0},filters:r})}catch(a){console.error("Erro na pesquisa:",a),n&&n(null,{query:s,totals:{posts:0,users:0,groups:0,hashtags:0},filters:r})}finally{T(!1)}}},Z=s=>{const a=u.filter(l=>l!==s);f(a),localStorage.setItem("empowerup_recent_searches",JSON.stringify(a))},Q=()=>{f([]),localStorage.removeItem("empowerup_recent_searches")},q=(s,a)=>{k&&k(s,a),h(!1),m("")},E=s=>{m(s),C("all")},ee=[{id:"all",label:"Tudo",icon:N},{id:"posts",label:"Posts",icon:ne},{id:"users",label:"Pessoas",icon:S},{id:"groups",label:"Grupos",icon:S},{id:"hashtags",label:"Hashtags",icon:B}],R=Object.values(x).reduce((s,a)=>s+a.length,0);return e.jsxs("div",{className:`relative ${M}`,ref:Y,children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"relative",children:[e.jsx(N,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(te,{type:"text",placeholder:"Pesquisar posts, pessoas, grupos...",value:c,onChange:s=>m(s.target.value),onFocus:()=>h(c.length>=2||u.length>0),className:"pl-10 pr-20 py-2 text-base"}),e.jsxs("div",{className:"absolute right-2 top-2 flex items-center space-x-1",children:[c&&e.jsx("button",{onClick:()=>{m(""),h(!1)},className:"p-1 hover:bg-gray-100 rounded-full",children:e.jsx(I,{className:"h-4 w-4 text-gray-400"})}),e.jsx("button",{onClick:()=>K(!b),className:`p-1 hover:bg-gray-100 rounded-full ${b?"bg-blue-100 text-blue-600":"text-gray-400"}`,children:e.jsx(re,{className:"h-4 w-4"})})]})]}),b&&e.jsx($,{className:"absolute top-full left-0 right-0 mt-2 z-20 shadow-lg",children:e.jsx(F,{className:"p-4",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Período"}),e.jsxs("select",{value:r.dateRange,onChange:s=>y({...r,dateRange:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[e.jsx("option",{value:"all",children:"Qualquer período"}),e.jsx("option",{value:"today",children:"Hoje"}),e.jsx("option",{value:"week",children:"Esta semana"}),e.jsx("option",{value:"month",children:"Este mês"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Tipo de mídia"}),e.jsxs("select",{value:r.mediaType,onChange:s=>y({...r,mediaType:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[e.jsx("option",{value:"all",children:"Todos os tipos"}),e.jsx("option",{value:"images",children:"Apenas imagens"}),e.jsx("option",{value:"videos",children:"Apenas vídeos"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Categoria"}),e.jsxs("select",{value:r.category,onChange:s=>y({...r,category:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[e.jsx("option",{value:"all",children:"Todas as categorias"}),e.jsx("option",{value:"Artesanato",children:"Artesanato"}),e.jsx("option",{value:"Negócios",children:"Negócios"}),e.jsx("option",{value:"Culinária",children:"Culinária"}),e.jsx("option",{value:"Moda",children:"Moda"}),e.jsx("option",{value:"Tecnologia",children:"Tecnologia"})]})]})]})})})]}),L&&e.jsx($,{className:"absolute top-full left-0 right-0 mt-2 z-10 shadow-lg max-h-96 overflow-hidden",children:e.jsx(F,{className:"p-0",children:c.length>=2?e.jsxs("div",{children:[e.jsx("div",{className:"flex border-b border-gray-200 px-4",children:ee.map(s=>{const a=s.icon,l=s.id==="all"?R:x[s.id]?.length||0;return e.jsxs("button",{onClick:()=>C(s.id),className:`flex items-center space-x-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors ${o===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(a,{className:"h-4 w-4"}),e.jsx("span",{children:s.label}),l>0&&e.jsx(O,{variant:"secondary",className:"ml-1 text-xs",children:l})]},s.id)})}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:D?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"}),e.jsx("span",{className:"ml-2 text-gray-500",children:"Pesquisando..."})]}):R===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(N,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsxs("p",{children:['Nenhum resultado encontrado para "',c,'"']})]}):e.jsxs("div",{className:"divide-y divide-gray-100",children:[(o==="all"||o==="posts")&&x.posts?.map(s=>e.jsx("div",{onClick:()=>q(s,"post"),className:"p-4 hover:bg-gray-50 cursor-pointer",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsxs(H,{className:"w-8 h-8",children:[e.jsx(P,{src:s.user_foto}),e.jsx(z,{children:s.user_nome?.charAt(0)})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium text-sm",children:s.user_nome}),e.jsxs("span",{className:"text-gray-500 text-xs",children:["@",s.username]}),e.jsx("span",{className:"text-gray-400 text-xs",children:"·"}),e.jsx("span",{className:"text-gray-400 text-xs",children:s.tempo_relativo})]}),e.jsx("p",{className:"text-sm text-gray-900 mt-1 line-clamp-2",children:s.conteudo}),s.categoria&&e.jsx(O,{variant:"outline",className:"mt-1 text-xs",children:s.categoria})]})]})},`post-${s.id}`)),(o==="all"||o==="users")&&x.users?.map(s=>e.jsx("div",{onClick:()=>q(s,"user"),className:"p-4 hover:bg-gray-50 cursor-pointer",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(H,{className:"w-10 h-10",children:[e.jsx(P,{src:s.foto_perfil}),e.jsx(z,{children:s.nome?.charAt(0)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-sm",children:s.nome}),e.jsxs("div",{className:"text-gray-500 text-xs",children:["@",s.username]}),s.bio&&e.jsx("p",{className:"text-gray-600 text-xs mt-1 line-clamp-1",children:s.bio})]}),e.jsx(S,{className:"h-4 w-4 text-gray-400"})]})},`user-${s.id}`)),(o==="all"||o==="hashtags")&&x.hashtags?.map(s=>e.jsx("div",{onClick:()=>E(s.tag),className:"p-4 hover:bg-gray-50 cursor-pointer",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(B,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-sm",children:["#",s.tag]}),e.jsxs("div",{className:"text-gray-500 text-xs",children:[s.count," posts"]})]})]}),e.jsx(J,{className:"h-4 w-4 text-gray-400"})]})},`hashtag-${s.tag}`))]})})]}):e.jsxs("div",{className:"max-h-64 overflow-y-auto",children:[u.length>0&&e.jsxs("div",{className:"p-4 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-medium text-sm text-gray-900",children:"Pesquisas recentes"}),e.jsx("button",{onClick:Q,className:"text-xs text-blue-600 hover:text-blue-800",children:"Limpar tudo"})]}),e.jsx("div",{className:"space-y-2",children:u.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between group",children:[e.jsxs("button",{onClick:()=>m(s),className:"flex items-center space-x-3 text-left flex-1 hover:bg-gray-50 rounded p-2",children:[e.jsx(N,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-700",children:s})]}),e.jsx("button",{onClick:()=>Z(s),className:"p-1 hover:bg-gray-100 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(I,{className:"h-3 w-3 text-gray-400"})})]},a))})]}),_.length>0&&e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-medium text-sm text-gray-900 mb-3",children:"Trending para você"}),e.jsx("div",{className:"space-y-2",children:_.slice(0,5).map((s,a)=>e.jsxs("button",{onClick:()=>E(s.tag),className:"flex items-center justify-between w-full text-left hover:bg-gray-50 rounded p-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium",children:["#",s.tag]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[s.count," posts"]})]}),e.jsx(J,{className:"h-4 w-4 text-gray-400"})]},a))})]})]})})})]})};export{ge as S};
//# sourceMappingURL=SearchComponent-CihMYpLm.js.map
