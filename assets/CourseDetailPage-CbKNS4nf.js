import{c as ae,w as re,a as te,u as oe,r as o,m as j,n as le,j as e,B as c,i as x,L as F}from"./index-DLqimMV8.js";import{a as f}from"./index-iG6a_0Cv.js";import{C as b,b as N,a as v}from"./card-CY9-ve7w.js";import{B as u}from"./badge-CME7s750.js";import{u as ce}from"./toast-7vBxPuBc.js";import{S as ie}from"./shield-Dd8xFKSO.js";import{A as ne}from"./arrow-left-BeWKRKPu.js";import{S as $}from"./index-BgaOpAAA.js";import{L as de}from"./layers-DqJk4Cvx.js";import{a as me}from"./bookmark-B2_N_nt6.js";import{C as Z}from"./clock-BtJpcJw2.js";import{L as G}from"./loader-circle-ClwSyFO1.js";import{C as xe,a as ue}from"./chevron-up-DKadsFnq.js";import{C as he}from"./circle-check-big-B0wfPxzh.js";import{C as pe}from"./circle-play-DfHv_aMX.js";import"./site-header-CKtPnSCF.js";import"./index-EfjSmcDM.js";import"./dropdown-menu-7k7ytBg1.js";import"./heart-D1UYKJAB.js";import"./calendar-BcaNxl4E.js";import"./user-BOjY7V17.js";import"./log-out-Cu_b7vs0.js";import"./site-footer-btaBgloE.js";import"./input-FZRWGTRd.js";import"./crown-BrBsF1Iu.js";import"./map-pin-XNZDTA2K.js";import"./circle-alert-Bp1UBQ88.js";/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],J=ae("file-text",ge),$e=()=>{const{identifier:h}=re(),y=te(),{user:je}=oe(),{addToast:n}=ce(),[r,P]=o.useState(null),[K,z]=o.useState(!0),[A,p]=o.useState(""),[B,w]=o.useState(null),[g,D]=o.useState({}),[C,q]=o.useState(0),[Q,I]=o.useState({}),[O,R]=o.useState(0),[V,H]=o.useState(!1),d=h||r?.slug||r?.id,W=s=>{I(a=>({...a,[s]:!a[s]}))},U=o.useCallback((s=[])=>{const a={};return s.forEach(l=>{a[l.lesson_id]=l}),a},[]),k=o.useCallback(async()=>{if(d)try{const s=await j.getCourseProgress(d);s?.success&&s.progress&&(D(U(s.progress.lessons||[])),q(s.progress.progress||0),P(a=>a&&{...a,enrollment:a.enrollment?{...a.enrollment,progresso:s.progress.progress}:a.enrollment}))}catch(s){console.error("Erro ao carregar progresso do curso:",s)}},[d,U]),L=o.useCallback(async()=>{if(h){z(!0),p(""),w(null);try{const s=await j.getCourse(h);if(s?.success&&s.course){const a=s.course;P(a);const l={};(a.modules||[]).forEach(_=>{l[_.id]=!0}),I(l),a.enrollment?await k():(D({}),q(0))}else p(s?.message||"Curso não encontrado.")}catch(s){console.error("Erro ao carregar curso:",s),s?.status===403?w({message:s?.data?.message||"Seu plano atual não permite acesso a este curso.",subscription:s?.data?.subscription||null}):s?.status===404?p("Curso não encontrado ou indisponível no momento."):p(s?.message||"Erro ao carregar curso.")}finally{z(!1)}}},[h,k]);o.useEffect(()=>{L()},[L]);const X=async()=>{if(d){H(!0);try{const s=await j.enrollCourse(d);s?.success?(n("Inscrição realizada com sucesso!","success"),await L()):n(s?.message||"Não foi possível concluir a inscrição.","error")}catch(s){console.error("Erro ao inscrever no curso:",s),s?.status===403&&w({message:s?.data?.message||"Seu plano atual não permite acesso a este curso.",subscription:s?.data?.subscription||null}),n(s?.message||"Erro ao realizar inscrição.","error")}finally{H(!1)}}},Y=async s=>{if(!r?.enrollment){n("Inscreva-se no curso para marcar seu progresso.","error");return}R(s.id);try{const a=g[s.id]?.watched||!1;await j.updateLessonProgress(d,s.id,{watched:!a}),await k(),n(a?"Progresso revertido.":"Lição marcada como concluída!","success")}catch(a){console.error("Erro ao atualizar progresso da lição:",a),n(a?.message||"Não foi possível atualizar o progresso.","error")}finally{R(0)}},S=o.useMemo(()=>r?.imagem_capa?{backgroundImage:`linear-gradient(rgba(15,23,42,0.68), rgba(15,23,42,0.72)), url(${le.getPublicUrl(r.imagem_capa)})`,backgroundSize:"cover",backgroundPosition:"center"}:null,[r?.imagem_capa]),ee=()=>e.jsxs("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 p-8 text-center",children:[e.jsx($,{className:"mx-auto h-10 w-10 text-amber-500"}),e.jsx("h2",{className:"mt-4 text-xl font-semibold text-gray-900",children:"Conteúdo exclusivo para assinantes"}),e.jsx("p",{className:"mt-2 text-gray-600",children:B?.message||"Faça upgrade do seu plano para desbloquear os cursos completos da EmpowerUp."}),e.jsxs("div",{className:"mt-6 flex justify-center gap-3",children:[e.jsx(c,{variant:"outline",onClick:()=>y(-1),children:"Voltar"}),e.jsx(c,{asChild:!0,className:"bg-coral hover:bg-coral/90",children:e.jsx(F,{to:"/planos",children:"Conhecer planos"})})]})]});if(K)return e.jsx(f,{title:"Carregando curso...",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"h-60 w-full animate-pulse rounded-2xl bg-gray-200"}),e.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-10 animate-pulse rounded bg-gray-200"}),e.jsx("div",{className:"h-10 animate-pulse rounded bg-gray-200"}),e.jsx("div",{className:"h-10 animate-pulse rounded bg-gray-200"})]}),e.jsx("div",{className:"lg:col-span-2 space-y-4",children:Array.from({length:4}).map((s,a)=>e.jsx("div",{className:"h-28 animate-pulse rounded-lg bg-gray-200"},a))})]})]})});if(A)return e.jsx(f,{title:"Curso indisponível",children:e.jsxs("div",{className:"rounded-2xl border border-red-200 bg-red-50 p-8 text-center",children:[e.jsx(ie,{className:"mx-auto h-10 w-10 text-red-500"}),e.jsx("h2",{className:"mt-4 text-xl font-semibold text-gray-900",children:"Ops! Algo deu errado."}),e.jsx("p",{className:"mt-2 text-gray-600",children:A}),e.jsx("div",{className:"mt-6",children:e.jsx(c,{onClick:()=>y("/cursos"),children:"Voltar para cursos"})})]})});if(B)return e.jsx(f,{title:"Acesso restrito",children:ee()});if(!r)return null;const i=r.enrollment,T=r.modules?.length||0,M=r.modules?.reduce((s,a)=>s+(a.lessons?.length||0),0)||0;return e.jsxs("div",{className:"bg-gray-50",children:[e.jsx("div",{className:"-mt-8",children:e.jsx("div",{className:"relative overflow-hidden rounded-none md:rounded-b-[40px]",style:S||void 0,children:e.jsxs("div",{className:x("relative z-10 px-4 py-12 sm:px-8 lg:px-16",S?"text-white":"text-gray-900 bg-gradient-to-r from-white to-emerald-50"),children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm font-medium uppercase tracking-wide opacity-80",children:[e.jsxs(c,{variant:"ghost",size:"sm",onClick:()=>y(-1),className:x("gap-2",S?"text-white hover:text-white/80":"text-gray-700"),children:[e.jsx(ne,{className:"h-4 w-4"})," Voltar"]}),e.jsx("span",{children:"Curso • EmpowerUp Academy"})]}),e.jsxs("div",{className:"mt-6 flex flex-wrap items-center gap-4",children:[r.categoria&&e.jsx(u,{variant:"secondary",children:r.categoria}),r.nivel&&e.jsxs(u,{variant:"outline",children:["Nível ",r.nivel]}),r.destaque&&e.jsxs(u,{className:"bg-amber-500/90 text-white",children:[e.jsx($,{className:"mr-1 h-3.5 w-3.5"})," Destaque"]})]}),e.jsx("h1",{className:"mt-4 max-w-3xl text-3xl font-bold leading-tight sm:text-4xl",children:r.titulo}),e.jsx("p",{className:"mt-4 max-w-2xl text-base sm:text-lg opacity-90",children:r.descricao||"Domine novas habilidades com aulas práticas e materiais exclusivos desenvolvidos para empreendedoras."}),e.jsxs("div",{className:"mt-8 flex flex-wrap gap-6 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-5 w-5"})," ",T," módulo",T===1?"":"s"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-5 w-5"})," ",M," aula",M===1?"":"s"]}),r.duracao_estimado&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5"}),r.duracao_estimado," min estimados"]})]}),e.jsxs("div",{className:"mt-8 flex flex-wrap items-center gap-4",children:[i?e.jsx(u,{variant:"secondary",className:"bg-emerald-500/90 text-white",children:"Você está inscrita"}):e.jsx(c,{size:"lg",className:"bg-coral hover:bg-coral/90",disabled:V,onClick:X,children:V?e.jsx(G,{className:"h-5 w-5 animate-spin"}):"Inscrever-se agora"}),i&&e.jsxs("div",{className:"min-w-[220px] rounded-full bg-white/20 px-4 py-2 text-sm",children:["Progresso: ",Math.round(C),"%"]})]})]})})}),e.jsx(f,{className:"bg-transparent",breadcrumbs:[{label:"Início",href:"/"},{label:"Cursos",href:"/cursos"},{label:r.titulo}],children:e.jsxs("div",{className:"grid gap-8 lg:grid-cols-[2fr,1fr]",children:[e.jsx("div",{className:"space-y-6",children:r.modules?.map((s,a)=>{const l=Q[s.id]??!0,_=s.lessons?.filter(t=>g[t.id]?.watched)?.length||0,se=s.lessons?.length||0;return e.jsxs(b,{className:"border border-gray-200 shadow-sm",children:[e.jsxs(N,{className:x("flex cursor-pointer items-center justify-between gap-3",l?"border-b border-gray-100 pb-3":""),onClick:()=>W(s.id),children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs font-semibold uppercase tracking-wide text-coral",children:["Módulo ",a+1]}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:s.titulo}),s.descricao&&e.jsx("p",{className:"mt-1 text-sm text-gray-600 line-clamp-2",children:s.descricao})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-500",children:[e.jsxs("span",{children:[_,"/",se," aulas concluídas"]}),e.jsx(c,{variant:"ghost",size:"icon",className:"h-8 w-8","aria-label":"Alternar módulo",children:l?e.jsx(xe,{className:"h-5 w-5"}):e.jsx(ue,{className:"h-5 w-5"})})]})]}),l&&e.jsx(v,{className:"space-y-4",children:s.lessons?.length?s.lessons.map(t=>{const E=g[t.id],m=!!E?.watched;return e.jsx("div",{className:x("rounded-lg border p-4 transition-colors",m?"border-emerald-200 bg-emerald-50":"border-gray-200 bg-white hover:border-coral/40"),children:e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm font-medium text-gray-900",children:[m?e.jsx(he,{className:"h-4 w-4 text-emerald-500"}):e.jsx(pe,{className:"h-4 w-4 text-coral"}),e.jsx("span",{children:t.titulo}),t.tipo&&e.jsx(u,{variant:"outline",className:"text-xs uppercase",children:t.tipo})]}),t.descricao&&e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:t.descricao}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-4 text-xs text-gray-500",children:[t.duracao_min&&e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(Z,{className:"h-3.5 w-3.5"}),t.duracao_min," min"]}),t.conteudo_url&&e.jsxs("a",{className:"inline-flex items-center gap-1 text-coral hover:text-coral/80",href:t.conteudo_url,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(J,{className:"h-3.5 w-3.5"}),"Abrir conteúdo"]}),E?.watched_at&&e.jsxs("span",{children:["Concluída em ",new Date(E.watched_at).toLocaleDateString("pt-BR")]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(c,{size:"sm",variant:m?"outline":"default",className:x(m?"border-emerald-400 text-emerald-700":"bg-coral hover:bg-coral/90"),disabled:O===t.id,onClick:()=>Y(t),children:O===t.id?e.jsx(G,{className:"h-4 w-4 animate-spin"}):m?"Marcar como pendente":"Concluir lição"})})]})},t.id)}):e.jsx("div",{className:"rounded-lg border border-dashed border-gray-200 bg-gray-50 p-6 text-center text-sm text-gray-500",children:"Nenhuma lição cadastrada para este módulo ainda."})})]},s.id)})}),e.jsxs("aside",{className:"space-y-6",children:[e.jsxs(b,{className:"border border-gray-200 shadow-sm",children:[e.jsxs(N,{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Seu progresso"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Acompanhe seu avanço e conclua todas as aulas para desbloquear certificados."})]}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("span",{children:[Math.round(C),"% concluído"]}),e.jsxs("span",{children:[Object.values(g).filter(s=>s.watched).length,"/",M," aulas"]})]}),e.jsx("div",{className:"mt-2 h-3 w-full overflow-hidden rounded-full bg-gray-200",children:e.jsx("div",{className:"h-full rounded-full bg-coral transition-all",style:{width:`${Math.min(100,Math.max(0,C))}%`}})})]}),i?e.jsxs("div",{className:"rounded-lg border border-emerald-200 bg-emerald-50 p-4 text-sm text-emerald-700",children:["Você iniciou este curso em"," ",i.iniciado_em?new Date(i.iniciado_em).toLocaleDateString("pt-BR"):"recentemente","."]}):e.jsx("div",{className:"rounded-lg border border-coral/40 bg-coral/5 p-4 text-sm text-coral-700",children:"Faça sua inscrição para liberar o conteúdo completo e registrar seu progresso."})]})]}),r.resources?.length?e.jsxs(b,{className:"border border-gray-200 shadow-sm",children:[e.jsxs(N,{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Materiais de apoio"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Links e arquivos complementares para ampliar seu aprendizado."})]}),e.jsx(v,{className:"space-y-3",children:r.resources.map(s=>e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between rounded-lg border border-gray-200 p-3 text-sm text-gray-700 transition-colors hover:border-coral/60 hover:bg-coral/5",children:[e.jsx("span",{className:"font-medium",children:s.titulo}),e.jsx(J,{className:"h-4 w-4 text-coral"})]},s.id))})]}):null,e.jsxs(b,{className:"border border-gray-200 shadow-sm",children:[e.jsx(N,{children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Dica EmpowerUp"})}),e.jsxs(v,{className:"space-y-3 text-sm text-gray-600",children:[e.jsx("p",{children:"Aproveite os fóruns e grupos da comunidade para compartilhar dúvidas sobre este curso. O aprendizado em rede acelera seu desenvolvimento!"}),e.jsx(c,{asChild:!0,variant:"outline",size:"sm",className:"w-full",children:e.jsx(F,{to:i?"/comunidade?tab=posts":"/planos",children:i?"Ir para a comunidade":"Conhecer planos"})})]})]})]})]})})]})};export{$e as default};
//# sourceMappingURL=CourseDetailPage-CbKNS4nf.js.map
