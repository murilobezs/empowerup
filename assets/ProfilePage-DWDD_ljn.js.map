{"version":3,"file":"ProfilePage-DWDD_ljn.js","sources":["../../src/pages/ProfilePage.jsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useMemo } from 'react';\r\nimport { useParams, useNavigate, Link } from 'react-router-dom';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { ProfileLayout } from '../components/layout';\r\nimport { Loading, ErrorMessage, EmptyState } from '../components/common';\r\nimport SocialPost from '../components/SocialPost';\r\nimport EditPostModal from '../components/EditPostModal';\r\nimport { Button } from '../components/ui/button';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '../components/ui/tabs';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from '../components/ui/dialog';\r\nimport { Avatar, AvatarImage, AvatarFallback } from '../components/ui/avatar';\r\nimport { useToast } from '../components/ui/toast';\r\nimport apiService from '../services/api';\r\nimport config from '../config/config';\r\nimport { Edit, Heart, Bookmark, Users, ShoppingBag, CheckCircle2, Circle, ArrowUpRight, Sparkles } from 'lucide-react';\r\nimport { utils } from '../utils';\r\n\r\nconst ProfilePage = () => {\r\n  const { username } = useParams();\r\n  const navigate = useNavigate();\r\n  const { user: currentUser, updateCover } = useAuth();\r\n  const [user, setUser] = useState(null);\r\n  const [posts, setPosts] = useState([]);\r\n  const [likedPosts, setLikedPosts] = useState([]);\r\n  const [savedPosts, setSavedPosts] = useState([]);\r\n  const [followers, setFollowers] = useState([]);\r\n  const [following, setFollowing] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n  const [activeTab, setActiveTab] = useState('posts');\r\n  const [editingPost, setEditingPost] = useState(null);\r\n  const [showEditModal, setShowEditModal] = useState(false);\r\n  const [showFollowersModal, setShowFollowersModal] = useState(false);\r\n  const [showFollowingModal, setShowFollowingModal] = useState(false);\r\n  const [isLoadingFollow, setIsLoadingFollow] = useState(false);\r\n  const [loadingFollowers, setLoadingFollowers] = useState(false);\r\n  const [loadingFollowing, setLoadingFollowing] = useState(false);\r\n  const [isCoverUploading, setIsCoverUploading] = useState(false);\r\n\r\n  const { addToast } = useToast();\r\n\r\n  const isOwnProfile = !username || username === currentUser?.username;\r\n\r\n  const toAbsoluteUrl = useCallback((value) => {\r\n    if (!value) return null;\r\n    if (typeof value !== 'string') return null;\r\n    if (/^https?:\\/\\//.test(value)) {\r\n      return value;\r\n    }\r\n    return config.getPublicUrl(value.startsWith('/') ? value.slice(1) : value);\r\n  }, []);\r\n\r\n  const normalizeProfileUser = useCallback((rawUser) => {\r\n    if (!rawUser) return rawUser;\r\n    const normalized = { ...rawUser };\r\n\r\n    const avatarPath = rawUser.avatar_url || rawUser.foto_perfil || rawUser.avatar;\r\n    if (avatarPath) {\r\n      normalized.avatar_url = rawUser.avatar_url || avatarPath;\r\n      normalized.foto_perfil = toAbsoluteUrl(avatarPath) || rawUser.foto_perfil || null;\r\n    }\r\n\r\n    const coverPath = rawUser.capa_url || rawUser.cover_image || rawUser.cover_url || rawUser.capa;\r\n    if (coverPath) {\r\n      normalized.capa_url = rawUser.capa_url || (coverPath.startsWith('/') ? coverPath : `/${coverPath}`);\r\n      normalized.cover_image = toAbsoluteUrl(coverPath) || rawUser.cover_image || null;\r\n    }\r\n\r\n    return normalized;\r\n  }, [toAbsoluteUrl]);\r\n\r\n  useEffect(() => {\r\n    const loadLikedPosts = async () => {\r\n      if (!isOwnProfile) return;\r\n      try {\r\n        const response = await apiService.getLikedPosts();\r\n        setLikedPosts(response.posts || []);\r\n      } catch (e) {\r\n        console.error('Erro ao carregar posts curtidos:', e);\r\n      }\r\n    };\r\n\r\n    const loadSavedPosts = async () => {\r\n      if (!isOwnProfile) return;\r\n      try {\r\n        const response = await apiService.getSavedPosts();\r\n        setSavedPosts(response.posts || []);\r\n      } catch (e) {\r\n        console.error('Erro ao carregar posts salvos:', e);\r\n      }\r\n    };\r\n\r\n    const loadFollowers = async (userId) => {\r\n      try {\r\n        setLoadingFollowers(true);\r\n        const response = await apiService.getUserFollowers(userId);\r\n        const followersList = response.followers || [];\r\n        setFollowers(followersList);\r\n        setUser(prev => prev ? {\r\n          ...prev,\r\n          followers_count: followersList.length\r\n        } : prev);\r\n      } catch (e) {\r\n        console.error('Erro ao carregar seguidores:', e);\r\n      } finally {\r\n        setLoadingFollowers(false);\r\n      }\r\n    };\r\n\r\n    const loadFollowing = async (userId) => {\r\n      try {\r\n        setLoadingFollowing(true);\r\n        const response = await apiService.getUserFollowing(userId);\r\n        const followingList = response.following || [];\r\n        setFollowing(followingList);\r\n        setUser(prev => prev ? {\r\n          ...prev,\r\n          following_count: followingList.length\r\n        } : prev);\r\n      } catch (e) {\r\n        console.error('Erro ao carregar seguindo:', e);\r\n      } finally {\r\n        setLoadingFollowing(false);\r\n      }\r\n    };\r\n\r\n    const loadProfile = async () => {\r\n      setLoading(true);\r\n      setError('');\r\n      try {\r\n        let profile;\r\n        if (isOwnProfile && currentUser) {\r\n          const detail = await apiService.getUser(currentUser.id);\r\n          profile = detail.user;\r\n        } else {\r\n          const searchData = await apiService.searchUsers(username);\r\n          const found = Array.isArray(searchData.users)\r\n            ? searchData.users.find(u => u.username === username)\r\n            : null;\r\n          if (!found) throw new Error('Usuário não encontrado');\r\n          const detail = await apiService.getUser(found.id);\r\n          profile = detail.user;\r\n        }\r\n\r\n        const normalizedProfile = normalizeProfileUser(profile);\r\n        setUser(normalizedProfile);\r\n\r\n        const postsData = await apiService.getPosts({ user_id: profile.id });\r\n        setPosts(postsData.posts || postsData);\r\n\r\n        if (isOwnProfile) {\r\n          loadLikedPosts();\r\n          loadSavedPosts();\r\n        }\r\n\r\n        if (profile.id) {\r\n          loadFollowers(profile.id);\r\n          loadFollowing(profile.id);\r\n        }\r\n      } catch (e) {\r\n        setError(e.message || 'Erro ao carregar perfil');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadProfile();\r\n  }, [username, currentUser, isOwnProfile, normalizeProfileUser]);\r\n\r\n  const handleSaveEditPost = async (postId, updatedData) => {\r\n    try {\r\n      const res = await apiService.updatePost(postId, updatedData);\r\n      if (res.success) {\r\n        setPosts(prev => prev.map(p => \r\n          p.id === postId \r\n            ? { ...p, ...res.post }\r\n            : p\r\n        ));\r\n        addToast('Post atualizado com sucesso!', 'success')\r\n      } else {\r\n        throw new Error(res.message || 'Erro ao atualizar post')\r\n      }\r\n    } catch (error) {\r\n      console.error('Erro ao atualizar post:', error)\r\n      addToast('Erro ao atualizar post. Tente novamente.', 'error')\r\n      throw error\r\n    }\r\n  };\r\n\r\n  const handleFollowersClick = () => {\r\n    setShowFollowersModal(true);\r\n  };\r\n\r\n  const handleFollowingClick = () => {\r\n    setShowFollowingModal(true);\r\n  };\r\n\r\n  const handleToggleFollow = async () => {\r\n    if (!user) return;\r\n\r\n    try {\r\n      setIsLoadingFollow(true);\r\n      const res = await apiService.toggleFollow(user.id);\r\n      if (res.success) {\r\n        setUser(prev => {\r\n          if (!prev) return prev;\r\n          return {\r\n            ...prev,\r\n            isFollowed: res.following,\r\n            followers_count: res.followers_count ?? res.followersCount ?? prev.followers_count\r\n          };\r\n        });\r\n      }\r\n    } catch (e) {\r\n      console.error('Erro ao seguir:', e);\r\n    } finally {\r\n      setIsLoadingFollow(false);\r\n    }\r\n  };\r\n\r\n  const handleCoverUpload = async (file) => {\r\n    if (!file || !isOwnProfile) return;\r\n\r\n    if (!utils.isImage(file)) {\r\n      addToast('Apenas imagens são permitidas para a capa.', 'error');\r\n      return;\r\n    }\r\n\r\n    if (file.size > config.UPLOAD.MAX_FILE_SIZE) {\r\n      const sizeInMb = Math.round((config.UPLOAD.MAX_FILE_SIZE / (1024 * 1024)) * 10) / 10;\r\n      addToast(`Imagem deve ter no máximo ${sizeInMb}MB.`, 'error');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsCoverUploading(true);\r\n      const result = await updateCover(file);\r\n      if (result.success && result.user) {\r\n        const normalized = normalizeProfileUser(result.user);\r\n        setUser(prev => ({ ...(prev || {}), ...normalized }));\r\n        addToast('Capa atualizada com sucesso!', 'success');\r\n      } else {\r\n        addToast(result.message || 'Erro ao atualizar capa.', 'error');\r\n      }\r\n    } catch (error) {\r\n      console.error('Erro ao atualizar capa:', error);\r\n      addToast('Erro ao atualizar capa. Tente novamente.', 'error');\r\n    } finally {\r\n      setIsCoverUploading(false);\r\n    }\r\n  };\r\n\r\n  const storeUrl = useMemo(() => {\r\n    if (!user?.website) return null;\r\n    const trimmed = user.website.trim();\r\n    if (!trimmed) return null;\r\n    const normalized = /^https?:\\/\\//i.test(trimmed) ? trimmed : `https://${trimmed}`;\r\n    try {\r\n      const validated = new URL(normalized);\r\n      return validated.href;\r\n    } catch (error) {\r\n      console.warn('Website inválido para exibição:', trimmed, error);\r\n      return null;\r\n    }\r\n  }, [user?.website]);\r\n\r\n  const storeLabel = useMemo(() => {\r\n    if (!storeUrl) return null;\r\n    try {\r\n      const url = new URL(storeUrl);\r\n      const hostname = url.hostname.replace(/^www\\./i, '');\r\n      const path = url.pathname && url.pathname !== '/' ? url.pathname : '';\r\n      return `${hostname}${path}`;\r\n    } catch {\r\n      return user?.website;\r\n    }\r\n  }, [storeUrl, user?.website]);\r\n\r\n  const storeHighlightName = useMemo(() => {\r\n    if (!user?.nome) return 'nossa empreendedora';\r\n    const firstName = user.nome.trim().split(' ')[0];\r\n    return firstName || user.nome;\r\n  }, [user?.nome]);\r\n\r\n  const completionItems = useMemo(() => {\r\n    if (!isOwnProfile || !user) return [];\r\n\r\n    const hasAvatar = Boolean(user.foto_perfil || user.avatar_url);\r\n    const hasCover = Boolean(user.cover_image || user.capa_url);\r\n    const hasBio = Boolean(user.bio && user.bio.trim().length >= 30);\r\n    const hasWebsite = Boolean(storeUrl);\r\n    const hasLocation = Boolean(user.localizacao && user.localizacao.trim().length > 0);\r\n\r\n    return [\r\n      {\r\n        id: 'avatar',\r\n        label: 'Adicione uma foto de perfil acolhedora',\r\n        completed: hasAvatar,\r\n      },\r\n      {\r\n        id: 'cover',\r\n        label: 'Personalize a capa do seu perfil',\r\n        completed: hasCover,\r\n      },\r\n      {\r\n        id: 'bio',\r\n        label: 'Conte sua história em pelo menos 30 caracteres',\r\n        completed: hasBio,\r\n      },\r\n      {\r\n        id: 'website',\r\n        label: 'Conecte a sua loja do marketplace',\r\n        completed: hasWebsite,\r\n      },\r\n      {\r\n        id: 'localizacao',\r\n        label: 'Mostre de onde você empreende',\r\n        completed: hasLocation,\r\n      },\r\n    ];\r\n  }, [\r\n    isOwnProfile,\r\n    storeUrl,\r\n    user?.foto_perfil,\r\n    user?.avatar_url,\r\n    user?.cover_image,\r\n    user?.capa_url,\r\n    user?.bio,\r\n    user?.localizacao\r\n  ]);\r\n\r\n  const completionProgress = useMemo(() => {\r\n    if (!completionItems.length) return 100;\r\n    const completed = completionItems.filter(item => item.completed).length;\r\n    return Math.round((completed / completionItems.length) * 100);\r\n  }, [completionItems]);\r\n\r\n  const hasProfileGaps = useMemo(() => {\r\n    if (!isOwnProfile) return false;\r\n    return completionItems.some(item => !item.completed);\r\n  }, [completionItems, isOwnProfile]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <ProfileLayout>\r\n        <Loading size=\"lg\" text=\"Carregando perfil...\" />\r\n      </ProfileLayout>\r\n    );\r\n  }\r\n\r\n  if (error || !user) {\r\n    return (\r\n      <ProfileLayout>\r\n        <ErrorMessage message={error || 'Perfil não encontrado'} />\r\n      </ProfileLayout>\r\n    );\r\n  }\r\n\r\n  const profileInfoActions = isOwnProfile ? (\r\n    <Button onClick={() => navigate('/editar-perfil')} variant=\"outline\" className=\"flex items-center gap-2\">\r\n      <Edit className=\"w-4 h-4\" />\r\n      Editar Perfil\r\n    </Button>\r\n  ) : (\r\n    <Button\r\n      onClick={handleToggleFollow}\r\n      disabled={isLoadingFollow}\r\n      className={`min-w-[120px] ${\r\n        user.isFollowed \r\n          ? 'bg-white text-coral border-2 border-coral hover:bg-coral/5' \r\n          : 'bg-coral text-white hover:bg-coral/90 border-2 border-coral'\r\n      }`}\r\n    >\r\n      {isLoadingFollow ? 'Atualizando...' : user.isFollowed ? 'Seguindo' : 'Seguir'}\r\n    </Button>\r\n  );\r\n\r\n  return (\r\n    <ProfileLayout\r\n      user={user}\r\n      coverImage={user?.cover_image || user?.capa_url || user?.capa}\r\n      canEditCover={isOwnProfile}\r\n      onCoverSelect={handleCoverUpload}\r\n      isCoverUploading={isCoverUploading}\r\n      infoActions={profileInfoActions}\r\n    >\r\n      <div className=\"max-w-4xl mx-auto space-y-6\">\r\n        {storeUrl && (\r\n          <div className=\"bg-gradient-to-r from-green-50 via-olive/5 to-white border border-olive/20 rounded-2xl p-6 shadow-sm flex flex-col gap-6 sm:flex-row sm:items-center sm:justify-between\">\r\n            <div className=\"flex items-start gap-4\">\r\n              <div className=\"flex h-14 w-14 items-center justify-center rounded-full bg-olive text-white shadow-md\">\r\n                <ShoppingBag className=\"w-7 h-7\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-xs font-semibold uppercase tracking-wide text-olive\">Loja oficial no marketplace</p>\r\n                <h2 className=\"text-xl font-semibold text-gray-900 mt-1\">Visite minha loja no marketplace!</h2>\r\n                <p className=\"text-sm text-gray-600 mt-2\">\r\n                  Descubra os produtos e serviços de {storeHighlightName}.\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <div className=\"flex flex-col items-start gap-2 sm:items-end\">\r\n              <Button\r\n                asChild\r\n                variant=\"secondary\"\r\n                className=\"bg-olive text-white hover:bg-olive/90 shadow-md\"\r\n              >\r\n                <a href={storeUrl} target=\"_blank\" rel=\"noopener noreferrer\" className=\"flex items-center gap-2\">\r\n                  Visitar loja\r\n                  <ArrowUpRight className=\"w-4 h-4\" />\r\n                </a>\r\n              </Button>\r\n              {storeLabel && (\r\n                <span className=\"text-xs text-gray-500 break-all max-w-[220px] sm:text-right\">{storeLabel}</span>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {hasProfileGaps && (\r\n          <div className=\"bg-white border border-coral/30 rounded-2xl p-6 shadow-sm\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <div className=\"h-10 w-10 rounded-full bg-coral/10 flex items-center justify-center text-coral\">\r\n                <Sparkles className=\"w-5 h-5\" />\r\n              </div>\r\n              <div>\r\n                <h3 className=\"text-lg font-semibold text-gray-900\">Complete seu perfil</h3>\r\n                <p className=\"text-sm text-gray-600\">Preencha algumas etapas para destacar ainda mais a sua marca.</p>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"mt-5\">\r\n              <div className=\"h-2 rounded-full bg-gray-100 overflow-hidden\">\r\n                <div\r\n                  className=\"h-full bg-coral transition-all duration-500\"\r\n                  style={{ width: `${completionProgress}%` }}\r\n                />\r\n              </div>\r\n              <p className=\"text-xs text-gray-500 mt-2\">{completionProgress}% do perfil completo</p>\r\n            </div>\r\n\r\n            <ul className=\"mt-5 space-y-3\">\r\n              {completionItems.map(item => (\r\n                <li key={item.id} className=\"flex items-center gap-3\">\r\n                  {item.completed ? (\r\n                    <CheckCircle2 className=\"w-5 h-5 text-emerald-500\" />\r\n                  ) : (\r\n                    <Circle className=\"w-5 h-5 text-gray-300\" />\r\n                  )}\r\n                  <span className={`text-sm ${item.completed ? 'text-emerald-600 line-through' : 'text-gray-700'}`}>\r\n                    {item.label}\r\n                  </span>\r\n                </li>\r\n              ))}\r\n            </ul>\r\n\r\n            <div className=\"mt-6\">\r\n              <Button onClick={() => navigate('/editar-perfil')} variant=\"outline\" className=\"flex items-center gap-2\">\r\n                <Edit className=\"w-4 h-4\" />\r\n                Atualizar perfil agora\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n          <button \r\n            onClick={() => setShowFollowersModal(true)}\r\n            className=\"p-4 bg-white rounded-lg shadow-sm border hover:bg-gray-50 transition-colors text-left\"\r\n          >\r\n            <div className=\"text-sm text-gray-600\">Seguidores</div>\r\n            <div className=\"text-lg font-semibold\">{user.followers_count || 0}</div>\r\n          </button>\r\n          <button \r\n            onClick={() => setShowFollowingModal(true)}\r\n            className=\"p-4 bg-white rounded-lg shadow-sm border hover:bg-gray-50 transition-colors text-left\"\r\n          >\r\n            <div className=\"text-sm text-gray-600\">Seguindo</div>\r\n            <div className=\"text-lg font-semibold\">{user.following_count || 0}</div>\r\n          </button>\r\n          <div className=\"p-4 bg-white rounded-lg shadow-sm border\">\r\n            <div className=\"text-sm text-gray-600\">Publicações</div>\r\n            <div className=\"text-lg font-semibold\">{posts.length}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\r\n          <TabsList className=\"grid w-full grid-cols-4\">\r\n            <TabsTrigger value=\"posts\" className=\"flex items-center gap-2\">\r\n              <Edit className=\"h-4 w-4\" />\r\n              Posts\r\n            </TabsTrigger>\r\n            {isOwnProfile && (\r\n              <>\r\n                <TabsTrigger value=\"likes\" className=\"flex items-center gap-2\">\r\n                  <Heart className=\"h-4 w-4\" />\r\n                  Curtidas\r\n                </TabsTrigger>\r\n                <TabsTrigger value=\"saved\" className=\"flex items-center gap-2\">\r\n                  <Bookmark className=\"h-4 w-4\" />\r\n                  Salvos\r\n                </TabsTrigger>\r\n              </>\r\n            )}\r\n            <TabsTrigger value=\"connections\" className=\"flex items-center gap-2\">\r\n              <Users className=\"h-4 w-4\" />\r\n              Conexões\r\n            </TabsTrigger>\r\n          </TabsList>\r\n\r\n          <TabsContent value=\"posts\" className=\"space-y-4 mt-6\">\r\n            {posts.length > 0 ? (\r\n              posts.map(post => (\r\n                <SocialPost \r\n                  key={post.id} \r\n                  post={post} \r\n                  currentUser={currentUser}\r\n                  onLike={async (postId, liked, likesCount) => {\r\n                    try {\r\n                      // Atualizar contagem no post específico\r\n                      setPosts(prev => prev.map(p => \r\n                        p.id === postId \r\n                          ? { ...p, user_liked: liked, likes: likesCount, isLiked: liked }\r\n                          : p\r\n                      ));\r\n                    } catch (e) {\r\n                      console.error('Erro ao curtir:', e);\r\n                    }\r\n                  }}\r\n                  onFollow={async (userId, following, followersCount) => {\r\n                    // Atualizar contagem de seguidores no perfil se for o mesmo usuário\r\n                    if (user.id === userId) {\r\n                      setUser(prev => ({\r\n                        ...prev,\r\n                        followers_count: followersCount,\r\n                        isFollowed: following\r\n                      }));\r\n                    }\r\n                  }}\r\n                  onDelete={isOwnProfile ? async (postId) => {\r\n                    try {\r\n                      const res = await apiService.deletePost(postId);\r\n                      if (res.success) {\r\n                        setPosts(prev => prev.filter(p => p.id !== postId));\r\n                      }\r\n                    } catch (e) {\r\n                      console.error('Erro ao deletar:', e);\r\n                    }\r\n                  } : undefined}\r\n                  onUpdate={isOwnProfile ? (post) => {\r\n                    // Abrir modal de edição\r\n                    setEditingPost(post)\r\n                    setShowEditModal(true)\r\n                  } : undefined}\r\n                  showActions={true}\r\n                />\r\n              ))\r\n            ) : (\r\n              <EmptyState\r\n                title=\"Nenhum post ainda\"\r\n                description={isOwnProfile ? 'Você ainda não publicou nada.' : 'Este usuário não publicou nada.'}\r\n              />\r\n            )}\r\n          </TabsContent>\r\n\r\n          {isOwnProfile && (\r\n            <>\r\n              <TabsContent value=\"likes\" className=\"space-y-4 mt-6\">\r\n                {likedPosts.length > 0 ? (\r\n                  likedPosts.map(post => (\r\n                    <SocialPost \r\n                      key={post.id} \r\n                      post={post} \r\n                      currentUser={currentUser}\r\n                      onLike={async (postId, liked, likesCount) => {\r\n                        try {\r\n                          // Atualizar post na lista de curtidas\r\n                          setLikedPosts(prev => prev.map(p => \r\n                            p.id === postId \r\n                              ? { ...p, user_liked: liked, likes: likesCount, isLiked: liked }\r\n                              : p\r\n                          ));\r\n                          \r\n                          // Se descurtiu, remover da lista\r\n                          if (!liked) {\r\n                            setLikedPosts(prev => prev.filter(p => p.id !== postId));\r\n                          }\r\n                        } catch (e) {\r\n                          console.error('Erro ao curtir:', e);\r\n                        }\r\n                      }}\r\n                      showActions={true}\r\n                    />\r\n                  ))\r\n                ) : (\r\n                  <EmptyState\r\n                    title=\"Nenhuma curtida ainda\"\r\n                    description=\"Posts que você curtir aparecerão aqui.\"\r\n                  />\r\n                )}\r\n              </TabsContent>\r\n\r\n              <TabsContent value=\"saved\" className=\"space-y-4 mt-6\">\r\n                {savedPosts.length > 0 ? (\r\n                  savedPosts.map(post => (\r\n                    <SocialPost \r\n                      key={post.id} \r\n                      post={post} \r\n                      currentUser={currentUser}\r\n                      onSave={async (postId, saved) => {\r\n                        // Remover da lista se dessalvou\r\n                        if (!saved) {\r\n                          setSavedPosts(prev => prev.filter(p => p.id !== postId));\r\n                        }\r\n                      }}\r\n                      showActions={true}\r\n                    />\r\n                  ))\r\n                ) : (\r\n                  <EmptyState\r\n                    title=\"Nenhum post salvo\"\r\n                    description=\"Posts que você salvar aparecerão aqui.\"\r\n                  />\r\n                )}\r\n              </TabsContent>\r\n            </>\r\n          )}\r\n\r\n          <TabsContent value=\"connections\" className=\"space-y-4 mt-6\">\r\n            <div className=\"grid md:grid-cols-2 gap-6\">\r\n              <div>\r\n                <h3 className=\"font-semibold mb-4\">Seguidores ({user.followers_count || 0})</h3>\r\n                <div className=\"space-y-3\">\r\n                  {followers.length > 0 ? (\r\n                    followers.slice(0, 5).map(follower => (\r\n                      <Link \r\n                        key={follower.id} \r\n                        to={`/perfil/${follower.username}`}\r\n                        className=\"flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer\"\r\n                      >\r\n                        <Avatar className=\"w-10 h-10\">\r\n                          <AvatarImage src={follower.avatar_url ? config.getPublicUrl(follower.avatar_url) : follower.foto_perfil ? config.getPublicUrl(follower.foto_perfil) : ''} />\r\n                          <AvatarFallback className=\"bg-coral text-white\">\r\n                            {follower.nome ? follower.nome.charAt(0) : '?'}\r\n                          </AvatarFallback>\r\n                        </Avatar>\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <p className=\"font-medium hover:underline truncate\">{follower.nome}</p>\r\n                          <p className=\"text-sm text-gray-500 hover:text-coral truncate\">@{follower.username}</p>\r\n                        </div>\r\n                      </Link>\r\n                    ))\r\n                  ) : (\r\n                    <p className=\"text-gray-500 text-sm\">Nenhum seguidor ainda.</p>\r\n                  )}\r\n                </div>\r\n              </div>\r\n              \r\n              <div>\r\n                <h3 className=\"font-semibold mb-4\">Seguindo ({user.following_count || 0})</h3>\r\n                <div className=\"space-y-3\">\r\n                  {following.length > 0 ? (\r\n                    following.slice(0, 5).map(followed => (\r\n                      <Link \r\n                        key={followed.id} \r\n                        to={`/perfil/${followed.username}`}\r\n                        className=\"flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer\"\r\n                      >\r\n                        <Avatar className=\"w-10 h-10\">\r\n                          <AvatarImage src={followed.avatar_url ? config.getPublicUrl(followed.avatar_url) : followed.foto_perfil ? config.getPublicUrl(followed.foto_perfil) : ''} />\r\n                          <AvatarFallback className=\"bg-coral text-white\">\r\n                            {followed.nome ? followed.nome.charAt(0) : '?'}\r\n                          </AvatarFallback>\r\n                        </Avatar>\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <p className=\"font-medium hover:underline truncate\">{followed.nome}</p>\r\n                          <p className=\"text-sm text-gray-500 hover:text-coral truncate\">@{followed.username}</p>\r\n                        </div>\r\n                      </Link>\r\n                    ))\r\n                  ) : (\r\n                    <p className=\"text-gray-500 text-sm\">Não está seguindo ninguém ainda.</p>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </TabsContent>\r\n        </Tabs>\r\n      </div>\r\n\r\n      {/* Modal de Seguidores */}\r\n      <Dialog open={showFollowersModal} onOpenChange={setShowFollowersModal}>\r\n        <DialogContent className=\"max-w-md max-h-96 overflow-y-auto\">\r\n          <DialogHeader>\r\n            <DialogTitle>Seguidores ({user.followers_count || 0})</DialogTitle>\r\n            <DialogDescription>\r\n              Lista de pessoas que seguem este usuário.\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          <div className=\"space-y-3\">\r\n            {loadingFollowers ? (\r\n              <p className=\"text-gray-500 text-center py-4\">Carregando seguidores...</p>\r\n            ) : followers.length > 0 ? (\r\n              followers.map(follower => (\r\n                <div key={follower.id} className=\"flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg\">\r\n                  <Avatar className=\"h-10 w-10\">\r\n                    <AvatarImage src={follower.avatar_url ? config.getPublicUrl(follower.avatar_url) : ''} />\r\n                    <AvatarFallback>\r\n                      {follower.nome ? follower.nome.charAt(0) : '?'}\r\n                    </AvatarFallback>\r\n                  </Avatar>\r\n                  <div className=\"flex-1\">\r\n                    <p className=\"font-medium\">{follower.nome}</p>\r\n                    <p className=\"text-sm text-gray-500\">@{follower.username}</p>\r\n                  </div>\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={() => navigate(`/perfil/${follower.username}`)}\r\n                  >\r\n                    Ver perfil\r\n                  </Button>\r\n                </div>\r\n              ))\r\n            ) : (\r\n              <p className=\"text-gray-500 text-center py-4\">Nenhum seguidor ainda.</p>\r\n            )}\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Modal de Seguindo */}\r\n      <Dialog open={showFollowingModal} onOpenChange={setShowFollowingModal}>\r\n        <DialogContent className=\"max-w-md max-h-96 overflow-y-auto\">\r\n          <DialogHeader>\r\n            <DialogTitle>Seguindo ({user.following_count || 0})</DialogTitle>\r\n            <DialogDescription>\r\n              Lista de pessoas que este usuário segue.\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          <div className=\"space-y-3\">\r\n            {loadingFollowing ? (\r\n              <p className=\"text-gray-500 text-center py-4\">Carregando seguindo...</p>\r\n            ) : following.length > 0 ? (\r\n              following.map(followed => (\r\n                <div key={followed.id} className=\"flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg\">\r\n                  <Avatar className=\"h-10 w-10\">\r\n                    <AvatarImage src={followed.avatar_url ? config.getPublicUrl(followed.avatar_url) : ''} />\r\n                    <AvatarFallback>\r\n                      {followed.nome ? followed.nome.charAt(0) : '?'}\r\n                    </AvatarFallback>\r\n                  </Avatar>\r\n                  <div className=\"flex-1\">\r\n                    <p className=\"font-medium\">{followed.nome}</p>\r\n                    <p className=\"text-sm text-gray-500\">@{followed.username}</p>\r\n                  </div>\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={() => navigate(`/perfil/${followed.username}`)}\r\n                  >\r\n                    Ver perfil\r\n                  </Button>\r\n                </div>\r\n              ))\r\n            ) : (\r\n              <p className=\"text-gray-500 text-center py-4\">Não está seguindo ninguém ainda.</p>\r\n            )}\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Modal de Edição de Post */}\r\n      <EditPostModal\r\n        isOpen={showEditModal}\r\n        onClose={() => {\r\n          setShowEditModal(false)\r\n          setEditingPost(null)\r\n        }}\r\n        post={editingPost}\r\n        onSave={handleSaveEditPost}\r\n      />\r\n    </ProfileLayout>\r\n  );\r\n};\r\n\r\nexport default ProfilePage;"],"names":["ProfilePage","username","useParams","navigate","useNavigate","currentUser","updateCover","useAuth","user","setUser","useState","posts","setPosts","likedPosts","setLikedPosts","savedPosts","setSavedPosts","followers","setFollowers","following","setFollowing","loading","setLoading","error","setError","activeTab","setActiveTab","editingPost","setEditingPost","showEditModal","setShowEditModal","showFollowersModal","setShowFollowersModal","showFollowingModal","setShowFollowingModal","isLoadingFollow","setIsLoadingFollow","loadingFollowers","setLoadingFollowers","loadingFollowing","setLoadingFollowing","isCoverUploading","setIsCoverUploading","addToast","useToast","isOwnProfile","toAbsoluteUrl","useCallback","value","config","normalizeProfileUser","rawUser","normalized","avatarPath","coverPath","useEffect","loadLikedPosts","response","apiService","e","loadSavedPosts","loadFollowers","userId","followersList","prev","loadFollowing","followingList","profile","searchData","found","u","normalizedProfile","postsData","handleSaveEditPost","postId","updatedData","res","p","handleToggleFollow","handleCoverUpload","file","utils","sizeInMb","result","storeUrl","useMemo","trimmed","storeLabel","url","hostname","path","storeHighlightName","completionItems","hasAvatar","hasCover","hasBio","hasWebsite","hasLocation","completionProgress","completed","item","hasProfileGaps","jsx","ProfileLayout","Loading","ErrorMessage","profileInfoActions","jsxs","Button","Edit","ShoppingBag","ArrowUpRight","Sparkles","CheckCircle2","Circle","Tabs","TabsList","TabsTrigger","Fragment","Heart","Bookmark","Users","TabsContent","post","SocialPost","liked","likesCount","followersCount","EmptyState","saved","follower","Link","Avatar","AvatarImage","AvatarFallback","followed","Dialog","DialogContent","DialogHeader","DialogTitle","DialogDescription","EditPostModal"],"mappings":"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"}