{"version":3,"file":"SavedPostsPage-D46Ka6nm.js","sources":["../../src/pages/SavedPostsPage.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { PageLayout } from '../components/layout';\r\nimport { Loading, ErrorMessage, EmptyState } from '../components/common';\r\nimport SocialPost from '../components/SocialPost';\r\nimport EditPostModal from '../components/EditPostModal';\r\nimport { Button } from '../components/ui/button';\r\nimport { useToast } from '../components/ui/toast';\r\nimport { Bookmark, ArrowLeft, Trash2 } from 'lucide-react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport apiService from '../services/api';\r\n\r\n/**\r\n * Página de posts salvos\r\n */\r\nconst SavedPostsPage = () => {\r\n  const navigate = useNavigate();\r\n  const { user } = useAuth();\r\n  const [posts, setPosts] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n  const [selectedPosts, setSelectedPosts] = useState([]);\r\n  const [selectionMode, setSelectionMode] = useState(false);\r\n  const [editingPost, setEditingPost] = useState(null);\r\n  const [showEditModal, setShowEditModal] = useState(false);\r\n\r\n  const { addToast } = useToast();\r\n\r\n  // Debug log para verificar se a página está sendo acessada\r\n  useEffect(() => {\r\n    console.log('SavedPostsPage mounted');\r\n    console.log('User:', user);\r\n    console.log('User authenticated:', !!user);\r\n  }, [user]);\r\n\r\n  useEffect(() => {\r\n    loadSavedPosts();\r\n  }, []);\r\n\r\n  const loadSavedPosts = async () => {\r\n    try {\r\n      console.log('Loading saved posts...');\r\n      setLoading(true);\r\n      setError('');\r\n      const response = await apiService.getSavedPosts();\r\n      console.log('API Response:', response);\r\n      \r\n      if (response.success) {\r\n        console.log('Posts loaded successfully:', response.posts);\r\n        setPosts(response.posts || []);\r\n      } else {\r\n        console.error('API error:', response.message);\r\n        setError('Erro ao carregar posts salvos');\r\n      }\r\n    } catch (err) {\r\n      console.error('Catch error:', err);\r\n      setError('Erro ao carregar posts salvos');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleUnsavePost = async (postId) => {\r\n    try {\r\n      const response = await apiService.toggleSavePost(postId);\r\n      if (response.success) {\r\n        setPosts(prev => prev.filter(post => post.id !== postId));\r\n      }\r\n    } catch (err) {\r\n      console.error('Erro ao remover post salvo:', err);\r\n    }\r\n  };\r\n\r\n  const handleSelectPost = (postId) => {\r\n    setSelectedPosts(prev => \r\n      prev.includes(postId) \r\n        ? prev.filter(id => id !== postId)\r\n        : [...prev, postId]\r\n    );\r\n  };\r\n\r\n  const handleUpdatePost = (post) => {\r\n    // Abrir modal de edição\r\n    setEditingPost(post)\r\n    setShowEditModal(true)\r\n  };\r\n\r\n  const handleSaveEditPost = async (postId, updatedData) => {\r\n    try {\r\n      const res = await apiService.updatePost(postId, updatedData);\r\n      if (res.success) {\r\n        setPosts(prev => prev.map(p => \r\n          p.id === postId \r\n            ? { ...p, ...res.post }\r\n            : p\r\n        ));\r\n        addToast('Post atualizado com sucesso!', 'success')\r\n      } else {\r\n        throw new Error(res.message || 'Erro ao atualizar post')\r\n      }\r\n    } catch (error) {\r\n      console.error('Erro ao atualizar post:', error)\r\n      addToast('Erro ao atualizar post. Tente novamente.', 'error')\r\n      throw error\r\n    }\r\n  };\r\n\r\n  const handleBulkRemove = async () => {\r\n    try {\r\n      const promises = selectedPosts.map(postId => apiService.toggleSavePost(postId));\r\n      await Promise.all(promises);\r\n      setPosts(prev => prev.filter(post => !selectedPosts.includes(post.id)));\r\n      setSelectedPosts([]);\r\n      setSelectionMode(false);\r\n    } catch (err) {\r\n      console.error('Erro ao remover posts:', err);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <PageLayout>\r\n        <Loading size=\"lg\" text=\"Carregando posts salvos...\" />\r\n      </PageLayout>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <PageLayout>\r\n        <ErrorMessage message={error} />\r\n      </PageLayout>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <PageLayout\r\n      title=\"Posts Salvos\"\r\n      subtitle=\"Seus posts salvos para visualizar mais tarde\"\r\n      breadcrumbs={[\r\n        { label: 'Comunidade', href: '/comunidade' },\r\n        { label: 'Posts Salvos' }\r\n      ]}\r\n      actions={[\r\n        <Button\r\n          key=\"back\"\r\n          variant=\"outline\"\r\n          onClick={() => navigate('/comunidade')}\r\n          className=\"flex items-center\"\r\n        >\r\n          <ArrowLeft className=\"w-4 h-4 mr-2\" />\r\n          Voltar\r\n        </Button>,\r\n        posts.length > 0 && (\r\n          <Button\r\n            key=\"select\"\r\n            variant={selectionMode ? \"destructive\" : \"outline\"}\r\n            onClick={() => {\r\n              if (selectionMode && selectedPosts.length > 0) {\r\n                handleBulkRemove();\r\n              } else {\r\n                setSelectionMode(!selectionMode);\r\n                setSelectedPosts([]);\r\n              }\r\n            }}\r\n            className=\"flex items-center\"\r\n          >\r\n            {selectionMode ? (\r\n              <>\r\n                <Trash2 className=\"w-4 h-4 mr-2\" />\r\n                Remover Selecionados ({selectedPosts.length})\r\n              </>\r\n            ) : (\r\n              <>\r\n                <Bookmark className=\"w-4 h-4 mr-2\" />\r\n                Gerenciar\r\n              </>\r\n            )}\r\n          </Button>\r\n        )\r\n      ].filter(Boolean)}\r\n    >\r\n      <div className=\"max-w-4xl mx-auto space-y-6\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-4 bg-white rounded-lg shadow-sm border\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <Bookmark className=\"w-5 h-5 text-blue-600\" />\r\n            <h1 className=\"text-xl font-semibold\">Posts Salvos</h1>\r\n          </div>\r\n          <div className=\"text-sm text-gray-500\">\r\n            {posts.length} {posts.length === 1 ? 'post salvo' : 'posts salvos'}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Posts salvos */}\r\n        <div className=\"space-y-4\">\r\n          {posts.length > 0 ? (\r\n            posts.map(post => (\r\n              <div\r\n                key={post.id}\r\n                className={`relative ${selectionMode ? 'cursor-pointer' : ''}`}\r\n                onClick={selectionMode ? () => handleSelectPost(post.id) : undefined}\r\n              >\r\n                {selectionMode && (\r\n                  <div className=\"absolute top-2 left-2 z-10\">\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={selectedPosts.includes(post.id)}\r\n                      onChange={() => handleSelectPost(post.id)}\r\n                      className=\"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500\"\r\n                    />\r\n                  </div>\r\n                )}\r\n                \r\n                <SocialPost\r\n                  post={post}\r\n                  currentUser={user}\r\n                  onLike={async (postId) => {\r\n                    try {\r\n                      const res = await apiService.toggleLike(postId);\r\n                      if (res.success) {\r\n                        setPosts(prev => prev.map(p => \r\n                          p.id === postId \r\n                            ? { ...p, user_liked: res.liked, likes_count: res.likesCount }\r\n                            : p\r\n                        ));\r\n                      }\r\n                    } catch (e) {\r\n                      console.error('Erro ao curtir:', e);\r\n                    }\r\n                  }}\r\n                  onSave={() => handleUnsavePost(post.id)}\r\n                  onUpdate={user && user.id === post.user_id ? handleUpdatePost : undefined}\r\n                  showActions={true}\r\n                  showSaveButton={true}\r\n                  isSaved={true}\r\n                />\r\n              </div>\r\n            ))\r\n          ) : (\r\n            <EmptyState\r\n              icon={<Bookmark className=\"w-12 h-12 text-gray-400\" />}\r\n              title=\"Nenhum post salvo\"\r\n              description=\"Você ainda não salvou nenhum post. Quando salvar posts, eles aparecerão aqui.\"\r\n              action={\r\n                <Button\r\n                  onClick={() => navigate('/comunidade')}\r\n                  className=\"mt-4\"\r\n                >\r\n                  Explorar Posts\r\n                </Button>\r\n              }\r\n            />\r\n          )}\r\n        </div>\r\n\r\n        {selectionMode && (\r\n          <div className=\"fixed bottom-4 right-4 p-4 bg-white rounded-lg shadow-lg border\">\r\n            <div className=\"flex items-center space-x-2\">\r\n              <span className=\"text-sm text-gray-600\">\r\n                {selectedPosts.length} selecionados\r\n              </span>\r\n              <Button\r\n                size=\"sm\"\r\n                variant=\"outline\"\r\n                onClick={() => {\r\n                  setSelectionMode(false);\r\n                  setSelectedPosts([]);\r\n                }}\r\n              >\r\n                Cancelar\r\n              </Button>\r\n              {selectedPosts.length > 0 && (\r\n                <Button\r\n                  size=\"sm\"\r\n                  variant=\"destructive\"\r\n                  onClick={handleBulkRemove}\r\n                >\r\n                  Remover\r\n                </Button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Modal de Edição de Post */}\r\n      <EditPostModal\r\n        isOpen={showEditModal}\r\n        onClose={() => {\r\n          setShowEditModal(false)\r\n          setEditingPost(null)\r\n        }}\r\n        post={editingPost}\r\n        onSave={handleSaveEditPost}\r\n      />\r\n    </PageLayout>\r\n  );\r\n};\r\n\r\nexport default SavedPostsPage;\r\n"],"names":["SavedPostsPage","navigate","useNavigate","user","useAuth","posts","setPosts","useState","loading","setLoading","error","setError","selectedPosts","setSelectedPosts","selectionMode","setSelectionMode","editingPost","setEditingPost","showEditModal","setShowEditModal","addToast","useToast","useEffect","loadSavedPosts","response","apiService","err","handleUnsavePost","postId","prev","post","handleSelectPost","id","handleUpdatePost","handleSaveEditPost","updatedData","res","p","handleBulkRemove","promises","jsx","PageLayout","Loading","ErrorMessage","jsxs","Button","ArrowLeft","Fragment","Trash2","Bookmark","SocialPost","e","EmptyState","EditPostModal"],"mappings":"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"}