import{a as U,u as R,r as a,m as u,j as s,p as T,E as _,x as F,B as h}from"./index-DLqimMV8.js";import{a as v}from"./index-iG6a_0Cv.js";import{S as V,E as q}from"./EditPostModal-FMrAoioO.js";import{u as G}from"./toast-7vBxPuBc.js";import{b as f}from"./bookmark-B2_N_nt6.js";import{A as O}from"./arrow-left-BeWKRKPu.js";import{T as Q}from"./trash-2-CP23ljvT.js";import"./site-header-CKtPnSCF.js";import"./card-CY9-ve7w.js";import"./badge-CME7s750.js";import"./index-EfjSmcDM.js";import"./dropdown-menu-7k7ytBg1.js";import"./index-BgaOpAAA.js";import"./heart-D1UYKJAB.js";import"./calendar-BcaNxl4E.js";import"./user-BOjY7V17.js";import"./log-out-Cu_b7vs0.js";import"./site-footer-btaBgloE.js";import"./input-FZRWGTRd.js";import"./loader-circle-ClwSyFO1.js";import"./crown-BrBsF1Iu.js";import"./map-pin-XNZDTA2K.js";import"./textarea-Dc95vB93.js";import"./send-COm1LQ5b.js";import"./square-pen-CjVE55qt.js";import"./label-DBxNtR5w.js";import"./select-d49l-vTK.js";import"./index-CFq4vo7_.js";import"./chevron-up-DKadsFnq.js";import"./circle-alert-Bp1UBQ88.js";const Ss=()=>{const j=U(),{user:n}=R(),[c,d]=a.useState([]),[k,S]=a.useState(!0),[P,x]=a.useState(""),[i,p]=a.useState([]),[r,g]=a.useState(!1),[C,w]=a.useState(null),[z,E]=a.useState(!1),{addToast:y}=G();a.useEffect(()=>{console.log("SavedPostsPage mounted"),console.log("User:",n),console.log("User authenticated:",!!n)},[n]),a.useEffect(()=>{L()},[]);const L=async()=>{try{console.log("Loading saved posts..."),S(!0),x("");const e=await u.getSavedPosts();console.log("API Response:",e),e.success?(console.log("Posts loaded successfully:",e.posts),d(e.posts||[])):(console.error("API error:",e.message),x("Erro ao carregar posts salvos"))}catch(e){console.error("Catch error:",e),x("Erro ao carregar posts salvos")}finally{S(!1)}},A=async e=>{try{(await u.toggleSavePost(e)).success&&d(o=>o.filter(m=>m.id!==e))}catch(t){console.error("Erro ao remover post salvo:",t)}},N=e=>{p(t=>t.includes(e)?t.filter(o=>o!==e):[...t,e])},B=e=>{w(e),E(!0)},M=async(e,t)=>{try{const o=await u.updatePost(e,t);if(o.success)d(m=>m.map(l=>l.id===e?{...l,...o.post}:l)),y("Post atualizado com sucesso!","success");else throw new Error(o.message||"Erro ao atualizar post")}catch(o){throw console.error("Erro ao atualizar post:",o),y("Erro ao atualizar post. Tente novamente.","error"),o}},b=async()=>{try{const e=i.map(t=>u.toggleSavePost(t));await Promise.all(e),d(t=>t.filter(o=>!i.includes(o.id))),p([]),g(!1)}catch(e){console.error("Erro ao remover posts:",e)}};return k?s.jsx(v,{children:s.jsx(T,{size:"lg",text:"Carregando posts salvos..."})}):P?s.jsx(v,{children:s.jsx(_,{message:P})}):s.jsxs(v,{title:"Posts Salvos",subtitle:"Seus posts salvos para visualizar mais tarde",breadcrumbs:[{label:"Comunidade",href:"/comunidade"},{label:"Posts Salvos"}],actions:[s.jsxs(h,{variant:"outline",onClick:()=>j("/comunidade"),className:"flex items-center",children:[s.jsx(O,{className:"w-4 h-4 mr-2"}),"Voltar"]},"back"),c.length>0&&s.jsx(h,{variant:r?"destructive":"outline",onClick:()=>{r&&i.length>0?b():(g(!r),p([]))},className:"flex items-center",children:r?s.jsxs(s.Fragment,{children:[s.jsx(Q,{className:"w-4 h-4 mr-2"}),"Remover Selecionados (",i.length,")"]}):s.jsxs(s.Fragment,{children:[s.jsx(f,{className:"w-4 h-4 mr-2"}),"Gerenciar"]})},"select")].filter(Boolean),children:[s.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 bg-white rounded-lg shadow-sm border",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(f,{className:"w-5 h-5 text-blue-600"}),s.jsx("h1",{className:"text-xl font-semibold",children:"Posts Salvos"})]}),s.jsxs("div",{className:"text-sm text-gray-500",children:[c.length," ",c.length===1?"post salvo":"posts salvos"]})]}),s.jsx("div",{className:"space-y-4",children:c.length>0?c.map(e=>s.jsxs("div",{className:`relative ${r?"cursor-pointer":""}`,onClick:r?()=>N(e.id):void 0,children:[r&&s.jsx("div",{className:"absolute top-2 left-2 z-10",children:s.jsx("input",{type:"checkbox",checked:i.includes(e.id),onChange:()=>N(e.id),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"})}),s.jsx(V,{post:e,currentUser:n,onLike:async t=>{try{const o=await u.toggleLike(t);o.success&&d(m=>m.map(l=>l.id===t?{...l,user_liked:o.liked,likes_count:o.likesCount}:l))}catch(o){console.error("Erro ao curtir:",o)}},onSave:()=>A(e.id),onUpdate:n&&n.id===e.user_id?B:void 0,showActions:!0,showSaveButton:!0,isSaved:!0})]},e.id)):s.jsx(F,{icon:s.jsx(f,{className:"w-12 h-12 text-gray-400"}),title:"Nenhum post salvo",description:"Você ainda não salvou nenhum post. Quando salvar posts, eles aparecerão aqui.",action:s.jsx(h,{onClick:()=>j("/comunidade"),className:"mt-4",children:"Explorar Posts"})})}),r&&s.jsx("div",{className:"fixed bottom-4 right-4 p-4 bg-white rounded-lg shadow-lg border",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[i.length," selecionados"]}),s.jsx(h,{size:"sm",variant:"outline",onClick:()=>{g(!1),p([])},children:"Cancelar"}),i.length>0&&s.jsx(h,{size:"sm",variant:"destructive",onClick:b,children:"Remover"})]})})]}),s.jsx(q,{isOpen:z,onClose:()=>{E(!1),w(null)},post:C,onSave:M})]})};export{Ss as default};
//# sourceMappingURL=SavedPostsPage-D46Ka6nm.js.map
