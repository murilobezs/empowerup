import{r as i,j as e,D as de,J as ue,B as x,i as xe,K as pe,q as ge,s as he,t as fe,v as je,u as ve,a as Z,m as A,A as Ne,L as be,n as we,l as ye}from"./index-DLqimMV8.js";import{C as I,a as B}from"./card-CY9-ve7w.js";import{U as L,A as ee,a as se,b as ae}from"./index-EfjSmcDM.js";import{B as g}from"./badge-CME7s750.js";import{I as R}from"./input-FZRWGTRd.js";import{S as Ce,a as Se,b as Ge,c as Ae,d as ke}from"./select-d49l-vTK.js";import{S as N}from"./skeleton-DqM98hae.js";import{D as Te,b as Pe,c as Le,d as Y}from"./dropdown-menu-7k7ytBg1.js";import{T as Me}from"./textarea-Dc95vB93.js";import{L as _}from"./label-DBxNtR5w.js";import{u as Ee}from"./toast-7vBxPuBc.js";import{C as De}from"./CommunityLeftSidebar-CgYDUEfw.js";import{C as q}from"./crown-BrBsF1Iu.js";import{A as Fe}from"./arrow-left-BeWKRKPu.js";import{F as _e}from"./funnel-BHegw_va.js";import{T as re}from"./tag-6iqodST4.js";import{S as qe}from"./shield-Dd8xFKSO.js";import{L as te}from"./loader-circle-ClwSyFO1.js";import{L as oe}from"./lock-D_uok8iM.js";import{G as ie}from"./globe-AW3VTD_N.js";import{C as ze}from"./clock-BtJpcJw2.js";import{A as Re}from"./arrow-right-9NKBOYty.js";import"./index-CFq4vo7_.js";import"./chevron-up-DKadsFnq.js";import"./circle-alert-Bp1UBQ88.js";import"./calendar-BcaNxl4E.js";import"./trending-up-D6ou80w9.js";import"./bookmark-B2_N_nt6.js";import"./rocket-oRE_XYSN.js";import"./mail-D_LXhG2r.js";import"./user-BOjY7V17.js";function Ie({onCreateGroup:s,triggerButtonProps:o={}}){const[n,l]=i.useState(!1),[c,d]=i.useState({nome:"",descricao:"",categoria:"",imagem:"/placeholder.svg?height=100&width=100",membros:0,ativo:!0}),[p,h]=i.useState(!1),u=async m=>{if(m.preventDefault(),!p){h(!0);try{if((await s(c))?.success===!1)return;l(!1),d({nome:"",descricao:"",categoria:"",imagem:"/placeholder.svg?height=100&width=100",membros:0,ativo:!0})}finally{h(!1)}}},{className:y,children:f,...C}=o;return e.jsxs(de,{open:n,onOpenChange:l,children:[e.jsx(ue,{asChild:!0,children:e.jsx(x,{className:xe("bg-coral hover:bg-coral/90",y),...C,children:f??e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"mr-2 h-4 w-4"}),"Criar Grupo"]})})}),e.jsxs(ge,{className:"sm:max-w-[425px]",children:[e.jsxs(he,{children:[e.jsx(fe,{children:"Criar Novo Grupo"}),e.jsx(je,{children:"Crie um novo grupo para conectar empreendedoras com interesses em comum."})]}),e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"nome",children:"Nome do Grupo"}),e.jsx(R,{id:"nome",required:!0,value:c.nome,onChange:m=>d({...c,nome:m.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"descricao",children:"Descri√ß√£o"}),e.jsx(Me,{id:"descricao",required:!0,value:c.descricao,onChange:m=>d({...c,descricao:m.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"categoria",children:"Categoria"}),e.jsx(R,{id:"categoria",required:!0,value:c.categoria,onChange:m=>d({...c,categoria:m.target.value})})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(x,{type:"button",variant:"outline",onClick:()=>l(!1),children:"Cancelar"}),e.jsx(x,{type:"submit",className:"bg-coral hover:bg-coral/90",disabled:p,children:p?"Criando...":"Criar Grupo"})]})]})]})]})}function Be({user:s,logout:o}){const n=Z();return e.jsx("header",{className:"sticky top-0 z-50 w-full border-b border-gray-200 bg-white/80 backdrop-blur-md",children:e.jsxs("div",{className:"container flex h-16 items-center justify-between px-6",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx(be,{to:"/",className:"flex items-center hover:opacity-80 transition-opacity",children:e.jsx("img",{src:"/logo-sem-fundo.png",alt:"EmpowerUp",className:"h-8 w-auto"})}),e.jsxs("div",{className:"flex items-center gap-2 text-xl font-bold text-gray-900",children:[e.jsx(L,{className:"w-6 h-6 text-coral"}),"Grupos"]})]}),e.jsxs(Te,{children:[e.jsxs(Pe,{className:"flex items-center gap-3 p-2 rounded-full hover:bg-gray-100 transition-colors",children:[e.jsxs(ee,{className:"w-8 h-8",children:[e.jsx(se,{src:s?.avatar_url?we.getPublicUrl(s.avatar_url):""}),e.jsx(ae,{className:"bg-coral text-white text-sm font-medium",children:s?.nome?.charAt(0)})]}),e.jsx("span",{className:"font-medium text-gray-900 hidden sm:block",children:s?.nome})]}),e.jsxs(Le,{align:"end",className:"w-56 mt-2",children:[e.jsx(Y,{onClick:()=>n("/perfil"),className:"cursor-pointer",children:"Meu Perfil"}),e.jsx(Y,{onClick:()=>{o(),n("/")},className:"cursor-pointer text-red-600",children:"Sair"})]})]})]})})}const Oe=[{value:"todos",label:"Todos os grupos"},{value:"joined",label:"Onde participo"},{value:"managed",label:"Eu modero"},{value:"discover",label:"Descobrir"}],P=["bg-olive/10 text-olive","bg-coral/10 text-coral","bg-blue-100 text-blue-700","bg-amber-100 text-amber-700","bg-purple-100 text-purple-700","bg-rose-100 text-rose-700"];function $e(s){if(!s)return null;const o=new Date(s);return Number.isNaN(o.getTime())?null:o.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"})}function O(s){if(!s)return[];if(Array.isArray(s))return s;if(typeof s=="string"){try{const o=JSON.parse(s);if(Array.isArray(o))return o}catch{}return s.split(",").map(o=>o.trim()).filter(Boolean)}return[]}function Ue(s=""){if(!s)return"?";const o=s.trim().split(/\s+/);return o.length===1?o[0].slice(0,2).toUpperCase():`${o[0][0]}${o[o.length-1][0]}`.toUpperCase()}function z(){return e.jsx(I,{className:"border-dashed",children:e.jsxs(B,{className:"space-y-4 p-6",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(N,{className:"h-14 w-14 rounded-full"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(N,{className:"h-4 w-2/3"}),e.jsx(N,{className:"h-3 w-1/3"}),e.jsx(N,{className:"h-3 w-24"})]})]}),e.jsx(N,{className:"h-3 w-full"}),e.jsx(N,{className:"h-3 w-4/5"}),e.jsx(N,{className:"h-9 w-full rounded-full"})]})})}function Ve({group:s,onJoin:o,isJoining:n,onNavigate:l}){if(!s)return null;const c=s.privacidade&&s.privacidade!=="publico",d=O(s.tags).slice(0,3),p=s?.membership?.status,h=s?.membership?.role,u=p==="ativo",y=p==="pendente",f=$e(s.ultima_atividade),C=h==="owner"?"Voc√™ criou":h==="moderador"?"Voc√™ modera":"Voc√™ participa";return e.jsx(I,{className:"h-full border border-gray-100 shadow-sm transition-all hover:shadow-md",children:e.jsxs(B,{className:"flex h-full flex-col gap-5 p-6",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs(ee,{className:"h-14 w-14",children:[e.jsx(se,{src:s.imagem||void 0,alt:s.nome}),e.jsx(ae,{className:"bg-olive/10 text-olive font-semibold",children:Ue(s.nome)})]}),e.jsxs("div",{className:"min-w-0 flex-1 space-y-1.5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"truncate text-lg font-semibold text-gray-900",title:s.nome,children:s.nome}),c?e.jsx(oe,{className:"h-4 w-4 text-gray-400"}):e.jsx(ie,{className:"h-4 w-4 text-gray-400"})]}),s.categoria&&e.jsx(g,{variant:"secondary",className:"bg-olive/10 text-olive",children:s.categoria}),u&&e.jsxs(g,{variant:"secondary",className:"bg-emerald-100 text-emerald-700",children:[e.jsx(ye,{className:"mr-1.5 h-3.5 w-3.5"}),C]}),y&&e.jsxs(g,{variant:"outline",className:"border-amber-200 text-amber-700",children:[e.jsx(ze,{className:"mr-1.5 h-3.5 w-3.5"}),"Solicita√ß√£o pendente"]})]})]}),e.jsx("p",{className:"line-clamp-3 flex-1 text-sm text-gray-600",children:s.descricao||"Comunidade exclusiva para empreendedoras compartilharem aprendizados e oportunidades."}),e.jsx("div",{className:"flex flex-wrap gap-2",children:d.map((m,k)=>e.jsxs(g,{variant:"outline",className:`${P[k%P.length]} border-none`,children:[e.jsx(re,{className:"mr-1.5 h-3 w-3"}),m]},m))}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(L,{className:"h-3.5 w-3.5"}),s.membros||0," integrantes"]}),f&&e.jsxs("span",{children:["Ativo em ",f]})]}),e.jsxs("div",{className:"flex gap-2 border-t pt-4",children:[u?e.jsx(x,{size:"sm",variant:"secondary",className:"flex-1",onClick:()=>l(s),children:"Acessar grupo"}):e.jsx(x,{size:"sm",className:"flex-1",onClick:()=>o(s),disabled:n,children:n?e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"mr-2 h-4 w-4 animate-spin"}),"Entrando..."]}):"Entrar no grupo"}),e.jsx(x,{variant:"outline",size:"sm",onClick:()=>l(s),children:e.jsx(Re,{className:"h-4 w-4"})})]})]})})}function Je({group:s,pendingCount:o=0,onNavigate:n}){const l=O(s.tags).slice(0,2),c=s.privacidade&&s.privacidade!=="publico";return e.jsx(I,{className:"border border-olive/20 bg-olive/5 shadow-sm",children:e.jsxs(B,{className:"space-y-4 p-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900",children:s.nome}),c?e.jsx(oe,{className:"h-4 w-4 text-gray-400"}):e.jsx(ie,{className:"h-4 w-4 text-gray-400"})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:s.descricao?s.descricao.slice(0,100):"Mantenha a comunidade ativa aprovando novas participantes e atualizando os conte√∫dos."})]}),o>0&&e.jsxs(g,{className:"bg-amber-100 text-amber-700",children:[o," pendente",o>1?"s":""]})]}),l.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 text-xs text-gray-500",children:l.map(d=>e.jsxs(g,{variant:"outline",children:["#",d]},d))}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(L,{className:"h-3.5 w-3.5"}),s.membros||0," integrantes"]}),e.jsx(x,{size:"sm",variant:"secondary",onClick:()=>n(s),children:"Gerenciar"})]})]})})}function Cs(){const{user:s,logout:o}=ve(),{addToast:n}=Ee(),l=Z(),[c,d]=i.useState([]),[p,h]=i.useState(!0),[u,y]=i.useState("todos"),[f,C]=i.useState(""),[m,k]=i.useState(""),[M,$]=i.useState(null),[U,V]=i.useState(!1),[E,S]=i.useState([]),[D,J]=i.useState(!1),[le,b]=i.useState({}),G=i.useMemo(()=>s?!!(s.tipo==="admin"||s.subscription?.acesso_grupos||s.subscription?.plan_slug==="plano-premium"||s.is_premium):!1,[s]),F=i.useMemo(()=>s?!!(s.tipo==="admin"||s.subscription?.acesso_grupos||s.subscription?.plan_slug==="plano-premium"||s.is_premium):!1,[s]),ne=i.useCallback(()=>{l("/comunidade")},[l]);i.useEffect(()=>{const a=setTimeout(()=>{k(f.trim())},400);return()=>clearTimeout(a)},[f]);const w=i.useCallback(async()=>{h(!0);try{const a={limit:30};u&&u!=="todos"&&(a.filter=u),m&&(a.q=m),console.log("üîç Buscando grupos com params:",a);const r=await A.listGroups(a);if(console.log("üì¶ Resposta da API de grupos:",r),r?.success){const t=r.groups||r.grupos||r.data?.groups||r.data?.grupos||[];console.log("‚úÖ Grupos carregados:",t.length,t),d(t)}else console.warn("‚ö†Ô∏è Resposta sem success:",r),d([]),r?.message&&n(r.message,"error")}catch(a){console.error("Erro ao buscar grupos",a),n("N√£o foi poss√≠vel carregar os grupos","error"),d([])}finally{h(!1)}},[u,m]),j=i.useCallback(async()=>{if(!s){S([]),b({});return}J(!0);try{console.log("üîç Buscando grupos gerenciados...");const a=await A.listGroups({filter:"managed",limit:15});if(console.log("üì¶ Resposta de grupos gerenciados:",a),a?.success){const r=a.groups||a.grupos||a.data?.groups||a.data?.grupos||[];if(console.log("‚úÖ Grupos gerenciados:",r.length,r),S(r),r.length>0){const t={};await Promise.all(r.map(async v=>{try{const T=await A.listGroupRequests(v.id);T?.success?t[v.id]=T.requests?T.requests.length:0:t[v.id]=0}catch{t[v.id]=0}})),b(t)}else b({})}else S([]),b({})}catch(a){console.error("Erro ao carregar grupos moderados",a),S([]),b({})}finally{J(!1)}},[s]);i.useEffect(()=>{w()},[w]),i.useEffect(()=>{s?j():(S([]),b({}))},[s,j]);const ce=i.useCallback(async a=>{const r=a?.id;if(!(!r||M===r)){$(r);try{const t=await A.joinGroup(r);if(t?.success){n(t.message||"Solicita√ß√£o enviada","success");const v=t.data?.group?.slug;t.data?.membership?.status==="ativo"&&v?l(`/grupos/${v}`):await Promise.all([w(),j()])}else n(t?.message||"N√£o foi poss√≠vel participar do grupo","error")}catch(t){n(t?.message||"N√£o foi poss√≠vel participar do grupo","error")}finally{$(null)}}},[M,w,j,l]),H=i.useCallback(async a=>{if(!G)return n("Dispon√≠vel apenas para assinantes Premium ou administradoras.","warning"),{success:!1};V(!0);try{const r={nome:a.nome,descricao:a.descricao,categoria:a.categoria,imagem:a.imagem||null,privacidade:a.privacidade||"privado",moderacao_nivel:a.moderacao_nivel||"moderado",tags:a.tags||[]},t=await A.createGroup(r);return t?.success?(n("Grupo criado com sucesso! üéâ","success"),await Promise.all([w(),j()]),t.slug?l(`/grupos/${t.slug}`):t.group_id&&l(`/grupos/${t.group_id}`),{success:!0}):(n(t?.message||"N√£o foi poss√≠vel criar o grupo","error"),{success:!1})}catch(r){return console.error("Erro ao criar grupo",r),n(r?.message||"N√£o foi poss√≠vel criar o grupo","error"),{success:!1}}finally{V(!1)}},[G,n,w,j,l]),K=i.useMemo(()=>G?e.jsx(Ie,{onCreateGroup:H,triggerButtonProps:{className:"bg-coral hover:bg-coral/90 px-5 py-2",disabled:U}}):e.jsxs(x,{className:"bg-coral hover:bg-coral/90",onClick:()=>l("/planos"),children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Assine o plano Premium"]}),[G,H,U,l]),Q=i.useMemo(()=>{const a=new Map;return c.forEach(r=>{O(r.tags).forEach(t=>{a.set(t,(a.get(t)||0)+1)})}),Array.from(a.entries()).sort((r,t)=>t[1]-r[1]).slice(0,6)},[c]),me=E.length>0,W=p,X=c.length>0;return console.log("üé® Estado do render:",{loading:p,isLoading:W,groupsLength:c.length,hasGroups:X,groups:c}),e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-coral/5 to-olive/5 text-gray-800 overflow-x-hidden",children:[e.jsx(Be,{user:s,logout:o}),e.jsx("main",{className:"container mx-auto px-4 py-6 max-w-7xl",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsx(De,{active:"grupos"}),e.jsx("section",{className:"lg:col-span-9",children:e.jsxs("div",{className:"space-y-10",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs(x,{variant:"ghost",size:"sm",onClick:ne,className:"w-full justify-start gap-2 sm:w-auto",children:[e.jsx(Fe,{className:"h-4 w-4"}),"Voltar para a comunidade"]}),s&&e.jsxs(g,{variant:F?"default":"outline",className:F?"bg-olive text-white":"border-dashed border-coral/60 text-coral",children:[e.jsx(q,{className:"mr-1.5 h-3.5 w-3.5"}),F?"Plano Premium ativo":"Plano gratuito - aproveite para fazer upgrade"]})]}),e.jsx("section",{className:"rounded-3xl bg-gradient-to-br from-rose-50 via-white to-amber-50 p-8 shadow-sm ring-1 ring-rose-100/60",children:e.jsxs("div",{className:"flex flex-col gap-6 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(g,{className:"bg-coral/10 text-coral",children:"Comunidades exclusivas"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 sm:text-4xl",children:"Construa conex√µes poderosas com outras empreendedoras"}),e.jsx("p",{className:"max-w-2xl text-base text-gray-600",children:"Organize mentorias, desafios semanais e lan√ßamentos colaborativos em grupos escolhidos a dedo para o est√°gio do seu neg√≥cio."})]}),e.jsxs("div",{className:"flex flex-col gap-3 text-sm text-gray-600",children:[K,!G&&e.jsxs("p",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx(q,{className:"h-3.5 w-3.5"}),"Criar e moderar grupos √© um benef√≠cio do plano Premium."]})]})]})}),e.jsxs("section",{className:"flex flex-col gap-4 md:flex-row md:items-end md:justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Explorar grupos"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Filtre por grupos que voc√™ j√° participa ou descubra novas comunidades alinhadas ao seu momento."})]}),e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center",children:[e.jsxs("div",{className:"relative w-full sm:w-64",children:[e.jsx(Ne,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),e.jsx(R,{value:f,onChange:a=>C(a.target.value),placeholder:"Buscar por nome, categoria ou tag...",className:"pl-9"})]}),e.jsxs(Ce,{value:u,onValueChange:y,children:[e.jsxs(Se,{className:"w-full sm:w-56",children:[e.jsx(_e,{className:"mr-2 h-4 w-4"}),e.jsx(Ge,{placeholder:"Filtrar grupos"})]}),e.jsx(Ae,{children:Oe.map(a=>e.jsx(ke,{value:a.value,children:a.label},a.value))})]})]})]}),Q.length>0&&e.jsxs("section",{className:"rounded-2xl border border-dashed border-gray-200 bg-white/80 p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-gray-900",children:[e.jsx(re,{className:"h-4 w-4 text-coral"}),"Temas em destaque"]}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2 text-xs text-gray-600",children:Q.map(([a,r],t)=>e.jsxs(g,{variant:"outline",className:`${P[t%P.length]} border-none`,children:["#",a," ‚Ä¢ ",r]},a))})]}),me&&e.jsxs("section",{className:"space-y-4 rounded-3xl border border-olive/20 bg-olive/5 p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(qe,{className:"h-5 w-5 text-olive"}),"Painel das suas comunidades"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Aprove solicita√ß√µes pendentes, acompanhe o engajamento e mantenha a comunidade acolhedora."})]}),e.jsx(x,{variant:"ghost",size:"sm",onClick:()=>j(),disabled:D,children:D?e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"mr-2 h-4 w-4 animate-spin"}),"Atualizando"]}):"Atualizar"})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:D&&E.length===0?e.jsxs(e.Fragment,{children:[e.jsx(z,{}),e.jsx(z,{})]}):E.map(a=>e.jsx(Je,{group:a,pendingCount:le[a.id]||0,onNavigate:r=>l(`/grupos/${r.slug||r.id}`)},a.id))})]}),e.jsx("section",{children:W?e.jsx("div",{className:"grid gap-6 sm:grid-cols-2 lg:grid-cols-3",children:[1,2,3,4,5,6].map(a=>e.jsx(z,{},a))}):X?e.jsx("div",{className:"grid gap-6 sm:grid-cols-2 lg:grid-cols-3",children:c.map(a=>e.jsx(Ve,{group:a,onJoin:ce,isJoining:M===a.id,onNavigate:r=>l(`/grupos/${r.slug||r.id}`)},a.id))}):e.jsxs("div",{className:"rounded-3xl border border-dashed border-gray-200 bg-white p-10 text-center shadow-sm",children:[e.jsx(L,{className:"mx-auto h-12 w-12 text-gray-300"}),e.jsx("h3",{className:"mt-4 text-xl font-semibold text-gray-900",children:"Ainda n√£o encontramos grupos com esses filtros"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Explore outros temas ou aproveite para criar uma comunidade exclusiva para mentorias, desafios e trocas estrat√©gicas."}),e.jsx("div",{className:"mt-6",children:K})]})})]})})]})})]})}export{Be as GroupsHeader,Cs as default};
//# sourceMappingURL=GroupsPage-BeO5SpF_.js.map
