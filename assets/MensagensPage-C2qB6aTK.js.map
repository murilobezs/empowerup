{"version":3,"file":"MensagensPage-C2qB6aTK.js","sources":["../../node_modules/lucide-react/dist/esm/icons/check-check.js","../../node_modules/lucide-react/dist/esm/icons/dot.js","../../src/pages/MensagensPage.jsx"],"sourcesContent":["/**\n * @license lucide-react v0.522.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M18 6 7 17l-5-5\", key: \"116fxf\" }],\n  [\"path\", { d: \"m22 10-7.5 7.5L13 16\", key: \"ke71qq\" }]\n];\nconst CheckCheck = createLucideIcon(\"check-check\", __iconNode);\n\nexport { __iconNode, CheckCheck as default };\n//# sourceMappingURL=check-check.js.map\n","/**\n * @license lucide-react v0.522.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"circle\", { cx: \"12.1\", cy: \"12.1\", r: \"1\", key: \"18d7e5\" }]];\nconst Dot = createLucideIcon(\"dot\", __iconNode);\n\nexport { __iconNode, Dot as default };\n//# sourceMappingURL=dot.js.map\n","import { useState, useEffect, useRef, useCallback } from \"react\"\r\nimport { Link, useNavigate } from \"react-router-dom\"\r\nimport { Search, MessageCircle, Send, ArrowLeft, MoreHorizontal, Phone, Video, Check, CheckCheck, Clock3, Dot } from \"lucide-react\"\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"../components/ui/avatar\"\r\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from \"../components/ui/dropdown-menu\"\r\nimport { useAuth } from '../contexts/AuthContext'\r\nimport { useMessages } from '../contexts/MessagesContext'\r\nimport apiService from '../services/api'\r\nimport config from '../config/config'\r\nimport CommunityLeftSidebar from \"../components/layout/CommunityLeftSidebar\"\r\n\r\nexport function MensagensHeader({ user, logout }) {\r\n  const navigate = useNavigate()\r\n\r\n  return (\r\n    <header className=\"sticky top-0 z-50 w-full border-b border-gray-200 bg-white/80 backdrop-blur-md\">\r\n      <div className=\"container flex h-16 items-center justify-between px-6\">\r\n        <div className=\"flex items-center gap-6\">\r\n          <Link to=\"/\" className=\"flex items-center hover:opacity-80 transition-opacity\">\r\n            <img src=\"/logo-sem-fundo.png\" alt=\"EmpowerUp\" className=\"h-8 w-auto\" />\r\n          </Link>\r\n          <div className=\"flex items-center gap-2 text-xl font-bold text-gray-900\">\r\n            <MessageCircle className=\"w-6 h-6 text-coral\" />\r\n            Mensagens\r\n          </div>\r\n        </div>\r\n\r\n        <DropdownMenu>\r\n          <DropdownMenuTrigger className=\"flex items-center gap-3 p-2 rounded-full hover:bg-gray-100 transition-colors\">\r\n            <Avatar className=\"w-8 h-8\">\r\n              <AvatarImage src={user?.avatar_url ? config.getPublicUrl(user.avatar_url) : \"\"} />\r\n              <AvatarFallback className=\"bg-coral text-white text-sm font-medium\">\r\n                {user?.nome?.charAt(0)}\r\n              </AvatarFallback>\r\n            </Avatar>\r\n            <span className=\"font-medium text-gray-900 hidden sm:block\">{user?.nome}</span>\r\n          </DropdownMenuTrigger>\r\n          <DropdownMenuContent align=\"end\" className=\"w-56 mt-2\">\r\n            <DropdownMenuItem onClick={() => navigate('/perfil')} className=\"cursor-pointer\">\r\n              Meu Perfil\r\n            </DropdownMenuItem>\r\n            <DropdownMenuItem \r\n              onClick={() => {\r\n                logout()\r\n                navigate('/')\r\n              }}\r\n              className=\"cursor-pointer text-red-600\"\r\n            >\r\n              Sair\r\n            </DropdownMenuItem>\r\n          </DropdownMenuContent>\r\n        </DropdownMenu>\r\n      </div>\r\n    </header>\r\n  )\r\n}\r\n\r\nexport default function MensagensPage() {\r\n  const { user, logout } = useAuth();\r\n  const { refresh: refreshMessagesSummary } = useMessages();\r\n  const [activeTab, setActiveTab] = useState(\"all\") // \"all\" ou \"groups\"\r\n  const [conversas, setConversas] = useState([])\r\n  const [conversaSelecionada, setConversaSelecionada] = useState(null)\r\n  const [mensagens, setMensagens] = useState([])\r\n  const [novaMensagem, setNovaMensagem] = useState(\"\")\r\n  const [loading, setLoading] = useState(true)\r\n  const [searchQuery, setSearchQuery] = useState(\"\")\r\n  const [showNewMessageModal, setShowNewMessageModal] = useState(false)\r\n  const [showMobileChat, setShowMobileChat] = useState(false)\r\n  // Dados auxiliares da sidebar direita n√£o s√£o necess√°rios na p√°gina de mensagens\r\n\r\n  const chatEndRef = useRef(null)\r\n  const navigate = useNavigate()\r\n\r\n  const mapConversationFromApi = useCallback((conversation) => {\r\n    if (!conversation) {\r\n      return null\r\n    }\r\n\r\n    const participantes = conversation.participantes || []\r\n    const outroUsuario = conversation.outro_usuario || participantes.find((p) => p.id !== user?.id)\r\n    const rawLastMessage = conversation.ultima_mensagem ?? conversation.last_message ?? null\r\n    const ultimaInfo = normalizeUltimaMensagem(rawLastMessage, user?.id)\r\n    const timestamp = ultimaInfo.timestamp || rawLastMessage?.enviada_em || conversation.ultima_mensagem_em || conversation.ultima_mensagem_data || conversation.timestamp || new Date().toISOString()\r\n    const tipoNormalizado = conversation.tipo === 'grupo' ? 'group' : 'private'\r\n    const avatarUrl = conversation.avatar_url || outroUsuario?.avatar_url || conversation.imagem || null\r\n\r\n    return {\r\n      id: conversation.id,\r\n      nome: conversation.nome || outroUsuario?.nome || 'Usu√°rio',\r\n      tipo: tipoNormalizado,\r\n      ultima_mensagem: rawLastMessage,\r\n      ultima_mensagem_preview: ultimaInfo.preview,\r\n      timestamp,\r\n      outro_usuario: outroUsuario || null,\r\n      conversa_existente: true,\r\n      avatar_url: avatarUrl,\r\n      unread_count: conversation.unread_count ?? 0,\r\n      participantes,\r\n      isPotential: false\r\n    }\r\n  }, [user?.id])\r\n\r\n  const normalizeUltimaMensagem = (raw, currentUserId) => {\r\n    if (!raw) {\r\n      return { preview: '', timestamp: null, isMine: false, raw: null }\r\n    }\r\n\r\n    if (typeof raw === 'string') {\r\n      return { preview: raw, timestamp: null, isMine: false, raw }\r\n    }\r\n\r\n    if (Array.isArray(raw)) {\r\n      const combinedText = raw\r\n        .map((item) => normalizeUltimaMensagem(item, currentUserId).preview)\r\n        .filter(Boolean)\r\n        .join(', ')\r\n      return { preview: combinedText, timestamp: null, isMine: false, raw }\r\n    }\r\n\r\n    if (typeof raw === 'object') {\r\n      const previewRaw = raw.conteudo ?? raw.texto ?? raw.message ?? raw.preview ?? ''\r\n      const previewBase = typeof previewRaw === 'string' ? previewRaw : String(previewRaw ?? '')\r\n      const timestamp = raw.enviada_em ?? raw.created_at ?? raw.timestamp ?? raw.data ?? null\r\n      const authorName = raw.autor?.nome ?? raw.autor_nome ?? ''\r\n      const resolvedUserId = raw.usuario_id ?? raw.autor?.id ?? null\r\n      const isMine = resolvedUserId && currentUserId ? Number(resolvedUserId) === Number(currentUserId) : !!raw.isMine\r\n      const decoratedPreview = isMine\r\n        ? `Voc√™: ${previewBase}`\r\n        : authorName\r\n          ? `${authorName.split(' ')[0]}: ${previewBase}`\r\n          : previewBase\r\n\r\n      return {\r\n        preview: decoratedPreview,\r\n        timestamp: timestamp || null,\r\n        isMine,\r\n        raw\r\n      }\r\n    }\r\n\r\n    return { preview: String(raw), timestamp: null, isMine: false, raw }\r\n  }\r\n\r\n  const handleNewMessage = () => {\r\n    // Se h√° usu√°rios seguindo, abrir modal para escolher\r\n    if (conversas.some(c => c.isPotential)) {\r\n      setShowNewMessageModal(true);\r\n    } else {\r\n      // Redirecionar para p√°gina de explorar para seguir usu√°rios\r\n      navigate('/explore');\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    refreshMessagesSummary();\r\n  }, [refreshMessagesSummary, mapConversationFromApi, user?.id]);\r\n\r\n  useEffect(() => {\r\n    const fetchConversas = async () => {\r\n      try {\r\n        // Primeiro, buscar conversas existentes\r\n        console.log('üîç Buscando conversas existentes...');\r\n    const conversasResponse = await apiService.getConversations();\r\n    const conversasExistentes = conversasResponse.conversas || [];\r\n        console.log('üìã Conversas existentes:', conversasExistentes);\r\n\r\n        // Depois, buscar usu√°rios que sigo (para criar novas conversas)\r\n        console.log('üîç Buscando usu√°rios que sigo...');\r\n        let usuariosSeguindo = [];\r\n        \r\n        try {\r\n          const usuariosResponse = await apiService.request('/usuarios/seguindo');\r\n          console.log('üë• Resposta completa da API /usuarios/seguindo:', usuariosResponse);\r\n          \r\n          // A API retorna diretamente o array de usu√°rios ou um objeto success com os dados\r\n          if (Array.isArray(usuariosResponse)) {\r\n            usuariosSeguindo = usuariosResponse;\r\n          } else if (usuariosResponse && Array.isArray(usuariosResponse.data)) {\r\n            usuariosSeguindo = usuariosResponse.data;\r\n          } else if (usuariosResponse && usuariosResponse.success && Array.isArray(usuariosResponse.data)) {\r\n            usuariosSeguindo = usuariosResponse.data;\r\n          } else {\r\n            // Fallback: pegar todos os usu√°rios se n√£o conseguir pegar os seguindo\r\n            console.log('‚ö†Ô∏è Estrutura inesperada, tentando fallback...');\r\n            usuariosSeguindo = usuariosResponse || [];\r\n          }\r\n        } catch (followingError) {\r\n          console.log('‚ùå Erro ao buscar usu√°rios seguindo, tentando todos os usu√°rios...', followingError);\r\n          \r\n          // Fallback: buscar todos os usu√°rios\r\n          try {\r\n            const todosUsuariosResponse = await apiService.request('/usuarios');\r\n            console.log('üë• Fallback - Todos os usu√°rios:', todosUsuariosResponse);\r\n            \r\n            if (Array.isArray(todosUsuariosResponse)) {\r\n              usuariosSeguindo = todosUsuariosResponse;\r\n            } else if (todosUsuariosResponse && Array.isArray(todosUsuariosResponse.data)) {\r\n              usuariosSeguindo = todosUsuariosResponse.data;\r\n            } else {\r\n              usuariosSeguindo = todosUsuariosResponse || [];\r\n            }\r\n          } catch (allUsersError) {\r\n            console.error('‚ùå Erro ao buscar todos os usu√°rios:', allUsersError);\r\n            usuariosSeguindo = [];\r\n          }\r\n        }\r\n        \r\n        console.log('üë• Usu√°rios que sigo (final):', usuariosSeguindo);\r\n\r\n        // Filtrar usu√°rios seguindo que n√£o t√™m conversa ainda\r\n        const usuariosComConversa = conversasExistentes\r\n          .map(c => {\r\n            if (c.outro_usuario?.id) return c.outro_usuario.id;\r\n            const participante = (c.participantes || []).find(p => p.id !== user?.id);\r\n            return participante?.id;\r\n          })\r\n          .filter(Boolean);\r\n        \r\n        // IMPORTANTE: Se n√£o h√° conversas, TODOS os usu√°rios seguindo devem aparecer\r\n        const usuariosSemConversa = usuariosSeguindo.filter(u => {\r\n          // Verificar se o usu√°rio tem os dados necess√°rios\r\n          if (!u || !u.id) {\r\n            console.log('‚ö†Ô∏è Usu√°rio inv√°lido encontrado:', u);\r\n            return false;\r\n          }\r\n          \r\n          // Se n√£o h√° conversas ainda, mostrar todos os usu√°rios seguindo\r\n          if (conversasExistentes.length === 0) {\r\n            console.log('‚úÖ Sem conversas existentes - mostrando usu√°rio:', u.nome);\r\n            return true;\r\n          }\r\n          \r\n          // Se h√° conversas, filtrar apenas os que n√£o t√™m conversa ainda\r\n          const temConversa = usuariosComConversa.includes(u.id);\r\n          console.log(`${temConversa ? '‚ùå' : '‚úÖ'} Usu√°rio ${u.nome} ${temConversa ? 'J√Å tem' : 'N√ÉO tem'} conversa`);\r\n          return !temConversa;\r\n        });\r\n\r\n        console.log('üìä Estat√≠sticas DETALHADAS:', {\r\n          conversasExistentes: conversasExistentes.length,\r\n          usuariosSeguindo: usuariosSeguindo.length,\r\n          usuariosComConversa: usuariosComConversa,\r\n          usuariosSemConversa: usuariosSemConversa.length,\r\n          usuariosSemConversaDetalhes: usuariosSemConversa,\r\n          logica: conversasExistentes.length === 0 ? 'MOSTRANDO TODOS (sem conversas)' : 'FILTRANDO (com conversas)'\r\n        });\r\n\r\n        // Mapear conversas existentes\r\n        const conversasFormatadas = conversasExistentes\r\n          .map(mapConversationFromApi)\r\n          .filter(Boolean)\r\n\r\n        // Mapear usu√°rios sem conversa como conversas potenciais\r\n        const conversasPotenciais = usuariosSemConversa.map(u => ({\r\n          id: `potential_${u.id}`,\r\n          nome: u.nome,\r\n          tipo: \"private\",\r\n          ultima_mensagem: \"\",\r\n          timestamp: new Date().toISOString(),\r\n          outro_usuario: u,\r\n          conversa_existente: false,\r\n          avatar_url: u.avatar_url,\r\n          isPotential: true\r\n        }));\r\n\r\n        // Buscar grupos (mantido para futuro)\r\n        const gruposResponse = await apiService.request('/grupos');\r\n        const grupos = (gruposResponse.grupos || [])\r\n          .map((g) => {\r\n            const mapped = mapConversationFromApi({ ...g, tipo: 'grupo' })\r\n            if (!mapped) return null\r\n            return {\r\n              ...mapped,\r\n              grupo: g\r\n            }\r\n          })\r\n          .filter(Boolean)\r\n\r\n        // Combinar e ordenar por timestamp\r\n        const todasConversas = [...conversasFormatadas, ...conversasPotenciais, ...grupos]\r\n          .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));\r\n\r\n        console.log('üéØ Resultado final:', {\r\n          conversasExistentes: conversasExistentes.length,\r\n          usuariosSeguindo: usuariosSeguindo.length,\r\n          conversasFormatadas: conversasFormatadas.length,\r\n          conversasPotenciais: conversasPotenciais.length,\r\n          todasConversas: todasConversas.length,\r\n          dados: todasConversas\r\n        });\r\n\r\n        setConversas(todasConversas);\r\n        refreshMessagesSummary();\r\n      } catch (err) {\r\n        console.error(\"‚ùå Erro geral ao buscar conversas:\", err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchConversas();\r\n  }, [refreshMessagesSummary]);\r\n\r\n  const iniciarConversa = async (userId) => {\r\n    try {\r\n      const response = await apiService.startConversation(userId);\r\n      \r\n      if (response.success) {\r\n        const conversaId = response.conversa_id;\r\n        setConversaSelecionada(conversaId);\r\n        setShowMobileChat(true);\r\n        \r\n        // Carregar mensagens da conversa\r\n        const mensagensResponse = await apiService.getConversationMessages(conversaId);\r\n        setMensagens(mensagensResponse.mensagens || []);\r\n        scrollToBottom();\r\n\r\n        await refreshMessagesSummary();\r\n\r\n        // Atualizar a lista de conversas para remover a conversa potencial e adicionar a real\r\n        const fetchConversas = async () => {\r\n          const conversasResponse = await apiService.getConversations();\r\n          const conversasExistentes = conversasResponse.conversas || [];\r\n          const conversasFormatadas = conversasExistentes\r\n            .map(mapConversationFromApi)\r\n            .filter(Boolean);\r\n          \r\n          setConversas(prev => [\r\n            ...conversasFormatadas,\r\n            ...prev.filter(c => c.tipo === \"group\" || (c.isPotential && c.outro_usuario?.id !== userId))\r\n          ]);\r\n        };\r\n        fetchConversas();\r\n        refreshMessagesSummary();\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Erro ao iniciar conversa:\", err);\r\n    }\r\n  };\r\n\r\n  const carregarMensagens = async (conversaId) => {\r\n    try {\r\n      setConversaSelecionada(conversaId);\r\n      setShowMobileChat(true);\r\n      const response = await apiService.getConversationMessages(conversaId);\r\n      setMensagens(response.mensagens || []);\r\n      setConversas(prev => prev.map(c =>\r\n        c.id === conversaId ? { ...c, unread_count: 0 } : c\r\n      ));\r\n      scrollToBottom();\r\n      await refreshMessagesSummary();\r\n    } catch (err) {\r\n      console.error(\"Erro ao carregar mensagens:\", err);\r\n    }\r\n  };\r\n\r\n  const enviarMensagem = async () => {\r\n    if (!novaMensagem.trim() || !conversaSelecionada) return;\r\n\r\n    try {\r\n      const response = await apiService.sendMessage(conversaSelecionada, { \r\n        conteudo: novaMensagem \r\n      });\r\n      \r\n      if (response.success) {\r\n        setMensagens(prev => [...prev, response.mensagem]);\r\n        setNovaMensagem(\"\");\r\n        scrollToBottom();\r\n        \r\n        // Atualizar √∫ltima mensagem na lista de conversas\r\n        setConversas(prev => prev.map(c => \r\n          c.id === conversaSelecionada ? \r\n          { \r\n            ...c, \r\n            ultima_mensagem: response.mensagem,\r\n            ultima_mensagem_preview: normalizeUltimaMensagem(response.mensagem, user?.id).preview,\r\n            timestamp: response.mensagem?.enviada_em || new Date().toISOString(),\r\n            unread_count: 0\r\n          } : \r\n          c\r\n        ).sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp)));\r\n        refreshMessagesSummary();\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Erro ao enviar mensagem:\", err);\r\n    }\r\n  };\r\n\r\n  const scrollToBottom = () => {\r\n    setTimeout(() => {\r\n      chatEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n    }, 100);\r\n  };\r\n\r\n  const formatTime = (timestamp) => {\r\n    if (!timestamp) return '';\r\n    const date = new Date(timestamp);\r\n    const now = new Date();\r\n    const diffInHours = (now - date) / (1000 * 60 * 60);\r\n    \r\n    if (diffInHours < 1) {\r\n      const diffInMinutes = Math.floor((now - date) / (1000 * 60));\r\n      return diffInMinutes <= 1 ? 'agora' : `${diffInMinutes}m`;\r\n    } else if (diffInHours < 24) {\r\n      return `${Math.floor(diffInHours)}h`;\r\n    } else {\r\n      return date.toLocaleDateString('pt-BR', { day: 'numeric', month: 'short' });\r\n    }\r\n  };\r\n\r\n  const formatMessageTime = (timestamp) => {\r\n    if (!timestamp) return '';\r\n    const date = new Date(timestamp);\r\n    return date.toLocaleTimeString('pt-BR', { \r\n      hour: '2-digit', \r\n      minute: '2-digit' \r\n    });\r\n  };\r\n\r\n  const getStatusDescriptor = (mensagem) => {\r\n    if (!mensagem) return null;\r\n    const usuarioId = Number(mensagem.usuario_id ?? mensagem.autor?.id ?? null);\r\n    const currentUserId = Number(user?.id ?? null);\r\n    const isMine = currentUserId && usuarioId ? usuarioId === currentUserId : false;\r\n    const status = mensagem.status || {};\r\n\r\n    return {\r\n      isMine,\r\n      key: status.key || (isMine ? 'sent' : ''),\r\n      label: status.label || '',\r\n      timestamp: status.timestamp || null,\r\n      isUnread: Boolean(mensagem.is_unread)\r\n    };\r\n  };\r\n\r\n  const renderStatusIcon = (descriptor, variant = 'bubble') => {\r\n    if (!descriptor) return null;\r\n\r\n    const { isMine, key, label, timestamp, isUnread } = descriptor;\r\n    const sizeClasses = variant === 'bubble' ? 'w-4 h-4' : 'w-3 h-3';\r\n    const titleParts = [];\r\n    if (label) titleParts.push(label);\r\n    if (timestamp) titleParts.push(formatMessageTime(timestamp));\r\n    const title = titleParts.length > 0 ? titleParts.join(' ‚Ä¢ ') : undefined;\r\n\r\n    if (isMine) {\r\n      switch (key) {\r\n        case 'read':\r\n          return <CheckCheck className={`${sizeClasses} ${variant === 'bubble' ? 'text-white' : 'text-coral'}`} title={title} />;\r\n        case 'delivered':\r\n          return <CheckCheck className={`${sizeClasses} ${variant === 'bubble' ? 'text-white/90' : 'text-gray-400'}`} title={title} />;\r\n        case 'sent':\r\n          return <Check className={`${sizeClasses} ${variant === 'bubble' ? 'text-white/90' : 'text-gray-400'}`} title={title} />;\r\n        default:\r\n          return <Clock3 className={`${sizeClasses} ${variant === 'bubble' ? 'text-white/70' : 'text-gray-400'}`} title={title || 'Enviando'} />;\r\n      }\r\n    }\r\n\r\n    if (isUnread) {\r\n      return <Dot className={`${sizeClasses} text-coral`} title=\"Nova mensagem\" />;\r\n    }\r\n\r\n    if (key === 'seen') {\r\n      return <CheckCheck className={`${sizeClasses} text-gray-400`} title={title} />;\r\n    }\r\n\r\n    if (key === 'received') {\r\n      return <Check className={`${sizeClasses} text-gray-400`} title={title} />;\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  // Filtrar conversas baseado na busca e tab ativo\r\n  const conversasFiltradas = conversas\r\n    .filter(c => {\r\n      if (activeTab === \"groups\") return c.tipo === \"group\";\r\n      return c.tipo === \"private\";\r\n    })\r\n    .filter(c => {\r\n      if (!searchQuery) return true;\r\n      return c.nome.toLowerCase().includes(searchQuery.toLowerCase());\r\n    });\r\n\r\n  const conversaAtual = conversas.find(c => c.id === conversaSelecionada);\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-b from-coral/5 to-olive/5 text-gray-800\">\r\n      <MensagensHeader user={user} logout={logout} />\r\n\r\n      <main className=\"container mx-auto px-4 py-6 max-w-7xl\">\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-12 gap-6\">\r\n          <CommunityLeftSidebar active=\"mensagens\" />\r\n\r\n          <section className=\"lg:col-span-9\">\r\n            <div className=\"bg-white border border-gray-200 rounded-3xl shadow-sm overflow-hidden\">\r\n              <div className=\"flex flex-col h-[calc(100vh-240px)] md:h-[calc(100vh-200px)]\">\r\n                <div className=\"flex items-center justify-between px-6 py-4 border-b border-gray-100\">\r\n                  <h1 className=\"text-xl font-semibold text-gray-900\">Mensagens</h1>\r\n                  <button\r\n                    onClick={handleNewMessage}\r\n                    className=\"hidden md:inline-flex items-center gap-2 px-4 py-2 bg-coral text-white text-sm font-medium rounded-full hover:bg-coral-dark transition-colors\"\r\n                  >\r\n                    Nova mensagem\r\n                  </button>\r\n                </div>\r\n\r\n                <div className=\"flex flex-1 overflow-hidden\">\r\n                  {/* Sidebar de conversas */}\r\n                  <div className={`${showMobileChat ? 'hidden md:flex' : 'flex'} md:w-80 w-full flex-col border-r border-gray-100 bg-white`}>\r\n                    {/* Header da sidebar */}\r\n                    <div className=\"p-4 border-b border-gray-100\">\r\n                      <div className=\"relative mb-4\">\r\n                        <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-4 h-4\" />\r\n                        <input\r\n                          type=\"text\"\r\n                          placeholder=\"Buscar conversas...\"\r\n                          className=\"w-full pl-10 pr-4 py-3 bg-gray-50 rounded-full border-0 focus:bg-white focus:ring-2 focus:ring-coral outline-none transition-all\"\r\n                          value={searchQuery}\r\n                          onChange={(e) => setSearchQuery(e.target.value)}\r\n                        />\r\n                      </div>\r\n                      \r\n                      {/* Tabs */}\r\n                      <div className=\"flex bg-gray-100 rounded-full p-1\">\r\n                        <button\r\n                          className={`flex-1 px-4 py-2 rounded-full font-medium text-sm transition-all ${\r\n                            activeTab === \"all\"\r\n                              ? \"bg-white text-coral shadow-sm\"\r\n                              : \"text-gray-600 hover:text-gray-900\"\r\n                          }`}\r\n                          onClick={() => setActiveTab(\"all\")}\r\n                        >\r\n                          Todas\r\n                        </button>\r\n                        <button\r\n                          className={`flex-1 px-4 py-2 rounded-full font-medium text-sm transition-all ${\r\n                            activeTab === \"groups\"\r\n                              ? \"bg-white text-coral shadow-sm\"\r\n                              : \"text-gray-600 hover:text-gray-900\"\r\n                          }`}\r\n                          onClick={() => setActiveTab(\"groups\")}\r\n                        >\r\n                          Grupos\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* Lista de conversas */}\r\n                    <div className=\"flex-1 overflow-y-auto\">\r\n                      {loading ? (\r\n                        <div className=\"flex items-center justify-center py-8\">\r\n                          <div className=\"animate-spin rounded-full h-8 w-8 border-2 border-coral border-t-transparent\"></div>\r\n                        </div>\r\n                      ) : conversasFiltradas.length === 0 ? (\r\n                        <div className=\"flex flex-col items-center justify-center py-12 px-4 text-center\">\r\n                          <MessageCircle className=\"w-12 h-12 text-gray-300 mb-3\" />\r\n                          <p className=\"text-gray-500 font-medium\">\r\n                            {activeTab === \"groups\" ? \"Nenhuma conversa encontrada\" : \r\n                             conversas.filter(c => c.isPotential).length > 0 ? \r\n                             \"Escolha algu√©m na lista para conversar\" : \r\n                             \"Nenhuma conversa encontrada\"}\r\n                          </p>\r\n                          <p className=\"text-gray-400 text-sm mt-1\">\r\n                            {activeTab === \"groups\" ? \r\n                              \"Voc√™ ainda n√£o participa de nenhum grupo\" : \r\n                              conversas.filter(c => c.isPotential).length > 0 ?\r\n                              `${conversas.filter(c => c.isPotential).length} ${conversas.filter(c => c.isPotential).length === 1 ? 'pessoa dispon√≠vel' : 'pessoas dispon√≠veis'} para conversar` :\r\n                              \"Comece seguindo alguns usu√°rios\"\r\n                            }\r\n                          </p>\r\n                          {conversas.filter(c => c.isPotential).length === 0 && activeTab !== \"groups\" && (\r\n                            <button \r\n                              onClick={() => navigate('/explore')}\r\n                              className=\"mt-4 px-4 py-2 bg-coral text-white rounded-full text-sm hover:bg-coral-dark transition-colors\"\r\n                            >\r\n                              Explorar usu√°rios\r\n                            </button>\r\n                          )}\r\n                        </div>\r\n                      ) : (\r\n                        <div className=\"divide-y divide-gray-100\">\r\n                          {conversasFiltradas.map((conversa) => {\r\n                            const ultimaMensagemInfo = normalizeUltimaMensagem(conversa.ultima_mensagem, user?.id);\r\n                            const ultimaMensagemPreview = ultimaMensagemInfo.preview;\r\n                            const lastMessageDescriptor = getStatusDescriptor(conversa.ultima_mensagem);\r\n                            const listStatusIcon = (conversa.unread_count > 0 && !(lastMessageDescriptor?.isMine))\r\n                              ? null\r\n                              : renderStatusIcon(lastMessageDescriptor, 'list');\r\n\r\n                            return (\r\n                              <div\r\n                                key={conversa.id}\r\n                                className={`p-4 hover:bg-gray-50 cursor-pointer transition-colors ${\r\n                                  conversaSelecionada === conversa.id ? 'bg-coral/10 border-r-2 border-coral' : ''\r\n                                }`}\r\n                                onClick={() => {\r\n                                  if (conversa.tipo === 'private') {\r\n                                    if (conversa.conversa_existente) {\r\n                                      carregarMensagens(conversa.id);\r\n                                    } else {\r\n                                      iniciarConversa(conversa.outro_usuario.id);\r\n                                    }\r\n                                  } else {\r\n                                    carregarMensagens(conversa.id);\r\n                                  }\r\n                                }}\r\n                              >\r\n                                <div className=\"flex items-center gap-3\">\r\n                                  <div className=\"relative\">\r\n                                    <Avatar className=\"w-12 h-12\">\r\n                                      <AvatarImage \r\n                                        src={conversa.avatar_url ? config.getPublicUrl(conversa.avatar_url) : \"\"} \r\n                                      />\r\n                                      <AvatarFallback className=\"bg-gradient-to-br from-coral to-coral-light text-white font-medium\">\r\n                                        {conversa.nome.charAt(0).toUpperCase()}\r\n                                      </AvatarFallback>\r\n                                    </Avatar>\r\n                                    {conversa.tipo === \"group\" && (\r\n                                      <div className=\"absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white\"></div>\r\n                                    )}\r\n                                  </div>\r\n                                  \r\n                                  <div className=\"flex-1 min-w-0\">\r\n                                    <div className=\"flex items-center justify-between\">\r\n                                      <h3 className=\"font-semibold text-gray-900 truncate\">\r\n                                        {conversa.nome}\r\n                                      </h3>\r\n                                      <span className=\"text-xs text-gray-500 ml-2 flex-shrink-0\">\r\n                                        {formatTime(conversa.timestamp)}\r\n                                      </span>\r\n                                    </div>\r\n                                    \r\n                                    <div className=\"mt-1 flex items-center gap-2\">\r\n                                      {listStatusIcon}\r\n                                      <span\r\n                                        className={`text-sm truncate flex-1 ${\r\n                                          conversa.unread_count > 0 && !conversa.isPotential\r\n                                            ? 'font-semibold text-gray-900'\r\n                                            : 'text-gray-600'\r\n                                        }`}\r\n                                      >\r\n                                        {ultimaMensagemPreview ? (\r\n                                          ultimaMensagemPreview\r\n                                        ) : conversa.isPotential ? (\r\n                                          <span className=\"italic text-coral\">Iniciar conversa</span>\r\n                                        ) : (\r\n                                          <span className=\"italic\">Sem mensagens</span>\r\n                                        )}\r\n                                      </span>\r\n                                      {conversa.unread_count > 0 && !conversa.isPotential && (\r\n                                        <span className=\"ml-auto inline-flex min-w-[20px] justify-center rounded-full bg-coral/10 px-2 py-0.5 text-xs font-semibold text-coral\">\r\n                                          {conversa.unread_count > 99 ? '99+' : conversa.unread_count}\r\n                                        </span>\r\n                                      )}\r\n                                    </div>\r\n                                  </div>\r\n                                </div>\r\n                              </div>\r\n                            );\r\n                          })}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* √Årea do chat */}\r\n                  <div className={`${showMobileChat ? 'flex' : 'hidden md:flex'} flex-1 flex-col bg-white`}>\r\n                    {conversaSelecionada && conversaAtual ? (\r\n                      <>\r\n                        {/* Header do chat */}\r\n                        <div className=\"flex items-center justify-between p-4 border-b border-gray-100 bg-white\">\r\n                          <div className=\"flex items-center gap-3\">\r\n                            <button\r\n                              className=\"md:hidden p-2 hover:bg-gray-100 rounded-full\"\r\n                              onClick={() => setShowMobileChat(false)}\r\n                            >\r\n                              <ArrowLeft className=\"w-5 h-5\" />\r\n                            </button>\r\n                            \r\n                            <Avatar className=\"w-10 h-10\">\r\n                              <AvatarImage \r\n                                src={conversaAtual.avatar_url ? config.getPublicUrl(conversaAtual.avatar_url) : \"\"} \r\n                              />\r\n                              <AvatarFallback className=\"bg-gradient-to-br from-coral to-coral-light text-white font-medium\">\r\n                                {conversaAtual.nome.charAt(0).toUpperCase()}\r\n                              </AvatarFallback>\r\n                            </Avatar>\r\n                            \r\n                            <div>\r\n                              <h2 className=\"font-semibold text-gray-900\">{conversaAtual.nome}</h2>\r\n                              <p className=\"text-sm text-gray-500\">\r\n                                {conversaAtual.tipo === \"group\" ? \"Grupo\" : \"Online\"}\r\n                              </p>\r\n                            </div>\r\n                          </div>\r\n\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <button className=\"p-2 hover:bg-gray-100 rounded-full transition-colors\">\r\n                              <Phone className=\"w-5 h-5 text-gray-600\" />\r\n                            </button>\r\n                            <button className=\"p-2 hover:bg-gray-100 rounded-full transition-colors\">\r\n                              <Video className=\"w-5 h-5 text-gray-600\" />\r\n                            </button>\r\n                            <DropdownMenu>\r\n                              <DropdownMenuTrigger className=\"p-2 hover:bg-gray-100 rounded-full transition-colors\">\r\n                                <MoreHorizontal className=\"w-5 h-5 text-gray-600\" />\r\n                              </DropdownMenuTrigger>\r\n                              <DropdownMenuContent>\r\n                                <DropdownMenuItem>Ver perfil</DropdownMenuItem>\r\n                                <DropdownMenuItem>Silenciar</DropdownMenuItem>\r\n                                <DropdownMenuItem className=\"text-red-600\">Bloquear</DropdownMenuItem>\r\n                              </DropdownMenuContent>\r\n                            </DropdownMenu>\r\n                          </div>\r\n                        </div>\r\n\r\n                        {/* √Årea de mensagens */}\r\n                        <div className=\"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50\">\r\n                          {mensagens.length === 0 ? (\r\n                            <div className=\"flex flex-col items-center justify-center h-full text-center\">\r\n                              <div className=\"w-16 h-16 bg-coral/10 rounded-full flex items-center justify-center mb-4\">\r\n                                <MessageCircle className=\"w-8 h-8 text-coral\" />\r\n                              </div>\r\n                              <h3 className=\"font-semibold text-gray-900 mb-2\">\r\n                                {conversaAtual.isPotential ? \"Inicie uma conversa\" : \"Nenhuma mensagem ainda\"}\r\n                              </h3>\r\n                              <p className=\"text-gray-500 text-sm\">\r\n                                {conversaAtual.isPotential \r\n                                  ? `Envie uma mensagem para ${conversaAtual.nome}`\r\n                                  : \"Seja a primeira a enviar uma mensagem!\"\r\n                                }\r\n                              </p>\r\n                            </div>\r\n                          ) : (\r\n                            <>\r\n                              {mensagens.map((mensagem, index) => {\r\n                                const isOwn = mensagem.usuario_id === user?.id;\r\n                                const showAvatar = !isOwn && (index === mensagens.length - 1 || mensagens[index + 1]?.usuario_id !== mensagem.usuario_id);\r\n                                const statusDescriptor = getStatusDescriptor(mensagem);\r\n                                const bubbleStatusIcon = renderStatusIcon(statusDescriptor, 'bubble');\r\n                                \r\n                                return (\r\n                                  <div\r\n                                    key={mensagem.id}\r\n                                    className={`flex gap-2 ${isOwn ? 'justify-end' : 'justify-start'}`}\r\n                                  >\r\n                                    {!isOwn && (\r\n                                      <Avatar className={`w-8 h-8 ${showAvatar ? 'opacity-100' : 'opacity-0'}`}>\r\n                                        <AvatarImage \r\n                                          src={conversaAtual.avatar_url ? config.getPublicUrl(conversaAtual.avatar_url) : \"\"} \r\n                                        />\r\n                                        <AvatarFallback className=\"bg-gray-300 text-gray-600 text-sm\">\r\n                                          {conversaAtual.nome.charAt(0).toUpperCase()}\r\n                                        </AvatarFallback>\r\n                                      </Avatar>\r\n                                    )}\r\n                                    \r\n                                    <div className={`flex flex-col max-w-xs lg:max-w-md ${isOwn ? 'items-end' : 'items-start'}`}>\r\n                                      <div\r\n                                        className={`px-4 py-2 rounded-2xl shadow-sm ${\r\n                                          isOwn\r\n                                            ? 'bg-coral text-white rounded-br-md'\r\n                                            : 'bg-white text-gray-900 border border-gray-200 rounded-bl-md'\r\n                                        }`}\r\n                                      >\r\n                                        <p className=\"text-sm leading-relaxed break-words\">\r\n                                          {mensagem.conteudo}\r\n                                        </p>\r\n                                      </div>\r\n                                      <div\r\n                                        className={`mt-1 flex items-center gap-1 px-1 text-xs ${\r\n                                          isOwn ? 'text-white/80' : 'text-gray-500'\r\n                                        }`}\r\n                                      >\r\n                                        <span>{formatMessageTime(mensagem.enviada_em)}</span>\r\n                                        {bubbleStatusIcon}\r\n                                      </div>\r\n                                    </div>\r\n                                  </div>\r\n                                );\r\n                              })}\r\n                              <div ref={chatEndRef} />\r\n                            </>\r\n                          )}\r\n                        </div>\r\n\r\n                        {/* Input de mensagem */}\r\n                        <div className=\"p-4 border-t border-gray-100 bg-white\">\r\n                          <div className=\"flex items-end gap-3\">\r\n                            <div className=\"flex-1\">\r\n                              <textarea\r\n                                placeholder={`Mensagem para ${conversaAtual.nome}...`}\r\n                                className=\"w-full px-4 py-3 bg-gray-50 rounded-2xl border-0 resize-none focus:bg-white focus:ring-2 focus:ring-coral outline-none transition-all max-h-32\"\r\n                                value={novaMensagem}\r\n                                onChange={(e) => setNovaMensagem(e.target.value)}\r\n                                onKeyDown={(e) => {\r\n                                  if (e.key === \"Enter\" && !e.shiftKey) {\r\n                                    e.preventDefault();\r\n                                    enviarMensagem();\r\n                                  }\r\n                                }}\r\n                                rows={1}\r\n                                style={{\r\n                                  minHeight: '48px',\r\n                                  height: 'auto'\r\n                                }}\r\n                              />\r\n                            </div>\r\n                            <button\r\n                              onClick={enviarMensagem}\r\n                              disabled={!novaMensagem.trim()}\r\n                              className=\"w-12 h-12 bg-coral hover:bg-coral-dark disabled:bg-gray-300 disabled:cursor-not-allowed rounded-full flex items-center justify-center transition-colors\"\r\n                            >\r\n                              <Send className=\"w-5 h-5 text-white\" />\r\n                            </button>\r\n                          </div>\r\n                        </div>\r\n                      </>\r\n                    ) : (\r\n                      <div className=\"flex-1 flex flex-col items-center justify-center text-center p-8\">\r\n                        <div className=\"w-24 h-24 bg-coral/10 rounded-full flex items-center justify-center mb-6\">\r\n                          <MessageCircle className=\"w-12 h-12 text-coral\" />\r\n                        </div>\r\n                        <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">Suas Mensagens</h2>\r\n                        <p className=\"text-gray-500 text-lg mb-6 max-w-sm\">\r\n                          Envie uma mensagem para come√ßar uma conversa\r\n                        </p>\r\n                        <button \r\n                          className=\"px-6 py-3 bg-coral hover:bg-coral-dark text-white font-medium rounded-full transition-colors\"\r\n                          onClick={handleNewMessage}\r\n                        >\r\n                          Nova mensagem\r\n                        </button>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </section>\r\n        </div>\r\n      </main>\r\n\r\n      {/* Modal Nova Mensagem */}\r\n      {showNewMessageModal && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n          <div className=\"bg-white rounded-2xl max-w-md w-full max-h-96 overflow-hidden\">\r\n            <div className=\"p-4 border-b border-gray-200\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <h3 className=\"text-lg font-semibold\">Nova Mensagem</h3>\r\n                <button \r\n                  onClick={() => setShowNewMessageModal(false)}\r\n                  className=\"p-2 hover:bg-gray-100 rounded-full\"\r\n                >\r\n                  <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n                  </svg>\r\n                </button>\r\n              </div>\r\n              <p className=\"text-gray-600 text-sm mt-2\">Selecione um usu√°rio para iniciar uma conversa</p>\r\n            </div>\r\n            <div className=\"p-4 max-h-80 overflow-y-auto\">\r\n              {conversas.filter(c => c.isPotential).length === 0 ? (\r\n                <div className=\"text-center py-8\">\r\n                  <p className=\"text-gray-500\">Voc√™ ainda n√£o segue ningu√©m</p>\r\n                  <button \r\n                    onClick={() => {\r\n                      setShowNewMessageModal(false);\r\n                      navigate('/explore');\r\n                    }}\r\n                    className=\"mt-4 px-4 py-2 bg-coral text-white rounded-full text-sm hover:bg-coral-dark transition-colors\"\r\n                  >\r\n                    Explorar usu√°rios\r\n                  </button>\r\n                </div>\r\n              ) : (\r\n                <div className=\"space-y-2\">\r\n                  {conversas\r\n                    .filter(c => c.isPotential)\r\n                    .map((conversa) => (\r\n                      <div\r\n                        key={conversa.id}\r\n                        className=\"p-3 hover:bg-gray-50 rounded-lg cursor-pointer transition-colors\"\r\n                        onClick={() => {\r\n                          setShowNewMessageModal(false);\r\n                          iniciarConversa(conversa.outro_usuario.id);\r\n                        }}\r\n                      >\r\n                        <div className=\"flex items-center gap-3\">\r\n                          <Avatar className=\"w-10 h-10\">\r\n                            <AvatarImage \r\n                              src={conversa.avatar_url ? config.getPublicUrl(conversa.avatar_url) : \"\"} \r\n                            />\r\n                            <AvatarFallback className=\"bg-gradient-to-br from-coral to-coral-light text-white font-medium\">\r\n                              {conversa.nome.charAt(0).toUpperCase()}\r\n                            </AvatarFallback>\r\n                          </Avatar>\r\n                          <div>\r\n                            <h4 className=\"font-medium text-gray-900\">{conversa.nome}</h4>\r\n                            <p className=\"text-sm text-gray-500\">@{conversa.outro_usuario.username}</p>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}"],"names":["__iconNode","CheckCheck","createLucideIcon","Dot","MensagensHeader","user","logout","navigate","useNavigate","jsxs","jsx","Link","MessageCircle","DropdownMenu","DropdownMenuTrigger","Avatar","AvatarImage","config","AvatarFallback","DropdownMenuContent","DropdownMenuItem","MensagensPage","useAuth","refreshMessagesSummary","useMessages","activeTab","setActiveTab","useState","conversas","setConversas","conversaSelecionada","setConversaSelecionada","mensagens","setMensagens","novaMensagem","setNovaMensagem","loading","setLoading","searchQuery","setSearchQuery","showNewMessageModal","setShowNewMessageModal","showMobileChat","setShowMobileChat","chatEndRef","useRef","mapConversationFromApi","useCallback","conversation","participantes","outroUsuario","p","rawLastMessage","ultimaInfo","normalizeUltimaMensagem","timestamp","tipoNormalizado","avatarUrl","raw","currentUserId","item","previewRaw","previewBase","authorName","resolvedUserId","isMine","handleNewMessage","c","useEffect","conversasExistentes","apiService","usuariosSeguindo","usuariosResponse","followingError","todosUsuariosResponse","allUsersError","usuariosComConversa","usuariosSemConversa","u","temConversa","conversasFormatadas","conversasPotenciais","grupos","g","mapped","todasConversas","a","b","err","iniciarConversa","userId","response","conversaId","mensagensResponse","scrollToBottom","prev","carregarMensagens","enviarMensagem","formatTime","date","now","diffInHours","diffInMinutes","formatMessageTime","getStatusDescriptor","mensagem","usuarioId","status","renderStatusIcon","descriptor","variant","key","label","isUnread","sizeClasses","titleParts","title","Check","Clock3","conversasFiltradas","conversaAtual","CommunityLeftSidebar","Search","e","conversa","ultimaMensagemPreview","lastMessageDescriptor","listStatusIcon","Fragment","ArrowLeft","Phone","Video","MoreHorizontal","index","isOwn","showAvatar","statusDescriptor","bubbleStatusIcon","Send"],"mappings":"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","x_google_ignoreList":[0,1]}